var me=o=>{throw TypeError(o)};var ke=(o,s,t)=>s.has(o)||me("Cannot "+t);var v=(o,s,t)=>(ke(o,s,"read from private field"),t?t.call(o):s.get(o)),E=(o,s,t)=>s.has(o)?me("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(o):s.set(o,t);var te=(o,s,t)=>(ke(o,s,"access private method"),t);import"../chunks/CWj6FrbW.js";import"../chunks/SVVRQhx3.js";import{d as Je,o as et,s as $}from"../chunks/C8jMSG_v.js";import{s as ae,u as he,a as tt,g as e,b as u,i as se,O as at,P as T,Q as ge,R as st,S as z,T as ye,Z as p,W as C,X as rt,Y as m,_,d as f,V as re,a0 as it,y as ot}from"../chunks/857XoN4u.js";import{i as H}from"../chunks/BD_jXw_T.js";import{A as nt,e as we,b as lt,c as ct,C as ut,i as Se,W as w}from"../chunks/Ct4mEXdp.js";import{T as dt,r as vt}from"../chunks/DUjGUA_5.js";import{s as ie}from"../chunks/CIl6lDHv.js";import{b as _t}from"../chunks/D1SixoXZ.js";import{i as ft}from"../chunks/BVP6bkhM.js";import{p as bt}from"../chunks/DUBNWQ-w.js";import{b as pt}from"../chunks/D5FNUZXP.js";import{S as xt}from"../chunks/Dya7Hw4r.js";const mt=({url:o})=>({deckId:o.searchParams.get("id")||""}),ea=Object.freeze(Object.defineProperty({__proto__:null,load:mt},Symbol.toStringTag,{value:"Module"}));var kt=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],ht=["difference","intersection","symmetricDifference","union"],Ce=!1,I,h,M,K,A,Me,ze;const Q=class Q extends Set{constructor(t){super();E(this,A);E(this,I,new Map);E(this,h,ae(0));E(this,M,ae(0));E(this,K,he||-1);if(t){for(var c of t)super.add(c);v(this,M).v=super.size}Ce||te(this,A,ze).call(this)}has(t){var c=super.has(t),k=v(this,I),l=k.get(t);if(l===void 0){if(!c)return e(v(this,h)),!1;l=te(this,A,Me).call(this,!0),k.set(t,l)}return e(l),c}add(t){return super.has(t)||(super.add(t),u(v(this,M),super.size),se(v(this,h))),this}delete(t){var c=super.delete(t),k=v(this,I),l=k.get(t);return l!==void 0&&(k.delete(t),u(l,!1)),c&&(u(v(this,M),super.size),se(v(this,h))),c}clear(){if(super.size!==0){super.clear();var t=v(this,I);for(var c of t.values())u(c,!1);t.clear(),u(v(this,M),0),se(v(this,h))}}keys(){return this.values()}values(){return e(v(this,h)),super.values()}entries(){return e(v(this,h)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return e(v(this,M))}};I=new WeakMap,h=new WeakMap,M=new WeakMap,K=new WeakMap,A=new WeakSet,Me=function(t){return he===v(this,K)?ae(t):tt(t)},ze=function(){Ce=!0;var t=Q.prototype,c=Set.prototype;for(const k of kt)t[k]=function(...l){return e(v(this,h)),c[k].apply(this,l)};for(const k of ht)t[k]=function(...l){e(v(this,h));var j=c[k].apply(this,l);return new Q(j)}};let oe=Q;var gt=(o,s)=>s(),yt=(o,s,t)=>s(e(t).label),wt=z('<i class="fa-solid fa-chevron-down"></i>'),St=z('<i class="fa-solid fa-chevron-right"></i>'),Ct=(o,s)=>s(),Mt=(o,s)=>s(),zt=(o,s)=>s(),Dt=(o,s)=>s(),Tt=(o,s)=>s(),Ot=(o,s)=>s(),Pt=z('<div style="display: flex; flex-direction: row; justify-content: space-between; width: 100%"><div class="group-buttons-container svelte-1e3uxxx" style="align-items: flex-start;"><button class="button svelte-1e3uxxx"><i class="fa-solid fa-xmark"></i>cancel selection</button> <button class="button svelte-1e3uxxx"><i class="fa-solid fa-check-double"></i>select all</button></div> <div class="group-buttons-container svelte-1e3uxxx" style="align-items: flex-end;"><button class="button svelte-1e3uxxx"><i class="fa-solid fa-book-open"></i>mark as <b>previously studied</b></button> <button class="button svelte-1e3uxxx"><i class="fa-solid fa-book-open"></i>remove <b>previously studied</b> mark</button> <button class="button svelte-1e3uxxx"><i class="fa-solid fa-square-xmark"></i>mark as <b>ignored</b></button> <button class="button svelte-1e3uxxx"><i class="fa-solid fa-square-xmark"></i>remove <b>ignored</b> mark</button></div></div>'),Et=(o,s,t,c)=>s(e(t).label,e(c)),It=(o,s,t,c)=>{o.key=="Enter"&&s(e(t).label,e(c))},At=(o,s,t,c)=>s(e(t).label,e(c),o),Nt=z('<button class="button select-button svelte-1e3uxxx">select</button>'),Wt=z('<div role="button" tabindex="0"><!> <div class="card-word svelte-1e3uxxx"><span class="word"> </span></div> <div class="card-details svelte-1e3uxxx"><div> </div> <div> </div></div></div>'),Rt=z('<!> <div class="group-content svelte-1e3uxxx"></div>',1),Gt=z('<div class="group svelte-1e3uxxx"><button class="group-header svelte-1e3uxxx"><div> </div> <div><!></div></button> <!></div>'),Ut=z('<!> <div class="container svelte-1e3uxxx"><div class="top-container" style="display: flex; gap: 0.5em; margin-bottom: 2em"><button class="button svelte-1e3uxxx">Split into groups of</button> <input class="input" type="number" min="1" max="100"/></div> <div class="group-container svelte-1e3uxxx"></div></div>',1);function ta(o,s){at(s,!1);const t=T(),c=T();let l=bt(s,"data",8)().deckId||"",j=!1,ne,r=T(new nt);et(async()=>{var i,a;await e(r).init(),j=(a=(i=e(r).deckData[l])==null?void 0:i.tags)==null?void 0:a.includes(ct.ZH_TRAD),ne=new ut("cn","tw"),u(r,e(r))});let S=T(new xt);function De(i){e(S).set(i,!e(S).get(i)),u(S,e(S))}function V(i,a,x){switch(x.getWenbunCustomState(i,a)??w.New){case w.New:return"card-status-new";case w.Learning:return"card-status-learning";case w.ReviewYoung:return"card-status-review-young";case w.ReviewMature:return"card-status-review-mature";case w.Relearning:return"card-status-relearning";case w.PreviouslyStudied:return"card-status-previously-studied";case w.Ignored:return"card-status-ignored"}}function Te(i,a){const x=e(r).getCardWord(i,a);return j?ne.convert(x):x}let q=T(lt);async function Oe(){const i=Math.ceil(e(t).deck.length/e(q));window.confirm(`Split the deck into ${i} groups?`)&&(e(r).splitDeckIntoGroupOfN(l,e(q)),await e(r).save(),u(r,e(r)))}let b=T(null),n=T(new oe);function Pe(i,a,x){x==null||x.stopPropagation(),u(b,i),e(n).clear(),a!=null&&e(n).add(a),u(n,e(n))}function Ee(){u(b,null),e(n).clear(),u(n,e(n))}function Ie(i,a,x){return e(b)==i&&x.has(a)}function le(i,a){e(b)==i&&(e(n).has(a)?e(n).delete(a):e(n).add(a),u(n,e(n)))}function Ae(){if(e(b)==null)return;const i=e(t).groups.find(a=>a.label==e(b));if(i!=null){e(n).clear();for(const a of i.cardIds)e(n).add(a);u(n,e(n))}}async function Ne(){e(b)!=null&&(e(n).forEach(i=>{e(r).addPreviouslyStudiedMark(l,i)}),await e(r).save(),u(r,e(r)))}async function We(){e(b)!=null&&(e(n).forEach(i=>{e(r).removePreviouslyStudiedMark(l,i)}),await e(r).save(),u(r,e(r)))}async function Re(){e(b)!=null&&(e(n).forEach(i=>{e(r).addIgnoredMark(l,i)}),await e(r).save(),u(r,e(r)))}async function Ge(){e(b)!=null&&(e(n).forEach(i=>{e(r).removeIgnoredMark(l,i)}),await e(r).save(),u(r,e(r)))}ge(()=>e(r),()=>{u(t,e(r).deckData[l])}),ge(()=>e(t),()=>{var i;u(c,((i=e(t))==null?void 0:i.groups)??[])}),st(),ft();var ce=Ut(),ue=ye(ce);dt(ue,{title:"Deck",get backUrl(){return`${pt??""}/`}});var de=m(ue,2),X=p(de),ve=p(X);ve.__click=[gt,Oe];var _e=m(ve,2);vt(_e),_(X);var fe=m(X,2);we(fe,5,()=>e(c),Se,(i,a)=>{var x=Gt(),F=p(x);F.__click=[yt,De,a];var J=p(F),Ue=p(J,!0);_(J);var be=m(J,2),je=p(be);{var qe=g=>{var O=wt();C(g,O)},Fe=g=>{var O=St();C(g,O)};H(je,g=>{e(S),e(a),f(()=>e(S).get(e(a).label))?g(qe):g(Fe,!1)})}_(be),_(F);var Ze=m(F,2);{var Be=g=>{var O=Rt(),pe=ye(O);{var Le=N=>{var d=Pt(),y=p(d),W=p(y);W.__click=[Ct,Ee];var Z=m(W,2);Z.__click=[Mt,Ae],_(y);var B=m(y,2),D=p(B);D.__click=[zt,Ne];var P=m(D,2);P.__click=[Dt,We];var R=m(P,2);R.__click=[Tt,Re];var G=m(R,2);G.__click=[Ot,Ge],_(B),_(d),re(()=>{D.disabled=(e(n),f(()=>e(n).size==0)),P.disabled=(e(n),f(()=>e(n).size==0)),R.disabled=(e(n),f(()=>e(n).size==0)),G.disabled=(e(n),f(()=>e(n).size==0))}),C(N,d)};H(pe,N=>{e(b),e(a),f(()=>e(b)==e(a).label)&&N(Le)})}var xe=m(pe,2);we(xe,5,()=>(e(a),f(()=>e(a).cardIds)),Se,(N,d)=>{var y=Wt();let W;y.__click=[Et,le,a,d],y.__keydown=[It,le,a,d];var Z=p(y);{var B=U=>{var Y=Nt();Y.__click=[At,Pe,a,d],C(U,Y)};H(Z,U=>{e(b),e(a),f(()=>e(b)!=e(a).label)&&U(B)})}var D=m(Z,2),P=p(D),R=p(P,!0);_(P),_(D);var G=m(D,2),L=p(G),Ye=p(L,!0);_(L);var ee=m(L,2),$e=p(ee,!0);_(ee),_(G),_(y),re((U,Y,He,Ke,Qe,Ve,Xe)=>{W=ie(y,1,U,"svelte-1e3uxxx",W,Y),$(R,He),ie(L,1,Ke,"svelte-1e3uxxx"),$(Ye,Qe),ie(ee,1,Ve,"svelte-1e3uxxx"),$($e,Xe)},[()=>(e(d),e(r),f(()=>`card ${V(l,e(d),e(r))}`)),()=>({selectable:e(b)==e(a).label,selected:Ie(e(a).label,e(d),e(n))}),()=>(e(d),f(()=>Te(l,e(d)))),()=>(e(d),e(r),f(()=>`status ${V(l,e(d),e(r))}`)),()=>(e(r),e(d),ot(w),f(()=>e(r).getWenbunCustomState(l,e(d))??w.New)),()=>(e(d),e(r),f(()=>`due ${V(l,e(d),e(r))}`)),()=>(e(r),e(d),f(()=>e(r).getCardDueFormatted(l,e(d))))],it),C(N,y)}),_(xe),C(g,O)};H(Ze,g=>{e(S),e(a),f(()=>e(S).get(e(a).label))&&g(Be)})}_(x),re(()=>$(Ue,(e(a),f(()=>e(a).label=="__ungrouped__"?"Ungrouped":e(a).label)))),C(i,x)}),_(fe),_(de),_t(_e,()=>e(q),i=>u(q,i)),C(o,ce),rt()}Je(["click","keydown"]);export{ta as component,ea as universal};
