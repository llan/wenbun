import"../chunks/CWj6FrbW.js";import{i as Ke}from"../chunks/D40miyph.js";import{s as se,d as Qe,o as We}from"../chunks/BTZacTnW.js";import{aA as Xe,ac as Ye,aB as Ze,aC as et,aD as tt,o as Oe,w as u,C as p,D as c,B as o,aa as at,F as rt,y as A,z as d,A as Me,q as R,t as ee,v as it,x as te,g as e,b as y,aE as h,aF as ae,I as P,a7 as w,aG as ot}from"../chunks/Bqj7kxfP.js";import{i as Le}from"../chunks/DvZaLBoI.js";import{S as st,A as lt,T as nt,_ as J,r as $,N as v,c as Be,e as vt,i as dt,C as re}from"../chunks/DFInZXYx.js";import{s as ie}from"../chunks/BEA0u9A2.js";import{l as ut,b as k,a as K}from"../chunks/4M5Wl5BB.js";import{b as ct}from"../chunks/UVCKvGrO.js";function qe(s,l,C=!1){if(s.multiple){if(l==null)return;if(!Ye(l))return Ze();for(var m of s.options)m.selected=l.includes(E(m));return}for(m of s.options){var n=E(m);if(et(n,l)){m.selected=!0;return}}(!C||l!==void 0)&&(s.selectedIndex=-1)}function _t(s){var l=new MutationObserver(()=>{qe(s,s.__value)});l.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),tt(()=>{l.disconnect()})}function oe(s,l,C=l){var m=!0;ut(s,"change",n=>{var a=n?"[selected]":":checked",x;if(s.multiple)x=[].map.call(s.querySelectorAll(a),E);else{var I=s.querySelector(a)??s.querySelector("option:not([disabled])");x=I&&E(I)}C(x)}),Xe(()=>{var n=l();if(qe(s,n,m),m&&n===void 0){var a=s.querySelector(":checked");a!==null&&(n=E(a),C(n))}s.__value=n,m=!1}),_t(s)}function E(s){return"__value"in s?s.__value:s.value}var pt=u('<div class="settings-item"><label class="settings-label svelte-k8ruu5"><div><div class="settings-label-title"> </div> <div class="settings-label-help svelte-k8ruu5"> </div></div> <div class="settings-children"><!></div></label></div>');function b(s,l){Oe(l,!0);const C=st[l.key]??{label:"",help:""};var m=pt(),n=p(m),a=p(n),x=p(a),I=p(x,!0);c(x);var H=o(x,2),F=p(H,!0);c(H),c(a);var U=o(a,2),L=p(U);at(L,()=>l.children??rt),c(U),c(n),c(m),A(()=>{se(I,C.label),se(F,C.help)}),d(s,m),Me()}var ft=(s,l)=>l(),ht=(s,l)=>l(),bt=(s,l)=>l(),yt=u('<textarea class="profile-textarea svelte-9vzc0u"></textarea> <button class="button svelte-9vzc0u">import</button> <div class="settings-label-help svelte-9vzc0u" style="margin: 1em 0">To manually export the profile data, copy the text above and store it somewhere safe.<br/> To manually import the profile data, paste the text into the textbox and click the import button.</div> <button class="button svelte-9vzc0u">Reset Debug Profile</button>',1),mt=(s,l)=>y(l,!e(l)),gt=(s,l)=>e(l).downloadProfile(),$t=(s,l)=>l(),zt=u('<input type="number" class="svelte-9vzc0u"/>'),St=u('<input type="number" class="svelte-9vzc0u"/>'),Pt=u("<select><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),wt=u('<input type="number" class="svelte-9vzc0u"/>'),kt=u("<select><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),Ct=u('<input type="text"/>'),xt=u('<input type="text"/>'),Rt=u('<div style="display: flex; flex-direction: row; align-items: center; gap: 0.5em;"><input type="number" step="0.01" class="svelte-9vzc0u"/></div>'),Tt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Dt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),At=u("<textarea></textarea>"),Ft=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Lt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Bt=(s,l,C)=>l(e(C)),Ot=u("<option> </option>"),Mt=u("<div><div>Load Preset</div> <div><select></select></div></div>"),qt=u('<input type="color" class="svelte-9vzc0u"/>'),It=u('<input type="color" class="svelte-9vzc0u"/>'),Nt=u('<input type="color" class="svelte-9vzc0u"/>'),Vt=u('<input type="color" class="svelte-9vzc0u"/>'),Gt=u('<input type="color" class="svelte-9vzc0u"/>'),jt=u(`<div class="settings-section svelte-9vzc0u"><button class="button svelte-9vzc0u">Save</button></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Profile</div> <div class="section-container svelte-9vzc0u"><!> <button class="button svelte-9vzc0u">manual import/export</button> <button class="button svelte-9vzc0u"><i class="fa-solid fa-download"></i>&nbsp;
                    export profile data (download)</button> <button class="button svelte-9vzc0u"><i class="fa-solid fa-upload"></i>&nbsp;
                    import profile data (upload)</button></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Learning</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">FSRS</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Chinese</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-container svelte-9vzc0u"><a class="button svelte-9vzc0u" href="https://github.com/ray-pH/wenbun" aria-label="GitHub Repository" target="_blank"><i class="fa-brands fa-github"></i>&nbsp;
                    GitHub Repository</a> <a class="button svelte-9vzc0u" href="https://discord.gg/Ab25UgysDt" aria-label="GitHub Repository" target="_blank"><i class="fa-brands fa-discord"></i>&nbsp;
                    Discord Community Server</a></div></div>`,1),Et=u('<!> <div class="main-container svelte-9vzc0u"><!></div>',1);function ea(s,l){Oe(l,!1);const C=R(),m=R();let n=R(new lt),a=R(),x=R();We(async()=>{await e(n).init(),y(a,J.cloneDeep(e(n).getConfig())),y(x,J.cloneDeep(e(a))),y(L,e(a).learningSteps.join(" ")),y(G,e(a).previouslyStudiedLearningSteps.join(" ")),y(j,e(a).FSRSParams.join(",")),y(B,e(n).exportProfile()),y(Q,e(B)),y(n,e(n))});async function I(){await e(n).saveConfig(e(a)),y(x,J.cloneDeep(e(a)))}async function H(){window.confirm("Are you sure you want to reset to the debug profile?")&&(await e(n).debug(),y(n,e(n)))}let F=R("");function U(g){const N=re[g];N&&h(a,e(a).zh.toneColors=N),y(F,"")}let L=R(""),G=R(""),j=R(""),le=R(!1),B=R(""),Q=R("");function Ie(){e(n).tryImportProfile(e(B)).then(g=>{ne(g)})}function Ne(){e(n).tryUploadProfile().then(g=>{ne(g)})}function ne(g){g?window.alert("Successfully imported profile data"):window.alert("Failed to import profile data")}ee(()=>(e(a),e(x)),()=>{y(C,!J.isEqual(e(a),e(x)))}),ee(()=>(e(a),e(L),e(G),e(j)),()=>{if(e(a)){const g=e(L).split(" ").map(_=>_.trim()).filter(_=>_);g.length<4&&g.every(_=>_.match(/^\d+[m|d]$/))&&h(a,e(a).learningSteps=g);const O=e(G).split(" ").map(_=>_.trim()).filter(_=>_);O.length<4&&O.every(_=>_.match(/^\d+[m|d]$/))&&h(a,e(a).previouslyStudiedLearningSteps=O);const M=e(j).split(",").map(_=>_.trim()).filter(_=>_);M.length===21&&M.every(_=>!isNaN(parseFloat(_)))&&h(a,e(a).FSRSParams=M.map(_=>parseFloat(_)))}}),ee(()=>(e(B),e(Q)),()=>{y(m,e(B)!==e(Q))}),it(),Ke();var ve=Et(),de=te(ve);nt(de,{title:"Settings",get backUrl(){return`${ct??""}/`},isSettings:!0});var ue=o(de,2),Ve=p(ue);{var Ge=g=>{var N=jt(),O=te(N),W=p(O);W.__click=[ft,I],c(O);var M=o(O,2),X=o(p(M),2),_=p(X);{var je=i=>{var f=yt(),t=te(f);Be(t);var r=o(t,2);r.__click=[ht,Ie];var z=o(r,4);z.__click=[bt,H],A(()=>r.disabled=!e(m)),k(t,()=>e(B),S=>y(B,S)),d(i,f)};Le(_,i=>{e(le)&&i(je)})}var ce=o(_,2);ce.__click=[mt,le];var _e=o(ce,2);_e.__click=[gt,n];var Ee=o(_e,2);Ee.__click=[$t,Ne],c(X),c(M);var Y=o(M,2),pe=o(p(Y),2),fe=p(pe);b(fe,{key:"newCardPerDay",children:(i,f)=>{var t=zt();$(t),k(t,()=>e(a).newCardPerDay,r=>h(a,e(a).newCardPerDay=r)),d(i,t)},$$slots:{default:!0}});var he=o(fe,2);b(he,{key:"maxReviewsPerDay",children:(i,f)=>{var t=St();$(t),k(t,()=>e(a).maxReviewsPerDay,r=>h(a,e(a).maxReviewsPerDay=r)),d(i,t)},$$slots:{default:!0}});var be=o(he,2);b(be,{key:"newCardOrder",children:(i,f)=>{var t=Pt();A(()=>{e(a),ae(()=>{})});var r=p(t),z={},S=o(r),D={},T=o(S),q={};c(t),A(()=>{z!==(z=(w(v),P(()=>v.Mix)))&&(r.value=(r.__value=(w(v),P(()=>v.Mix)))??""),D!==(D=(w(v),P(()=>v.AfterReviews)))&&(S.value=(S.__value=(w(v),P(()=>v.AfterReviews)))??""),q!==(q=(w(v),P(()=>v.BeforeReviews)))&&(T.value=(T.__value=(w(v),P(()=>v.BeforeReviews)))??"")}),oe(t,()=>e(a).newCardOrder,V=>h(a,e(a).newCardOrder=V)),d(i,t)},$$slots:{default:!0}});var ye=o(be,2);b(ye,{key:"newPreviouslyStudiedCardPerDay",children:(i,f)=>{var t=wt();$(t),k(t,()=>e(a).newPreviouslyStudiedCardPerDay,r=>h(a,e(a).newPreviouslyStudiedCardPerDay=r)),d(i,t)},$$slots:{default:!0}});var He=o(ye,2);b(He,{key:"newPreviouslyStudiedCardOrder",children:(i,f)=>{var t=kt();A(()=>{e(a),ae(()=>{})});var r=p(t),z={},S=o(r),D={},T=o(S),q={};c(t),A(()=>{z!==(z=(w(v),P(()=>v.Mix)))&&(r.value=(r.__value=(w(v),P(()=>v.Mix)))??""),D!==(D=(w(v),P(()=>v.AfterReviews)))&&(S.value=(S.__value=(w(v),P(()=>v.AfterReviews)))??""),q!==(q=(w(v),P(()=>v.BeforeReviews)))&&(T.value=(T.__value=(w(v),P(()=>v.BeforeReviews)))??"")}),oe(t,()=>e(a).newPreviouslyStudiedCardOrder,V=>h(a,e(a).newPreviouslyStudiedCardOrder=V)),d(i,t)},$$slots:{default:!0}}),c(pe),c(Y);var Z=o(Y,2),me=o(p(Z),2),ge=p(me);b(ge,{key:"learningSteps",children:(i,f)=>{var t=Ct();$(t),ie(t,1,"svelte-9vzc0u",null,{},{invalid:!1}),k(t,()=>e(L),r=>y(L,r)),d(i,t)},$$slots:{default:!0}});var $e=o(ge,2);b($e,{key:"previouslyStudiedLearningSteps",children:(i,f)=>{var t=xt();$(t),ie(t,1,"svelte-9vzc0u",null,{},{invalid:!1}),k(t,()=>e(G),r=>y(G,r)),d(i,t)},$$slots:{default:!0}});var ze=o($e,2);b(ze,{key:"desiredRetention",children:(i,f)=>{var t=Rt(),r=p(t);$(r),c(t),k(r,()=>e(a).desiredRetention,z=>h(a,e(a).desiredRetention=z)),d(i,t)},$$slots:{default:!0}});var Se=o(ze,2);b(Se,{key:"enableShortTerm",children:(i,f)=>{var t=Tt();$(t),K(t,()=>e(a).enableShortTerm,r=>h(a,e(a).enableShortTerm=r)),d(i,t)},$$slots:{default:!0}});var Pe=o(Se,2);b(Pe,{key:"enableFuzz",children:(i,f)=>{var t=Dt();$(t),K(t,()=>e(a).enableFuzz,r=>h(a,e(a).enableFuzz=r)),d(i,t)},$$slots:{default:!0}});var Ue=o(Pe,2);b(Ue,{key:"FSRSParams",children:(i,f)=>{var t=At();Be(t),ie(t,1,"",null,{},{invalid:!1}),k(t,()=>e(j),r=>y(j,r)),d(i,t)},$$slots:{default:!0}}),c(me),c(Z);var we=o(Z,2),ke=o(p(we),2),Ce=p(ke);b(Ce,{key:"zhAlwaysShowReading",children:(i,f)=>{var t=Ft();$(t),K(t,()=>e(a).zh.alwaysShowReading,r=>h(a,e(a).zh.alwaysShowReading=r)),d(i,t)},$$slots:{default:!0}});var xe=o(Ce,2);b(xe,{key:"zhIsColorBasedOnTone",children:(i,f)=>{var t=Lt();$(t),K(t,()=>e(a).zh.isColorBasedOnTone,r=>h(a,e(a).zh.isColorBasedOnTone=r)),d(i,t)},$$slots:{default:!0}});var Re=o(xe,2);b(Re,{key:"zhToneColors",children:(i,f)=>{var t=Mt(),r=o(p(t),2),z=p(r);A(()=>{e(F),ae(()=>{})}),z.__change=[Bt,U,F],vt(z,5,()=>(w(re),P(()=>Object.keys(re))),dt,(S,D)=>{var T=Ot(),q=p(T,!0);c(T);var V={};A(()=>{se(q,e(D)),V!==(V=e(D))&&(T.value=(T.__value=e(D))??"")}),d(S,T)}),c(z),c(r),c(t),oe(z,()=>e(F),S=>y(F,S)),d(i,t)},$$slots:{default:!0}});var Te=o(Re,2);b(Te,{key:"zhTone1",children:(i,f)=>{var t=qt();$(t),k(t,()=>e(a).zh.toneColors[0],r=>h(a,e(a).zh.toneColors[0]=r)),d(i,t)},$$slots:{default:!0}});var De=o(Te,2);b(De,{key:"zhTone2",children:(i,f)=>{var t=It();$(t),k(t,()=>e(a).zh.toneColors[1],r=>h(a,e(a).zh.toneColors[1]=r)),d(i,t)},$$slots:{default:!0}});var Ae=o(De,2);b(Ae,{key:"zhTone3",children:(i,f)=>{var t=Nt();$(t),k(t,()=>e(a).zh.toneColors[2],r=>h(a,e(a).zh.toneColors[2]=r)),d(i,t)},$$slots:{default:!0}});var Fe=o(Ae,2);b(Fe,{key:"zhTone4",children:(i,f)=>{var t=Vt();$(t),k(t,()=>e(a).zh.toneColors[3],r=>h(a,e(a).zh.toneColors[3]=r)),d(i,t)},$$slots:{default:!0}});var Je=o(Fe,2);b(Je,{key:"zhToneNeutral",children:(i,f)=>{var t=Gt();$(t),k(t,()=>e(a).zh.toneColors[4],r=>h(a,e(a).zh.toneColors[4]=r)),d(i,t)},$$slots:{default:!0}}),c(ke),c(we),ot(2),A(()=>W.disabled=!e(C)),d(g,N)};Le(Ve,g=>{e(a)&&g(Ge)})}c(ue),d(s,ve),Me()}Qe(["click","change"]);export{ea as component};
