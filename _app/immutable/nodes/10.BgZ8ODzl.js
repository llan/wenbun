var Ba=Object.defineProperty;var Ya=(n,a,o)=>a in n?Ba(n,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[a]=o;var na=(n,a,o)=>Ya(n,typeof a!="symbol"?a+"":a,o);import"../chunks/CWj6FrbW.js";import"../chunks/DUOQ2h4l.js";import{a5 as Za,aU as Xa,ai as ja,aV as Ka,aW as Ja,l as Qa,n as R,aX as Va,aY as $a,aZ as et,a_ as Da,a$ as at,q as tt,w as Ge,ak as ba,p as ca,g as xe,at as it,al as Ea,j as f,f as T,d as r,r as i,s as v,i as e,t as te,e as E,aT as Ua,b as w,c as ua,a as pe,aJ as Je,ao as Wa,X as K,v as rt,b0 as nt,a9 as Z,am as ga,an as st,aM as lt,P as xa,aq as ot,b1 as dt}from"../chunks/C5etlkrB.js";import{i as q}from"../chunks/Cc2rhPc8.js";import{k as pa}from"../chunks/DjLauc_Q.js";import{e as fa,i as _a}from"../chunks/Dnr6C7Qa.js";import{s as Ce}from"../chunks/DzZJzTEu.js";import{b as za}from"../chunks/D8MaqmQc.js";import{i as vt}from"../chunks/BkP1o4TQ.js";import{p as ya}from"../chunks/DgBratTy.js";import{b as ct}from"../chunks/D1cDxkzO.js";import{l as F,A as ut,W as Ee}from"../chunks/9d6GTHjt.js";import{s as H,T as ft}from"../chunks/CJvaFUoo.js";import{s as sa}from"../chunks/XkQyc0Ir.js";import{c as _t}from"../chunks/Co-1QMVx.js";import{H as mt}from"../chunks/DcL13wi7.js";import{m as ka,b as ht,n as gt,T as da,p as qa,e as pt,o as Ct,c as Ca,C as yt}from"../chunks/D8ng8q4j.js";import{n as wt}from"../chunks/CdUe_U2C.js";const bt=()=>performance.now(),Me={tick:n=>requestAnimationFrame(n),now:()=>bt(),tasks:new Set};function Ga(){const n=Me.now();Me.tasks.forEach(a=>{a.c(n)||(Me.tasks.delete(a),a.f())}),Me.tasks.size!==0&&Me.tick(Ga)}function xt(n){let a;return Me.tasks.size===0&&Me.tick(Ga),{promise:new Promise(o=>{Me.tasks.add(a={c:n,f:o})}),abort(){Me.tasks.delete(a)}}}function oa(n,a){Da(()=>{n.dispatchEvent(new CustomEvent(a))})}function kt(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const a=n.split("-");return a.length===1?a[0]:a[0]+a.slice(1).map(o=>o[0].toUpperCase()+o.slice(1)).join("")}function Sa(n){const a={},o=n.split(";");for(const l of o){const[c,g]=l.split(":");if(!c||g===void 0)break;const U=kt(c.trim());a[U]=g.trim()}return a}const St=n=>n;function Ta(n,a,o,l){var c=(n&$a)!==0,g=(n&et)!==0,U=c&&g,G=(n&Va)!==0,W=U?"both":c?"in":"out",_,z=a.inert,re=a.style.overflow,D,m;function I(){return Da(()=>_??(_=o()(a,(l==null?void 0:l())??{},{direction:W})))}var t={is_global:G,in(){var A;if(a.inert=z,!c){m==null||m.abort(),(A=m==null?void 0:m.reset)==null||A.call(m);return}g||D==null||D.abort(),oa(a,"introstart"),D=wa(a,I(),m,1,()=>{oa(a,"introend"),D==null||D.abort(),D=_=void 0,a.style.overflow=re})},out(A){if(!g){A==null||A(),_=void 0;return}a.inert=!0,oa(a,"outrostart"),m=wa(a,I(),D,0,()=>{oa(a,"outroend"),A==null||A()})},stop:()=>{D==null||D.abort(),m==null||m.abort()}},d=Za;if((d.transitions??(d.transitions=[])).push(t),c&&Xa){var p=G;if(!p){for(var u=d.parent;u&&(u.f&ja)!==0;)for(;(u=u.parent)&&(u.f&Ka)===0;);p=!u||(u.f&Ja)!==0}p&&Qa(()=>{R(()=>t.in())})}}function wa(n,a,o,l,c){var g=l===1;if(at(a)){var U,G=!1;return tt(()=>{if(!G){var d=a({direction:g?"in":"out"});U=wa(n,d,o,l,c)}}),{abort:()=>{G=!0,U==null||U.abort()},deactivate:()=>U.deactivate(),reset:()=>U.reset(),t:()=>U.t()}}if(o==null||o.deactivate(),!(a!=null&&a.duration))return c(),{abort:Ge,deactivate:Ge,reset:Ge,t:()=>l};const{delay:W=0,css:_,tick:z,easing:re=St}=a;var D=[];if(g&&o===void 0&&(z&&z(0,1),_)){var m=Sa(_(0,1));D.push(m,m)}var I=()=>1-l,t=n.animate(D,{duration:W,fill:"forwards"});return t.onfinish=()=>{t.cancel();var d=(o==null?void 0:o.t())??1-l;o==null||o.abort();var p=l-d,u=a.duration*Math.abs(p),A=[];if(u>0){var B=!1;if(_)for(var N=Math.ceil(u/16.666666666666668),h=0;h<=N;h+=1){var Y=d+p*re(h/N),$=Sa(_(Y,1-Y));A.push($),B||(B=$.overflow==="hidden")}B&&(n.style.overflow="hidden"),I=()=>{var M=t.currentTime;return d+p*re(M/u)},z&&xt(()=>{if(t.playState!=="running")return!1;var M=I();return z(M,1-M),!0})}t=n.animate(A,{duration:u,fill:"forwards"}),t.onfinish=()=>{I=()=>l,z==null||z(l,1-l),c()}},{abort:()=>{t&&(t.cancel(),t.effect=null,t.onfinish=Ge)},deactivate:()=>{c=Ge},reset:()=>{l===0&&(z==null||z(1,0))},t:()=>I()}}const Tt=({url:n})=>({deckId:n.searchParams.get("id")||"",isExtraStudy:n.searchParams.get("isExtraStudy")==="true",cardIds:n.searchParams.get("cardIds")||encodeURIComponent("[]")}),Hi=Object.freeze(Object.defineProperty({__proto__:null,load:Tt},Symbol.toStringTag,{value:"Module"}));class At{constructor(a,o=!0){na(this,"audios");na(this,"currentIndex",0);na(this,"isPlaying",!1);na(this,"onEnded",this.handleEnded.bind(this));this.audios=a.map(l=>{const c=new Audio(l);return c.preload="auto",o&&c.load(),c})}handleEnded(){this.audios[this.currentIndex].removeEventListener("ended",this.onEnded),this.currentIndex++,this.currentIndex<this.audios.length?this.playCurrent():(this.isPlaying=!1,this.currentIndex=0)}playCurrent(){const a=this.audios[this.currentIndex];a.addEventListener("ended",this.onEnded),a.currentTime=0,a.play().catch(o=>{console.warn("Playback failed:",o),this.stop()})}play(){this.audios.length!==0&&(this.isPlaying&&this.stop(),this.isPlaying=!0,this.currentIndex=0,this.playCurrent())}stop(){if(!this.isPlaying)return;this.isPlaying=!1;const a=this.audios[this.currentIndex];a.pause(),a.currentTime=0,a.removeEventListener("ended",this.onEnded),this.currentIndex=0}}const Rt={[F.Again]:"Fail",[F.Hard]:"Hard",[F.Good]:"Good",[F.Easy]:"Easy"},Dt={[F.Again]:"again",[F.Hard]:"hard",[F.Good]:"good",[F.Easy]:"easy"},Et={[F.Again]:"fa fa-solid fa-face-frown",[F.Hard]:"fa fa-solid fa-face-meh",[F.Good]:"fa fa-solid fa-face-smile",[F.Easy]:"fa fa-solid fa-star"};var va;(n=>{function a(l){if(l.isFailAndReveal)return F.Again;const c=l.correctStrokeCount===0?1/0:l.incorrectStrokeCount/l.correctStrokeCount;return c<.25||l.incorrectStrokeCount<=2?F.Good:c<.75||l.incorrectStrokeCount<=4?F.Hard:F.Again}n.getGrade=a;function o(l){switch(l){case F.Again:return"Again";case F.Hard:return"Hard";case F.Good:return"Good";default:return"Unknown"}}n.gradeToLabel=o})(va||(va={}));var Ut=(n,a)=>a(),Wt=T('<button class="audio-button svelte-xlnlhl" aria-label="Play Audio"><i class="fa-solid fa-volume-low svelte-xlnlhl"></i></button>'),zt=T('<div class="new-element-indicator svelte-xlnlhl">New Card</div>'),qt=T("<div>Warm Up</div>"),Gt=T('<div class="new-element-indicator is-hidden svelte-xlnlhl"></div>'),Ft=(n,a)=>a.onOpenDict(),It=T('<span class="svelte-xlnlhl"> </span>'),Nt=T('<span class="empty-character-box svelte-xlnlhl">&#x3000;</span>'),Pt=T('<!> <div class="right-side svelte-xlnlhl"><button class="button dict-button svelte-xlnlhl"><i class="fa-solid fa-book svelte-xlnlhl"></i> Dict</button> <div class="character-box-container chinese-font svelte-xlnlhl"></div></div>',1),Ot=(n,a)=>a(),Ht=T('<i class="fa-solid fa-play svelte-xlnlhl"></i>'),Mt=T('<i class="fa-solid fa-forward svelte-xlnlhl"></i>'),Lt=T('<button class="stroke-speed-button svelte-xlnlhl"><!> <span class="svelte-xlnlhl"> </span></button>'),Bt=(n,a)=>a(),Yt=T('<i style="font-size: 2.4em" class="fa fa-solid fa-seedling svelte-xlnlhl"></i> <span class="svelte-xlnlhl">New</span>',1),Zt=T('<i></i> <span class="svelte-xlnlhl"> </span>',1),Xt=T("<button><!></button>"),jt=T('<div class="character-writer svelte-xlnlhl"><div class="meaning svelte-xlnlhl"> </div> <div><div class="reading svelte-xlnlhl"> </div> <!></div> <div class="character-container svelte-xlnlhl"><div class="grid-background svelte-xlnlhl"><svg xmlns="http://www.w3.org/2000/svg" id="grid-background-target" class="svelte-xlnlhl"><line class="svelte-xlnlhl"></line><line class="svelte-xlnlhl"></line><line class="svelte-xlnlhl"></line><line class="svelte-xlnlhl"></line></svg></div> <div class="bottom-container svelte-xlnlhl"><!></div> <!> <!></div></div>');function Kt(n,a){var Ie;ca(a,!0);let o=xe(500),l=xe(500),c=xe(30),g=Ua(()=>e(c)),U="#DDD";const G=500,W=new Audio(`${ct}/assets/sounds/correct-choice-43861.mp3`);let _=xe(it([])),z=xe(!1),re=xe(!1),D=xe(!1);function m(){return parseFloat(getComputedStyle(document.body).fontSize)}function I(){return parseFloat(getComputedStyle(document.body).fontSize)/parseFloat(getComputedStyle(document.documentElement).fontSize)}function t(){const C=m()*2*.8;f(o,Math.min(document.documentElement.clientWidth-C,500)*I()),f(l,e(o),!0),f(c,.5*m()*I())}let d=ya(a,"isRequestManualGrade",15),p=ya(a,"autoReviewData",15),u=xe(0),A=(Ie=a.characterData)==null?void 0:Ie.meanings.join("; ");function B(C){for(const b of C)if(b.startsWith(da))return qa(b.substring(da.length))}function N(){var C;f(re,!0),!e(D)&&(a.cardConfig.isFirstTime?(f(u,(e(u)+1)%a.characterData.characters.length),window.setTimeout(()=>{Y(e(u))},G)):(W.play(),f(u,e(u)+1),e(u)==((C=a.characterData)==null?void 0:C.characters.length)?(a.onComplete({...p()}),f(z,!0),window.setTimeout(()=>{M()},G)):window.setTimeout(()=>{Y(e(u))},G)))}let h;function Y(C){if(e(D)||!a.characterData)return;h&&(a.cardConfig.isFirstTime||h.cancelQuiz(),h.hideCharacter(),h.hideOutline());const b=B(a.characterData.tags[C]??[]);h=mt.create("grid-background-target",a.characterData.characters[C],{width:e(o),height:e(l),padding:5,showCharacter:!1,showOutline:a.cardConfig.isShowOutline,highlightOnComplete:!1,strokeColor:a.app.getChineseToneColor(b)??"#555",drawingWidth:ht,drawingColor:"#555",strokeAnimationSpeed:e(L),delayBetweenStrokes:ka(e(L),1,fe,1e3,10),delayBetweenLoops:ka(e(L),1,fe,2e3,10),onComplete:()=>{N()}}),a.cardConfig.isFirstTime?(setTimeout(()=>{e(re)||M()},G),setTimeout(()=>{h.animateCharacter({onComplete:()=>{setTimeout(()=>{h.hideOutline(),h.hideCharacter(),N()},G)}})},G)):(h.quiz({leniency:a.app.getConfig().strokeLeniency,onMistake:()=>{p(p().incorrectStrokeCount++,!0),p(p().totalStrokeCount++,!0)},onCorrectStroke:()=>{p(p().correctStrokeCount++,!0),p(p().totalStrokeCount++,!0)}}),p().isFailAndReveal&&h.showOutline())}function $(){var b;const C=(b=a.characterData)==null?void 0:b.audioUrl;C&&f(_,C.map(me=>{const Ne=me.map(Pe=>gt(a.cardConfig.lang,Pe));return new At(Ne)}),!0)}function M(){const C=Math.floor(Math.random()*e(_).length),b=e(_)[C];b.stop(),b.play()}function ce(){if(a.cardConfig.isWarmUp&&(!a.cardConfig.isGradeWarmUpCards||!a.cardConfig.isFinalWarmUp)){window.alert("Can't change grade during warm-up, since grading doesn't affect scheduling in this phase.");return}d(!d())}function ue(C=0){const b=a.cardConfig.warmUpCount??0,me=a.cardConfig.warmUpMaxCount;return`${Math.round((b+C)/me*100)}%`}function P(){h&&(p(p().isFailAndReveal=!0,!0),h.showOutline())}const fe=5;let L=xe(1);function Ze(){const C=e(L)%fe+1;f(L,C),a.app.setStrokeSpeed(C)}Ea(()=>(p({correctStrokeCount:0,incorrectStrokeCount:0,totalStrokeCount:0,isFailAndReveal:!1}),t(),$(),window.addEventListener("resize",t),f(L,a.app.getStrokeSpeed(),!0),Y(0),()=>{f(D,!0),window.removeEventListener("resize",t)}));var x=jt(),_e=r(x),Qe=r(_e,!0);i(_e);var ne=v(_e,2);let Ve;var Xe=r(ne),$e=r(Xe,!0);i(Xe);var se=v(Xe,2);{var Le=C=>{var b=Wt();b.__click=[Ut,M],w(C,b)};q(se,C=>{e(_).length>0&&C(Le)})}i(ne);var ke=v(ne,2),Se=r(ke),Be=r(Se),ye=r(Be);H(ye,"stroke",U);var Te=v(ye);H(Te,"stroke",U);var Ue=v(Te);H(Ue,"stroke",U);var We=v(Ue);H(We,"stroke",U),i(Be),i(Se);var je=v(Se,2),aa=r(je);{var Ke=C=>{var b=Pt(),me=pe(b);{var Ne=y=>{var X=zt();w(y,X)},Pe=(y,X)=>{{var ee=ge=>{var k=qt();let J,Q;te((le,ae)=>{J=Ce(k,1,"new-element-indicator svelte-xlnlhl",null,J,le),Q=sa(k,"",Q,ae)},[()=>({"is-complete":e(z)}),()=>({"--progress":ue(),"--next-progress":ue(1)})]),w(ge,k)},he=ge=>{var k=Gt();w(ge,k)};q(y,ge=>{a.cardConfig.isWarmUp?ge(ee):ge(he,!1)},X)}};q(me,y=>{a.cardConfig.isFirstTime?y(Ne):y(Pe,!1)})}var Oe=v(me,2),s=r(Oe);s.__click=[Ft,a];var S=v(s,2);fa(S,21,()=>a.characterData.characters,_a,(y,X,ee)=>{var he=Je(),ge=pe(he);{var k=Q=>{var le=It(),ae=r(le,!0);i(le),te(()=>E(ae,e(X))),w(Q,le)},J=Q=>{var le=Nt();w(Q,le)};q(ge,Q=>{ee<e(u)||a.cardConfig.isFirstTime?Q(k):Q(J,!1)})}w(y,he)}),i(S),i(Oe),w(C,b)};q(aa,C=>{var b;(b=a.characterData)!=null&&b.characters&&C(Ke)})}i(je);var we=v(je,2);{var Ae=C=>{var b=Lt();b.__click=[Ot,Ze];var me=r(b);{var Ne=S=>{var y=Ht();w(S,y)},Pe=S=>{var y=Mt();w(S,y)};q(me,S=>{e(L)<=1?S(Ne):S(Pe,!1)})}var Oe=v(me,2),s=r(Oe);i(Oe),i(b),te(()=>E(s,`${e(L)??""}x`)),w(C,b)};q(we,C=>{a.cardConfig.isFirstTime&&C(Ae)})}var Fe=v(we,2);{var Ye=C=>{var b=Xt();let me;b.__click=[Bt,ce];var Ne=r(b);{var Pe=s=>{var S=Yt();Wa(2),w(s,S)},Oe=s=>{var S=Zt(),y=pe(S),X=v(y,2),ee=r(X,!0);i(X),te(()=>{Ce(y,1,_t(Et[a.autoGrade]),"svelte-xlnlhl"),E(ee,Rt[a.autoGrade])}),w(s,S)};q(Ne,s=>{a.cardConfig.isWarmUp&&!a.cardConfig.isGradeWarmUpCards?s(Pe):s(Oe,!1)})}i(b),te(s=>me=Ce(b,1,`auto-review-indicator-container ${Dt[a.autoGrade]}`,"svelte-xlnlhl",me,s),[()=>({blinking:d(),animated:d(),"echo-once":!d()})]),w(C,b)};q(Fe,C=>{a.autoGrade&&C(Ye)})}return i(ke),i(x),te(C=>{var b;E(Qe,A),Ve=Ce(ne,1,"reading-container svelte-xlnlhl",null,Ve,C),E($e,(b=a.characterData)==null?void 0:b.reading),H(Be,"width",e(o)),H(Be,"height",e(l)),H(ye,"x1",e(g)),H(ye,"y1",e(g)),H(ye,"x2",e(o)-e(g)),H(ye,"y2",e(l)-e(g)),H(Te,"x1",e(o)-e(g)),H(Te,"y1",e(g)),H(Te,"x2",e(g)),H(Te,"y2",e(l)-e(g)),H(Ue,"x1",e(o)/2),H(Ue,"y1",e(g)),H(Ue,"x2",e(o)/2),H(Ue,"y2",e(l)-e(g)),H(We,"x1",e(g)),H(We,"y1",e(l)/2),H(We,"x2",e(o)-e(g)),H(We,"y2",e(l)/2)},[()=>({"is-hidden":!a.app.getConfig().zh.alwaysShowReading&&!e(z)&&!a.cardConfig.isFirstTime})]),w(n,x),ua({failAndReveal:P})}ba(["click"]);const Jt=n=>n;function Qt(n){const a=n-1;return a*a*a+1}function Aa(n){const a=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return a?[parseFloat(a[1]),a[2]||"px"]:[n,"px"]}function Vt(n,{delay:a=0,duration:o=400,easing:l=Jt}={}){const c=+getComputedStyle(n).opacity;return{delay:a,duration:o,easing:l,css:g=>`opacity: ${g*c}`}}function $t(n,{delay:a=0,duration:o=400,easing:l=Qt,x:c=0,y:g=0,opacity:U=0}={}){const G=getComputedStyle(n),W=+G.opacity,_=G.transform==="none"?"":G.transform,z=W*(1-U),[re,D]=Aa(c),[m,I]=Aa(g);return{delay:a,duration:o,easing:l,css:(t,d)=>`
			transform: ${_} translate(${(1-t)*re}${D}, ${(1-t)*m}${I});
			opacity: ${W-z*d}`}}function ei(n){const a=n-1;return a*a*a+1}const Ra=(n,a=Ge,o=Ge)=>{var l=Je(),c=pe(l);fa(c,17,a,_a,(g,U,G)=>{var W=ti(),_=r(W,!0);i(W),te(()=>{sa(W,`color: ${o()[G]??""}`),E(_,e(U))}),w(g,W)}),w(n,l)};var ai=T('<div class="simple-decomp svelte-1yiia6q"><span class="simple-char chinese-font svelte-1yiia6q"> </span> <span class="simple-pinyin svelte-1yiia6q"> </span> <span class="simple-sep svelte-1yiia6q">&mdash;</span> <span class="simple-def"> </span></div>'),ti=T("<span> </span>"),ii=T('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Simplified</div> <div class="value chinese-font svelte-1yiia6q"><!></div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Traditional</div> <div class="value chinese-font svelte-1yiia6q"><!></div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Definition</div> <div class="value"> </div></div> <div class="sep svelte-1yiia6q"></div> <div style="margin-bottom: 0.5em"><b>Components</b> :</div>',1),ri=T('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Semantic</div> <div class="value"><!></div></div>'),ni=T('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Phonetic</div> <div class="value"><!></div></div>'),si=T('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Etymology</div> <div class="value"> </div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Hint</div> <div class="value"> </div></div> <!> <!>',1),li=T('<div class="char-decomp svelte-1yiia6q"><div class="char-container svelte-1yiia6q"><div class="char chinese-font svelte-1yiia6q"> </div> <div class="char-pinyin"> </div></div> <div class="char-info"><div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Simplified</div> <div class="value chinese-font colored svelte-1yiia6q"> </div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Traditional</div> <div class="value chinese-font colored svelte-1yiia6q"> </div></div> <div class="sep svelte-1yiia6q"></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Definition</div> <div class="value"> </div></div> <div class="sep svelte-1yiia6q"></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Radical</div> <div class="value"><!></div></div> <div class="sep svelte-1yiia6q"></div> <!></div></div>'),oi=T('<div class="dict-container"><!> <!></div>');function di(n,a){var m,I;ca(a,!0);const o=(t,d=Ge)=>{var p=Je(),u=pe(p);{var A=B=>{var N=ai(),h=r(N),Y=r(h,!0);i(h);var $=v(h,2),M=r($,!0);i($);var ce=v($,4),ue=r(ce,!0);i(ce),i(N),te((P,fe)=>{sa(N,`--tone-color: ${P??""}`),E(Y,d().character),E(M,fe),E(ue,d().definition??"")},[()=>{var P;return a.toneColors[a.wordlist.toneFromPinyin(((P=d().pinyin)==null?void 0:P[0])??"")-1]},()=>{var P;return G(((P=d().pinyin)==null?void 0:P[0])??"",a.zhReading)}]),w(B,N)};q(u,B=>{d()&&B(A)})}w(t,p)};let l=((m=a.characterData)==null?void 0:m.characters)??"",c=((I=a.characterData)==null?void 0:I.tags.map(t=>W(t)??5).map(t=>a.toneColors[t-1]))??[],g=Ua(()=>a.wordlist.getWordDecompData(l)),U=l.length>1;function G(t,d){return d===pt.Zhuyin?Ct.pinyinToZhuyin(t):t}function W(t){for(const d of t)if(d.startsWith(da))return qa(d.substring(da.length))}var _=oi(),z=r(_);{var re=t=>{var d=ii(),p=pe(d),u=v(r(p),2),A=r(u),B=K(()=>a.wordlist.toSimplified(l));Ra(A,()=>e(B),()=>c),i(u),i(p);var N=v(p,2),h=v(r(N),2),Y=r(h),$=K(()=>a.wordlist.toTraditional(l));Ra(Y,()=>e($),()=>c),i(h),i(N);var M=v(N,2),ce=v(r(M),2),ue=r(ce,!0);i(ce),i(M),Wa(4),te(()=>{var P;return E(ue,((P=a.characterData)==null?void 0:P.meanings[0])??"")}),w(t,d)};q(z,t=>{U&&t(re)})}var D=v(z,2);fa(D,17,()=>e(g),_a,(t,d)=>{var p=li(),u=r(p),A=r(u),B=r(A,!0);i(A);var N=v(A,2),h=r(N,!0);i(N),i(u);var Y=v(u,2),$=r(Y),M=v(r($),2),ce=r(M,!0);i(M),i($);var ue=v($,2),P=v(r(ue),2),fe=r(P,!0);i(P),i(ue);var L=v(ue,4),Ze=v(r(L),2),x=r(Ze,!0);i(Ze),i(L);var _e=v(L,4),Qe=v(r(_e),2),ne=r(Qe),Ve=K(()=>a.wordlist.getCharDecompData(e(d).radical));o(ne,()=>e(Ve)),i(Qe),i(_e);var Xe=v(_e,4);{var $e=se=>{var Le=si(),ke=pe(Le),Se=v(r(ke),2),Be=r(Se,!0);i(Se),i(ke);var ye=v(ke,2),Te=v(r(ye),2),Ue=r(Te,!0);i(Te),i(ye);var We=v(ye,2);{var je=we=>{var Ae=ri(),Fe=v(r(Ae),2),Ye=r(Fe),Ie=K(()=>a.wordlist.getCharDecompData(e(d).etymology.semantic));o(Ye,()=>e(Ie)),i(Fe),i(Ae),w(we,Ae)};q(We,we=>{e(d).etymology.semantic&&we(je)})}var aa=v(We,2);{var Ke=we=>{var Ae=ni(),Fe=v(r(Ae),2),Ye=r(Fe),Ie=K(()=>a.wordlist.getCharDecompData(e(d).etymology.phonetic));o(Ye,()=>e(Ie)),i(Fe),i(Ae),w(we,Ae)};q(aa,we=>{e(d).etymology.phonetic&&we(Ke)})}te(()=>{E(Be,e(d).etymology.type),E(Ue,e(d).etymology.hint)}),w(se,Le)};q(Xe,se=>{e(d).etymology&&se($e)})}i(Y),i(p),te((se,Le,ke,Se)=>{sa(p,`--tone-color: ${se??""}`),E(B,e(d).character),E(h,Le),E(ce,ke),E(fe,Se),E(x,e(d).definition??"")},[()=>{var se;return a.toneColors[a.wordlist.toneFromPinyin(((se=e(d).pinyin)==null?void 0:se[0])??"")-1]},()=>{var se;return G(((se=e(d).pinyin)==null?void 0:se[0])??"",a.zhReading)},()=>a.wordlist.toSimplified(e(d).character),()=>a.wordlist.toTraditional(e(d).character)]),w(t,p)}),i(_),w(n,_),ua()}var vi=(n,a)=>a.onClose(),ci=T('<div class="modal-backdrop svelte-1eoz1nv"><div><button class="modal-close svelte-1eoz1nv" aria-label="Close"><i class="fa-solid fa-xmark"></i></button> <div class="modal-panel svelte-1eoz1nv"><div class="modal-drag-handle svelte-1eoz1nv"></div> <div class="modal-container svelte-1eoz1nv"><!></div></div></div></div>');function ui(n,a){ca(a,!0);let o=0,l=xe(0),c=xe(!1),g=xe(null);const U=100;function G(m){f(c,!1),o=m.touches[0].clientY}function W(m){var d;const t=m.touches[0].clientY-o;!e(c)&&((d=e(g))==null?void 0:d.scrollTop)===0&&t>0&&(f(c,!0),m.preventDefault()),e(c)&&f(l,Math.max(0,t),!0)}function _(){e(c)&&e(l)>U&&a.onClose(),f(c,!1),f(l,0)}var z=Je(),re=pe(z);{var D=m=>{var I=ci(),t=r(I);let d;t.__touchstart=G,t.__touchmove=W,t.__touchend=_;let p;var u=r(t);u.__click=[vi,a];var A=v(u,2),B=v(r(A),2),N=r(B);rt(N,()=>a.children??Ge),i(B),za(B,h=>f(g,h),()=>e(g)),i(A),i(t),i(I),te((h,Y)=>{d=Ce(t,1,"modal-wrapper svelte-1eoz1nv",null,d,h),p=sa(t,"",p,Y)},[()=>({"is-dragging":e(c)}),()=>({transform:`translateY(${e(l)??""}px)`})]),nt("touchcancel",t,_),w(m,I)};q(re,m=>{a.isOpen&&m(D)})}w(n,z),ua()}ba(["touchstart","touchmove","touchend","click"]);var fi=T('<button><div class="review-button-inner svelte-2pz8ii"><div class="review-time svelte-2pz8ii"> </div> <div class="review-label svelte-2pz8ii"> </div></div></button>'),_i=T('<button><div class="review-button-inner svelte-2pz8ii"><div class="review-time svelte-2pz8ii"> </div> <div class="review-label svelte-2pz8ii"> </div></div></button>'),mi=T('<div class="bottom-container svelte-2pz8ii"><div></div></div>'),hi=()=>wt.goHomeAndClearHistory(),gi=T(`<div style="margin-top: 2em" class="svelte-2pz8ii">You have done today's review.</div> <div class="bottom-container svelte-2pz8ii"><div class="review-button-container svelte-2pz8ii"><button class="button big-button svelte-2pz8ii">Go Back</button></div></div>`,1),pi=T('<div class="counter svelte-2pz8ii"><span class="underlined svelte-2pz8ii"><!></span></div>'),Ci=T('<div class="counter svelte-2pz8ii"><span> </span> <span> </span> <span> </span> <span> </span> <span> </span></div>'),yi=T('<!> <div class="character-writer-container svelte-2pz8ii"><!></div> <!>',1),wi=T('<!> <div class="container svelte-2pz8ii"><!> <!></div> <!>',1);function Mi(n,a){ca(a,!1);const o=Z(),l=Z(),c=Z(),g=(s,S=Ge,y)=>{let X=K(()=>dt(y==null?void 0:y(),""));var ee=mi(),he=r(ee);fa(he,5,S,_a,(ge,k)=>{var J=Je(),Q=pe(J);{var le=oe=>{var O=fi();let V;O.__click=function(...ie){var be;(be=e(k).alternate.onclick)==null||be.apply(this,ie)};var de=r(O),j=r(de),Re=r(j,!0);i(j);var ve=v(j,2),ze=r(ve,!0);i(ve),i(de),i(O),te(ie=>{V=Ce(O,1,(e(k),R(()=>`review-button ${e(k).alternate.className||e(k).className||""}`)),"svelte-2pz8ii",V,ie),E(Re,(e(k),R(()=>e(k).alternate.sublabel||e(k).sublabel||" "))),E(ze,(e(k),R(()=>e(k).alternate.label||e(k).label||" ")))},[()=>({"is-complete":!e(k).isComplete})],K),w(oe,O)},ae=oe=>{var O=_i();let V;O.__click=function(...ie){var be;(be=e(k).onclick)==null||be.apply(this,ie)};var de=r(O),j=r(de),Re=r(j,!0);i(j);var ve=v(j,2),ze=r(ve,!0);i(ve),i(de),i(O),te(ie=>{V=Ce(O,1,(e(k),R(()=>`review-button ${e(k).className||""}`)),"svelte-2pz8ii",V,ie),E(Re,(e(k),R(()=>e(k).sublabel||" "))),E(ze,(e(k),R(()=>e(k).label||" ")))},[()=>({"is-complete":e(k).isComplete})],K),w(oe,O)};q(Q,oe=>{e(k),R(()=>e(k).alternate&&!e(k).isComplete&&e(k).alternate.isComplete)?oe(le):oe(ae,!1)})}w(ge,J)}),i(he),i(ee),te(()=>Ce(he,1,`review-button-container ${e(X)}`,"svelte-2pz8ii")),Ta(1,ee,()=>$t,()=>U),Ta(2,ee,()=>Vt,()=>G),w(s,ee)},U={delay:100,y:-100,duration:300,easing:ei},G={duration:200};let W=ya(a,"data",8),_=W().deckId||"",z=W().cardIds||encodeURIComponent("[]"),re=JSON.parse(decodeURIComponent(z)),D=W().isExtraStudy?"Extra Study":"Review",m=Z(),I=Z(!1),t=Z(new ut),d=Z(),p=Z(!1);Ea(async()=>{var y;await e(t).init();const s=(y=e(t).deckData[_])==null?void 0:y.tags;M=s==null?void 0:s.includes(Ca.ZH_YUE);const S=s==null?void 0:s.includes(Ca.ZH_EXTRA_DICT);await N.init(M?"yue":"zh",S),f(t,e(t)),$=s==null?void 0:s.includes(Ca.ZH_TRAD),f(ce,e(t).isAutoGrading()),f(ue,e(t).getConfig().gradeWarmUpCards),f(I,!0),W().isExtraStudy&&e(t).extraStudyHandler.registerReviewCardIdsOverride(re),ne()});let u=Z(!1),A=Z(!1),B=Z(!1),N=new yt,h=Z(void 0),Y=Z(!1),$=!1,M=!1,ce=Z(!1),ue=Z(!1),P=Z(void 0),fe=Z(!1),L=Z(0);const Ze=["Fail","Hard","Good","Easy"];let x=Z(void 0),_e=Z({1:"",2:"",3:"",4:""});function Qe(){f(u,!1),f(Y,!1),f(P,void 0),f(fe,!1)}function ne(){Qe(),f(B,!0);const s=e(t).getNextCard(_);if(s===void 0){f(A,!0);return}e(t).getCard(_,s,!0)&&(f(B,!1),f(x,s),f(_e,e(t).getRatingScheduledTimeStr(_,s)),f(h,e(t).getWenbunCustomState(_,s)),lt(L))}async function Ve(){e(t).startWarmUp(_,e(x)),await e(t).save(),f(Y,!0),f(x,e(x)),f(_e,e(t).getRatingScheduledTimeStr(_,e(x))),f(h,e(t).getWenbunCustomState(_,e(x)))}async function Xe(){e(t).skipWarmUp(_,e(x)),f(Y,!0),await e(t).save(),ne()}function $e(s){const S=e(t).getCardWord(_,s),y=e(t).getConfig();return N.getCharacterWriterData(S,{convertToTraditional:$,mandarinReading:y.zh.mandarinReading,isCantonese:M,isPlayAudio:y.zh.playAudio})}function se(s){const S=e(t).getWarmUpCount(_,s),y=e(l)&&S===0;return{isFirstTime:e(o),isWarmUp:e(l),isFinalWarmUp:Ke(s),warmUpCount:S,warmUpMaxCount:e(t).getMaxWarmUpCount(),isGradeWarmUpCards:e(t).getConfig().gradeWarmUpCards,isShowOutline:e(o)||y,lang:M?"yue":"zh"}}function Le(s){f(u,!0),e(ce)&&f(P,va.getGrade(s))}async function ke(s){e(t).rateCard(_,e(x),s),await e(t).save(),ne()}function Se(s){switch(s){case F.Easy:return"review-button-easy";case F.Good:return"review-button-good";case F.Hard:return"review-button-hard";case F.Again:return"review-button-fail"}}async function Be(){e(t).addIgnoredMark(_,e(x)),await e(t).save(),ne()}function ye(){e(t).extraStudyHandler.rateAgain(e(x)),ne()}function Te(){e(t).extraStudyHandler.rateGood(e(x)),ne()}async function Ue(){e(t).storeAutoGradeLog(e(m).correctStrokeCount,e(m).incorrectStrokeCount,e(P)),e(t).rateCard(_,e(x),e(P)),await e(t).save(),ne()}function We(s){f(P,s),f(fe,!1)}async function je(){e(t).warmUpNext(_,e(x)),await e(t).save(),ne()}async function aa(){await ke(F.Again)}function Ke(s,S){const y=e(t).getWarmUpCount(_,s);return y===void 0?!0:y>=e(t).getMaxWarmUpCount()}function we(s,S){return e(t).getWarmUpCount(_,s)===0}function Ae(){e(d)&&(e(d).failAndReveal(),f(P,va.getGrade(e(m))))}function Fe(){f(p,!0)}ga(()=>(e(h),Ee),()=>{f(o,e(h)===Ee.New)}),ga(()=>(e(h),Ee),()=>{f(l,e(h)===Ee.WarmUp)}),ga(()=>e(m),()=>{var s;f(c,{label:"Reveal",sublabel:"(Fail)",className:"review-button-fail",onclick:()=>Ae(),isComplete:!((s=e(m))!=null&&s.isFailAndReveal)})}),st(),vt();var Ye=wi(),Ie=pe(Ye);ft(Ie,{get title(){return D}});var C=v(Ie,2),b=r(C);{var me=s=>{var S=gi(),y=v(pe(S),2),X=r(y),ee=r(X);ee.__click=[hi],i(X),i(y),w(s,S)};q(b,s=>{e(A)&&s(me)})}var Ne=v(b,2);{var Pe=s=>{var S=yi(),y=pe(S);pa(y,()=>e(L),J=>{var Q=Je(),le=pe(Q);{var ae=O=>{var V=pi(),de=r(V),j=r(de);pa(j,()=>e(x),Re=>{var ve=ot();te(ze=>E(ve,ze),[()=>(e(t),R(()=>e(t).extraStudyHandler.getCardsCount()||""))],K),w(Re,ve)}),i(de),i(V),w(O,V)},oe=O=>{var V=Ci(),de=r(V);let j;var Re=r(de,!0);i(de);var ve=v(de,2);let ze;var ie=r(ve,!0);i(ve);var be=v(ve,2);let la;var ma=r(be,!0);i(be);var De=v(be,2);let ea;var ha=r(De,!0);i(De);var ta=v(De,2);let He;var ia=r(ta,!0);i(ta),i(V),te((ra,qe,Fa,Ia,Na,Pa,Oa,Ha,Ma,La)=>{j=Ce(de,1,"deck-count-learn-relearn svelte-2pz8ii",null,j,ra),E(Re,qe),ze=Ce(ve,1,"deck-count-review svelte-2pz8ii",null,ze,Fa),E(ie,Ia),la=Ce(be,1,"deck-count-new svelte-2pz8ii",null,la,Na),E(ma,Pa),ea=Ce(De,1,"deck-count-new svelte-2pz8ii",null,ea,Oa),E(ha,Ha),He=Ce(ta,1,"deck-count-previously-studied svelte-2pz8ii",null,He,Ma),E(ia,La)},[()=>({underlined:e(h)===Ee.Learning||e(h)===Ee.Relearning}),()=>(e(t),R(()=>e(t).getLearningRelearningCardsCount(_)||"")),()=>({underlined:e(h)===Ee.ReviewYoung||e(h)===Ee.ReviewMature}),()=>(e(t),R(()=>e(t).getScheduledReviewCardsCount(_)||"")),()=>({underlined:e(h)===Ee.New}),()=>(e(t),R(()=>e(t).getScheduledNewCardsCount(_)||"")),()=>({underlined:e(h)===Ee.WarmUp}),()=>(e(t),R(()=>e(t).getWarmUpCardsCount(_)?`(${e(t).getWarmUpCardsCount(_)})`:"")),()=>({underlined:e(h)===Ee.PreviouslyStudied}),()=>(e(t),R(()=>e(t).getScheduledPreviouslyStudiedCardsCount(_)||""))],K),w(O,V)};q(le,O=>{xa(W()),R(()=>W().isExtraStudy)?O(ae):O(oe,!1)})}w(J,Q)});var X=v(y,2),ee=r(X);pa(ee,()=>[e(x),e(Y),e(B)],J=>{const Q=K(()=>(e(x),R(()=>$e(e(x))))),le=K(()=>(e(x),R(()=>se(e(x)))));za(Kt(J,{get app(){return e(t)},get characterData(){return e(Q)},onComplete:ae=>Le(ae),onOpenDict:()=>Fe(),get cardConfig(){return e(le)},get autoGrade(){return e(P)},get isRequestManualGrade(){return e(fe)},set isRequestManualGrade(ae){f(fe,ae)},get autoReviewData(){return e(m)},set autoReviewData(ae){f(m,ae)},$$legacy:!0}),ae=>f(d,ae),()=>e(d))}),i(X);var he=v(X,2);{var ge=J=>{g(J,()=>[{label:"Ignore",sublabel:"(Don't Learn)",className:"review-button-fail",isComplete:!0,onclick:()=>Be()},{label:"Learn*",sublabel:"(Skip Warm-Up)",className:"review-button-hard",isComplete:!0,onclick:()=>Xe()},{label:""},{label:"Learn",className:"review-button-easy main-button",isComplete:!0,onclick:()=>Ve()}])},k=(J,Q)=>{{var le=oe=>{var O=K(()=>(e(c),e(m),e(x),e(L),e(u),R(()=>{var V;return[{label:"",alternate:{...e(c),isComplete:!((V=e(m))!=null&&V.isFailAndReveal)&&!we(e(x),e(L))}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(u),onclick:()=>je()}]})));g(oe,()=>e(O))},ae=(oe,O)=>{{var V=j=>{var Re=K(()=>(e(c),e(u),R(()=>[{label:"",alternate:{...e(c),isComplete:!e(u)}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(u),onclick:()=>aa()}])));g(j,()=>e(Re))},de=(j,Re)=>{{var ve=ie=>{g(ie,()=>[{label:"Again",sublabel:"(Put Back)",className:"review-button-fail",isComplete:e(u),onclick:()=>ye(),alternate:e(c)},{label:""},{label:""},{label:"Good",className:"review-button-easy",isComplete:e(u),onclick:()=>Te()}])},ze=(ie,be)=>{{var la=De=>{var ea=K(()=>(e(c),e(u),R(()=>[{label:"",alternate:{...e(c),isComplete:!e(u)}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(u),onclick:()=>Ue()}])));g(De,()=>e(ea))},ma=(De,ea)=>{{var ha=He=>{var ia=K(()=>(e(_e),e(u),R(()=>Ze.map((ra,qe)=>({label:ra,sublabel:e(_e)[qe+1],className:Se(qe+1)+" time",isComplete:e(u),onclick:()=>We(qe+1)})))));g(He,()=>e(ia),()=>"pulsing")},ta=He=>{var ia=K(()=>(e(_e),e(u),e(c),R(()=>Ze.map((ra,qe)=>({label:ra,sublabel:e(_e)[qe+1],className:Se(qe+1)+" time",isComplete:e(u),alternate:qe==0?e(c):void 0,onclick:()=>ke(qe+1)})))));g(He,()=>e(ia))};q(De,He=>{e(ce)&&e(fe)?He(ha):He(ta,!1)},ea)}};q(ie,De=>{e(ce)&&!e(fe)?De(la):De(ma,!1)},be)}};q(j,ie=>{xa(W()),R(()=>W().isExtraStudy)?ie(ve):ie(ze,!1)},Re)}};q(oe,j=>{e(l),e(x),e(L),e(ue),R(()=>e(l)&&Ke(e(x),e(L))&&!e(ue))?j(V):j(de,!1)},O)}};q(J,oe=>{e(l),e(x),e(L),R(()=>e(l)&&!Ke(e(x),e(L)))?oe(le):oe(ae,!1)},Q)}};q(he,J=>{e(o)?J(ge):J(k,!1)})}w(s,S)};q(Ne,s=>{e(I)&&e(x)!==void 0&&!e(A)&&s(Pe)})}i(C);var Oe=v(C,2);ui(Oe,{onClose:()=>f(p,!1),get isOpen(){return e(p)},set isOpen(s){f(p,s)},children:(s,S)=>{var y=Je(),X=pe(y);{var ee=he=>{const ge=K(()=>(e(x),R(()=>$e(e(x))))),k=K(()=>(e(t),R(()=>e(t).getChineseToneColorArray())));di(he,{get characterData(){return e(ge)},get wordlist(){return N},get toneColors(){return e(k)},get zhReading(){return e(t),R(()=>e(t).getConfig().zh.mandarinReading)}})};q(X,he=>{e(x)!==void 0&&he(ee)})}w(s,y)},$$slots:{default:!0},$$legacy:!0}),w(n,Ye),ua()}ba(["click"]);export{Mi as component,Hi as universal};
