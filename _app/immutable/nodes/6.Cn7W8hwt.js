import"../chunks/CWj6FrbW.js";import{i as Je}from"../chunks/CdGgX4fi.js";import{s as se,d as Ke,o as Qe}from"../chunks/B4tcad5q.js";import{aA as We,ac as Xe,aB as Ye,aC as Ze,aD as et,o as Be,w as u,C as p,D as c,B as i,aa as tt,F as at,y as A,z as d,A as Oe,q as R,t as ee,v as rt,x as te,g as e,b as m,aE as h,aF as ae,I as P,a7 as w}from"../chunks/DCeKAzBs.js";import{i as Fe}from"../chunks/B_3B16l0.js";import{S as ot,A as it,T as st,_ as J,r as g,N as v,c as Le,e as lt,i as nt,C as re}from"../chunks/gORI0rn4.js";import{s as oe}from"../chunks/Be9VuDtp.js";import{l as vt,b as k,a as K}from"../chunks/COrSo9IO.js";import{b as dt}from"../chunks/CVSpzQKB.js";function Me(s,l,C=!1){if(s.multiple){if(l==null)return;if(!Xe(l))return Ye();for(var b of s.options)b.selected=l.includes(U(b));return}for(b of s.options){var n=U(b);if(Ze(n,l)){b.selected=!0;return}}(!C||l!==void 0)&&(s.selectedIndex=-1)}function ut(s){var l=new MutationObserver(()=>{Me(s,s.__value)});l.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),et(()=>{l.disconnect()})}function ie(s,l,C=l){var b=!0;vt(s,"change",n=>{var a=n?"[selected]":":checked",x;if(s.multiple)x=[].map.call(s.querySelectorAll(a),U);else{var I=s.querySelector(a)??s.querySelector("option:not([disabled])");x=I&&U(I)}C(x)}),We(()=>{var n=l();if(Me(s,n,b),b&&n===void 0){var a=s.querySelector(":checked");a!==null&&(n=U(a),C(n))}s.__value=n,b=!1}),ut(s)}function U(s){return"__value"in s?s.__value:s.value}var ct=u('<div class="settings-item"><label class="settings-label svelte-k8ruu5"><div><div class="settings-label-title"> </div> <div class="settings-label-help svelte-k8ruu5"> </div></div> <div class="settings-children"><!></div></label></div>');function y(s,l){Be(l,!0);const C=ot[l.key]??{label:"",help:""};var b=ct(),n=p(b),a=p(n),x=p(a),I=p(x,!0);c(x);var G=i(x,2),F=p(G,!0);c(G),c(a);var H=i(a,2),L=p(H);tt(L,()=>l.children??at),c(H),c(n),c(b),A(()=>{se(I,C.label),se(F,C.help)}),d(s,b),Oe()}var _t=(s,l)=>l(),pt=(s,l)=>l(),ft=(s,l)=>l(),ht=u('<textarea class="profile-textarea svelte-9vzc0u"></textarea> <button class="button svelte-9vzc0u">import</button> <div class="settings-label-help svelte-9vzc0u" style="margin: 1em 0">To manually export the profile data, copy the text above and store it somewhere safe.<br/> To manually import the profile data, paste the text into the textbox and click the import button.</div> <button class="button svelte-9vzc0u">Reset Debug Profile</button>',1),yt=(s,l)=>m(l,!e(l)),mt=(s,l)=>e(l).downloadProfile(),bt=(s,l)=>l(),gt=u('<input type="number" class="svelte-9vzc0u"/>'),$t=u('<input type="number" class="svelte-9vzc0u"/>'),St=u("<select disabled><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),zt=u('<input type="number" class="svelte-9vzc0u"/>'),Pt=u("<select disabled><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),wt=u('<input type="text"/>'),kt=u('<input type="text"/>'),Ct=u('<div style="display: flex; flex-direction: row; align-items: center; gap: 0.5em;"><input type="number" step="0.01" class="svelte-9vzc0u"/></div>'),xt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Rt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Tt=u("<textarea></textarea>"),Dt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),At=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Ft=(s,l,C)=>l(e(C)),Lt=u("<option> </option>"),Bt=u("<div><div>Load Preset</div> <div><select></select></div></div>"),Ot=u('<input type="color" class="svelte-9vzc0u"/>'),Mt=u('<input type="color" class="svelte-9vzc0u"/>'),qt=u('<input type="color" class="svelte-9vzc0u"/>'),It=u('<input type="color" class="svelte-9vzc0u"/>'),Nt=u('<input type="color" class="svelte-9vzc0u"/>'),Vt=u(`<div class="settings-section svelte-9vzc0u"><button class="button svelte-9vzc0u">Save</button></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Profile</div> <div class="section-container svelte-9vzc0u"><!> <button class="button svelte-9vzc0u">manual import/export</button> <button class="button svelte-9vzc0u"><i class="fa-solid fa-download"></i>&nbsp;
                    export profile data (download)</button> <button class="button svelte-9vzc0u"><i class="fa-solid fa-upload"></i>&nbsp;
                    import profile data (upload)</button></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Learning</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">FSRS</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Chinese</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!> <!> <!> <!></div></div>`,1),jt=u('<!> <div class="main-container svelte-9vzc0u"><!></div>',1);function Yt(s,l){Be(l,!1);const C=R(),b=R();let n=R(new it),a=R(),x=R();Qe(async()=>{await e(n).init(),m(a,J.cloneDeep(e(n).getConfig())),m(x,J.cloneDeep(e(a))),m(L,e(a).learningSteps.join(" ")),m(j,e(a).previouslyStudiedLearningSteps.join(" ")),m(E,e(a).FSRSParams.join(",")),m(B,e(n).exportProfile()),m(Q,e(B)),m(n,e(n))});async function I(){await e(n).saveConfig(e(a)),m(x,J.cloneDeep(e(a)))}async function G(){window.confirm("Are you sure you want to reset to the debug profile?")&&(await e(n).debug(),m(n,e(n)))}let F=R("");function H(S){const N=re[S];N&&h(a,e(a).zh.toneColors=N),m(F,"")}let L=R(""),j=R(""),E=R(""),le=R(!1),B=R(""),Q=R("");function qe(){e(n).tryImportProfile(e(B)).then(S=>{S||window.alert("Failed to import profile data")})}async function Ie(){await e(n).tryUploadProfile()||window.alert("Failed to import profile data")}ee(()=>(e(a),e(x)),()=>{m(C,!J.isEqual(e(a),e(x)))}),ee(()=>(e(a),e(L),e(j),e(E)),()=>{if(e(a)){const S=e(L).split(" ").map(_=>_.trim()).filter(_=>_);S.length<4&&S.every(_=>_.match(/^\d+[m|d]$/))&&h(a,e(a).learningSteps=S);const O=e(j).split(" ").map(_=>_.trim()).filter(_=>_);O.length<4&&O.every(_=>_.match(/^\d+[m|d]$/))&&h(a,e(a).previouslyStudiedLearningSteps=O);const M=e(E).split(",").map(_=>_.trim()).filter(_=>_);M.length===21&&M.every(_=>!isNaN(parseFloat(_)))&&h(a,e(a).FSRSParams=M.map(_=>parseFloat(_)))}}),ee(()=>(e(B),e(Q)),()=>{m(b,e(B)!==e(Q))}),rt(),Je();var ne=jt(),ve=te(ne);st(ve,{title:"Settings",get backUrl(){return`${dt??""}/`},isSettings:!0});var de=i(ve,2),Ne=p(de);{var Ve=S=>{var N=Vt(),O=te(N),W=p(O);W.__click=[_t,I],c(O);var M=i(O,2),X=i(p(M),2),_=p(X);{var je=o=>{var f=ht(),t=te(f);Le(t);var r=i(t,2);r.__click=[pt,qe];var $=i(r,4);$.__click=[ft,G],A(()=>r.disabled=!e(b)),k(t,()=>e(B),z=>m(B,z)),d(o,f)};Fe(_,o=>{e(le)&&o(je)})}var ue=i(_,2);ue.__click=[yt,le];var ce=i(ue,2);ce.__click=[mt,n];var Ee=i(ce,2);Ee.__click=[bt,Ie],c(X),c(M);var Y=i(M,2),_e=i(p(Y),2),pe=p(_e);y(pe,{key:"newCardPerDay",children:(o,f)=>{var t=gt();g(t),k(t,()=>e(a).newCardPerDay,r=>h(a,e(a).newCardPerDay=r)),d(o,t)},$$slots:{default:!0}});var fe=i(pe,2);y(fe,{key:"maxReviewsPerDay",children:(o,f)=>{var t=$t();g(t),k(t,()=>e(a).maxReviewsPerDay,r=>h(a,e(a).maxReviewsPerDay=r)),d(o,t)},$$slots:{default:!0}});var he=i(fe,2);y(he,{key:"newCardOrder",children:(o,f)=>{var t=St();A(()=>{e(a),ae(()=>{})});var r=p(t),$={},z=i(r),D={},T=i(z),q={};c(t),A(()=>{$!==($=(w(v),P(()=>v.Mix)))&&(r.value=(r.__value=(w(v),P(()=>v.Mix)))??""),D!==(D=(w(v),P(()=>v.AfterReviews)))&&(z.value=(z.__value=(w(v),P(()=>v.AfterReviews)))??""),q!==(q=(w(v),P(()=>v.BeforeReviews)))&&(T.value=(T.__value=(w(v),P(()=>v.BeforeReviews)))??"")}),ie(t,()=>e(a).newCardOrder,V=>h(a,e(a).newCardOrder=V)),d(o,t)},$$slots:{default:!0}});var ye=i(he,2);y(ye,{key:"newPreviouslyStudiedCardPerDay",children:(o,f)=>{var t=zt();g(t),k(t,()=>e(a).newPreviouslyStudiedCardPerDay,r=>h(a,e(a).newPreviouslyStudiedCardPerDay=r)),d(o,t)},$$slots:{default:!0}});var Ue=i(ye,2);y(Ue,{key:"newPreviouslyStudiedCardOrder",children:(o,f)=>{var t=Pt();A(()=>{e(a),ae(()=>{})});var r=p(t),$={},z=i(r),D={},T=i(z),q={};c(t),A(()=>{$!==($=(w(v),P(()=>v.Mix)))&&(r.value=(r.__value=(w(v),P(()=>v.Mix)))??""),D!==(D=(w(v),P(()=>v.AfterReviews)))&&(z.value=(z.__value=(w(v),P(()=>v.AfterReviews)))??""),q!==(q=(w(v),P(()=>v.BeforeReviews)))&&(T.value=(T.__value=(w(v),P(()=>v.BeforeReviews)))??"")}),ie(t,()=>e(a).newPreviouslyStudiedCardOrder,V=>h(a,e(a).newPreviouslyStudiedCardOrder=V)),d(o,t)},$$slots:{default:!0}}),c(_e),c(Y);var Z=i(Y,2),me=i(p(Z),2),be=p(me);y(be,{key:"learningSteps",children:(o,f)=>{var t=wt();g(t),oe(t,1,"svelte-9vzc0u",null,{},{invalid:!1}),k(t,()=>e(L),r=>m(L,r)),d(o,t)},$$slots:{default:!0}});var ge=i(be,2);y(ge,{key:"previouslyStudiedLearningSteps",children:(o,f)=>{var t=kt();g(t),oe(t,1,"svelte-9vzc0u",null,{},{invalid:!1}),k(t,()=>e(j),r=>m(j,r)),d(o,t)},$$slots:{default:!0}});var $e=i(ge,2);y($e,{key:"desiredRetention",children:(o,f)=>{var t=Ct(),r=p(t);g(r),c(t),k(r,()=>e(a).desiredRetention,$=>h(a,e(a).desiredRetention=$)),d(o,t)},$$slots:{default:!0}});var Se=i($e,2);y(Se,{key:"enableShortTerm",children:(o,f)=>{var t=xt();g(t),K(t,()=>e(a).enableShortTerm,r=>h(a,e(a).enableShortTerm=r)),d(o,t)},$$slots:{default:!0}});var ze=i(Se,2);y(ze,{key:"enableFuzz",children:(o,f)=>{var t=Rt();g(t),K(t,()=>e(a).enableFuzz,r=>h(a,e(a).enableFuzz=r)),d(o,t)},$$slots:{default:!0}});var Ge=i(ze,2);y(Ge,{key:"FSRSParams",children:(o,f)=>{var t=Tt();Le(t),oe(t,1,"",null,{},{invalid:!1}),k(t,()=>e(E),r=>m(E,r)),d(o,t)},$$slots:{default:!0}}),c(me),c(Z);var Pe=i(Z,2),we=i(p(Pe),2),ke=p(we);y(ke,{key:"zhAlwaysShowReading",children:(o,f)=>{var t=Dt();g(t),K(t,()=>e(a).zh.alwaysShowReading,r=>h(a,e(a).zh.alwaysShowReading=r)),d(o,t)},$$slots:{default:!0}});var Ce=i(ke,2);y(Ce,{key:"zhIsColorBasedOnTone",children:(o,f)=>{var t=At();g(t),K(t,()=>e(a).zh.isColorBasedOnTone,r=>h(a,e(a).zh.isColorBasedOnTone=r)),d(o,t)},$$slots:{default:!0}});var xe=i(Ce,2);y(xe,{key:"zhToneColors",children:(o,f)=>{var t=Bt(),r=i(p(t),2),$=p(r);A(()=>{e(F),ae(()=>{})}),$.__change=[Ft,H,F],lt($,5,()=>(w(re),P(()=>Object.keys(re))),nt,(z,D)=>{var T=Lt(),q=p(T,!0);c(T);var V={};A(()=>{se(q,e(D)),V!==(V=e(D))&&(T.value=(T.__value=e(D))??"")}),d(z,T)}),c($),c(r),c(t),ie($,()=>e(F),z=>m(F,z)),d(o,t)},$$slots:{default:!0}});var Re=i(xe,2);y(Re,{key:"zhTone1",children:(o,f)=>{var t=Ot();g(t),k(t,()=>e(a).zh.toneColors[0],r=>h(a,e(a).zh.toneColors[0]=r)),d(o,t)},$$slots:{default:!0}});var Te=i(Re,2);y(Te,{key:"zhTone2",children:(o,f)=>{var t=Mt();g(t),k(t,()=>e(a).zh.toneColors[1],r=>h(a,e(a).zh.toneColors[1]=r)),d(o,t)},$$slots:{default:!0}});var De=i(Te,2);y(De,{key:"zhTone3",children:(o,f)=>{var t=qt();g(t),k(t,()=>e(a).zh.toneColors[2],r=>h(a,e(a).zh.toneColors[2]=r)),d(o,t)},$$slots:{default:!0}});var Ae=i(De,2);y(Ae,{key:"zhTone4",children:(o,f)=>{var t=It();g(t),k(t,()=>e(a).zh.toneColors[3],r=>h(a,e(a).zh.toneColors[3]=r)),d(o,t)},$$slots:{default:!0}});var He=i(Ae,2);y(He,{key:"zhToneNeutral",children:(o,f)=>{var t=Nt();g(t),k(t,()=>e(a).zh.toneColors[4],r=>h(a,e(a).zh.toneColors[4]=r)),d(o,t)},$$slots:{default:!0}}),c(we),c(Pe),A(()=>W.disabled=!e(C)),d(S,N)};Fe(Ne,S=>{e(a)&&S(Ve)})}c(de),d(s,ne),Oe()}Ke(["click","change"]);export{Yt as component};
