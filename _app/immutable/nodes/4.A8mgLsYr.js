var ge=n=>{throw TypeError(n)};var we=(n,i,t)=>i.has(n)||ge("Cannot "+t);var f=(n,i,t)=>(we(n,i,"read from private field"),t?t.call(n):i.get(n)),E=(n,i,t)=>i.has(n)?ge("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(n):i.set(n,t);var ae=(n,i,t)=>(we(n,i,"access private method"),t);import"../chunks/CWj6FrbW.js";import"../chunks/CzuHQAlO.js";import{g as se,u as Se,h as it,i as e,j as d,k as re,a1 as nt,p as ot,a2 as T,a3 as lt,a4 as xe,a5 as ct,f as D,a as Ce,d as b,s as m,b as C,c as dt,r as v,K as _,t as ie,e as $,a6 as ut,M as vt}from"../chunks/D4HdPs5E.js";import{i as H}from"../chunks/Bw_0fAwL.js";import{e as Me,i as De}from"../chunks/B7geMYGs.js";import{T as ft,r as bt}from"../chunks/CcT7QBTQ.js";import{s as ne}from"../chunks/Ds6VENQq.js";import{b as _t}from"../chunks/LKguCHR4.js";import{i as pt}from"../chunks/Dr98OFL6.js";import{p as mt}from"../chunks/un3tHoYv.js";import{a as yt,b as ht}from"../chunks/D6hwZJv5.js";import{A as kt,D as gt,W as h}from"../chunks/D7u-EGIW.js";import{c as wt,d as St}from"../chunks/BCChLZ-9.js";import{S as xt}from"../chunks/Xahq3A07.js";const Ct=({url:n})=>({deckId:n.searchParams.get("id")||""}),ca=Object.freeze(Object.defineProperty({__proto__:null,load:Ct},Symbol.toStringTag,{value:"Module"}));var Mt=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Dt=["difference","intersection","symmetricDifference","union"],ze=!1,I,g,M,Y,O,Te,Ae;const J=class J extends Set{constructor(t){super();E(this,O);E(this,I,new Map);E(this,g,se(0));E(this,M,se(0));E(this,Y,Se||-1);if(t){for(var c of t)super.add(c);f(this,M).v=super.size}ze||ae(this,O,Ae).call(this)}has(t){var c=super.has(t),k=f(this,I),l=k.get(t);if(l===void 0){if(!c)return e(f(this,g)),!1;l=ae(this,O,Te).call(this,!0),k.set(t,l)}return e(l),c}add(t){return super.has(t)||(super.add(t),d(f(this,M),super.size),re(f(this,g))),this}delete(t){var c=super.delete(t),k=f(this,I),l=k.get(t);return l!==void 0&&(k.delete(t),d(l,!1)),c&&(d(f(this,M),super.size),re(f(this,g))),c}clear(){if(super.size!==0){super.clear();var t=f(this,I);for(var c of t.values())d(c,!1);t.clear(),d(f(this,M),0),re(f(this,g))}}keys(){return this.values()}values(){return e(f(this,g)),super.values()}entries(){return e(f(this,g)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return e(f(this,M))}};I=new WeakMap,g=new WeakMap,M=new WeakMap,Y=new WeakMap,O=new WeakSet,Te=function(t){return Se===f(this,Y)?se(t):it(t)},Ae=function(){ze=!0;var t=J.prototype,c=Set.prototype;for(const k of Mt)t[k]=function(...l){return e(f(this,g)),c[k].apply(this,l)};for(const k of Dt)t[k]=function(...l){e(f(this,g));var R=c[k].apply(this,l);return new J(R)}};let oe=J;var zt=(n,i)=>i(),Tt=(n,i)=>i(),At=(n,i,t)=>i(e(t).label),Pt=D('<i class="fa-solid fa-chevron-down"></i>'),Et=D('<i class="fa-solid fa-chevron-right"></i>'),It=(n,i)=>i(),Ot=(n,i)=>i(),Nt=(n,i)=>i(),Wt=(n,i)=>i(),Ut=(n,i)=>i(),jt=(n,i)=>i(),Gt=D('<div style="display: flex; flex-direction: row; justify-content: space-between; width: 100%; gap: 0.5em;"><div class="group-buttons-container svelte-1y9bbfb" style="align-items: flex-start;"><button class="button svelte-1y9bbfb"><i class="fa-solid fa-xmark"></i>cancel selection</button> <button class="button svelte-1y9bbfb"><i class="fa-solid fa-check-double"></i>select all</button></div> <div class="group-buttons-container svelte-1y9bbfb" style="align-items: flex-end;"><button class="button svelte-1y9bbfb"><i class="fa-solid fa-book-open"></i><span>mark as <b>previously studied</b></span></button> <button class="button svelte-1y9bbfb"><i class="fa-solid fa-book-open"></i><span>remove <b>previously studied</b> mark</span></button> <button class="button svelte-1y9bbfb"><i class="fa-solid fa-square-xmark"></i><span>mark as <b>ignored</b></span></button> <button class="button svelte-1y9bbfb"><i class="fa-solid fa-square-xmark"></i><span>remove <b>ignored</b> mark</span></button></div></div>'),Rt=(n,i,t,c)=>i(e(t).label,e(c)),qt=(n,i,t,c)=>{n.key=="Enter"&&i(e(t).label,e(c))},Ft=(n,i,t,c)=>i(e(t).label,e(c),n),Lt=D('<button class="button select-button svelte-1y9bbfb">select</button>'),Bt=D('<div role="button" tabindex="0"><!> <div class="card-word svelte-1y9bbfb"><span class="word chinese-font"> </span></div> <div class="card-details svelte-1y9bbfb"><div> </div> <div> </div></div></div>'),Kt=D('<!> <div class="group-content svelte-1y9bbfb"></div>',1),Zt=D('<div class="group svelte-1y9bbfb"><button class="group-header svelte-1y9bbfb"><div> </div> <div><!></div></button> <!></div>'),$t=D('<!> <div class="container svelte-1y9bbfb"><div class="top-container" style="display: flex; gap: 0.5em; margin-bottom: 2em"><div class="top-control-container svelte-1y9bbfb"><div style="display: flex; gap: 0.5em; align-items: center;"><button class="button svelte-1y9bbfb">Split into groups of</button> <input class="input" type="number" min="1" max="100"/></div> <button class="button delete-button svelte-1y9bbfb"><i class="fa-solid fa-trash"></i> Delete this Deck</button></div></div> <div class="group-container svelte-1y9bbfb"></div></div>',1);function da(n,i){ot(i,!1);const t=T(),c=T();let l=mt(i,"data",8)().deckId||"",R=!1,le,r=T(new kt);lt(async()=>{await e(r).init(),ce(),await e(r).initProfile()&&ce()});function ce(){var s,a;R=(a=(s=e(r).deckData[l])==null?void 0:s.tags)==null?void 0:a.includes(wt.ZH_TRAD),le=new St("cn","tw"),d(r,e(r))}let x=T(new xt);function Pe(s){e(x).set(s,!e(x).get(s)),d(x,e(x))}function Q(s,a,y){switch(y.getWenbunCustomState(s,a)??h.New){case h.New:return"card-status-new";case h.WarmUp:return"card-status-new";case h.Learning:return"card-status-learning";case h.ReviewYoung:return"card-status-review-young";case h.ReviewMature:return"card-status-review-mature";case h.Relearning:return"card-status-relearning";case h.PreviouslyStudied:return"card-status-previously-studied";case h.Ignored:return"card-status-ignored"}}function Ee(s,a){const y=e(r).getCardWord(s,a);return R?le.convert(y):y}let q=T(gt);async function Ie(){const s=Math.ceil(e(t).deck.length/e(q));window.confirm(`Split the deck into ${s} groups?`)&&(e(r).splitDeckIntoGroupOfN(l,e(q)),await e(r).save(),d(r,e(r)))}async function Oe(){const s=window.confirm("Are you sure you want to delete this deck?");if(!s)return;const a=window.confirm("Are you really sure you want to delete this deck? All data will be lost.");a&&(e(r).deleteDeck(l,s&&a),await e(r).save(),yt(`${ht}/`))}let p=T(null),o=T(new oe);function Ne(s,a,y){y==null||y.stopPropagation(),d(p,s),e(o).clear(),a!=null&&e(o).add(a),d(o,e(o))}function We(){d(p,null),e(o).clear(),d(o,e(o))}function Ue(s,a,y){return e(p)==s&&y.has(a)}function de(s,a){e(p)==s&&(e(o).has(a)?e(o).delete(a):e(o).add(a),d(o,e(o)))}function je(){if(e(p)==null)return;const s=e(t).groups.find(a=>a.label==e(p));if(s!=null){e(o).clear();for(const a of s.cardIds)e(o).add(a);d(o,e(o))}}async function Ge(){e(p)!=null&&(e(o).forEach(s=>{e(r).addPreviouslyStudiedMark(l,s)}),await e(r).save(),d(r,e(r)))}async function Re(){e(p)!=null&&(e(o).forEach(s=>{e(r).removePreviouslyStudiedMark(l,s)}),await e(r).save(),d(r,e(r)))}async function qe(){e(p)!=null&&(e(o).forEach(s=>{e(r).addIgnoredMark(l,s)}),await e(r).save(),d(r,e(r)))}async function Fe(){e(p)!=null&&(e(o).forEach(s=>{e(r).removeIgnoredMark(l,s)}),await e(r).save(),d(r,e(r)))}function Le(s){return s===h.WarmUp?h.New:s}xe(()=>e(r),()=>{d(t,e(r).deckData[l])}),xe(()=>e(t),()=>{var s;d(c,((s=e(t))==null?void 0:s.groups)??[])}),ct(),pt();var ue=$t(),ve=Ce(ue);ft(ve,{title:"Deck"});var fe=m(ve,2),V=b(fe),be=b(V),X=b(be),_e=b(X);_e.__click=[zt,Ie];var pe=m(_e,2);bt(pe),v(X);var Be=m(X,2);Be.__click=[Tt,Oe],v(be),v(V);var me=m(V,2);Me(me,5,()=>e(c),De,(s,a)=>{var y=Zt(),F=b(y);F.__click=[At,Pe,a];var ee=b(F),Ke=b(ee,!0);v(ee);var ye=m(ee,2),Ze=b(ye);{var $e=w=>{var A=Pt();C(w,A)},He=w=>{var A=Et();C(w,A)};H(Ze,w=>{e(x),e(a),_(()=>e(x).get(e(a).label))?w($e):w(He,!1)})}v(ye),v(F);var Ye=m(F,2);{var Je=w=>{var A=Kt(),he=Ce(A);{var Qe=N=>{var u=Gt(),S=b(u),W=b(S);W.__click=[It,We];var L=m(W,2);L.__click=[Ot,je],v(S);var B=m(S,2),z=b(B);z.__click=[Nt,Ge];var P=m(z,2);P.__click=[Wt,Re];var U=m(P,2);U.__click=[Ut,qe];var j=m(U,2);j.__click=[jt,Fe],v(B),v(u),ie(()=>{z.disabled=(e(o),_(()=>e(o).size==0)),P.disabled=(e(o),_(()=>e(o).size==0)),U.disabled=(e(o),_(()=>e(o).size==0)),j.disabled=(e(o),_(()=>e(o).size==0))}),C(N,u)};H(he,N=>{e(p),e(a),_(()=>e(p)==e(a).label)&&N(Qe)})}var ke=m(he,2);Me(ke,5,()=>(e(a),_(()=>e(a).cardIds)),De,(N,u)=>{var S=Bt();let W;S.__click=[Rt,de,a,u],S.__keydown=[qt,de,a,u];var L=b(S);{var B=G=>{var Z=Lt();Z.__click=[Ft,Ne,a,u],C(G,Z)};H(L,G=>{e(p),e(a),_(()=>e(p)!=e(a).label)&&G(B)})}var z=m(L,2),P=b(z),U=b(P,!0);v(P),v(z);var j=m(z,2),K=b(j),Ve=b(K,!0);v(K);var te=m(K,2),Xe=b(te,!0);v(te),v(j),v(S),ie((G,Z,et,tt,at,st,rt)=>{W=ne(S,1,G,"svelte-1y9bbfb",W,Z),$(U,et),ne(K,1,tt,"svelte-1y9bbfb"),$(Ve,at),ne(te,1,st,"svelte-1y9bbfb"),$(Xe,rt)},[()=>(e(u),e(r),_(()=>`card ${Q(l,e(u),e(r))}`)),()=>({selectable:e(p)==e(a).label,selected:Ue(e(a).label,e(u),e(o))}),()=>(e(u),_(()=>Ee(l,e(u)))),()=>(e(u),e(r),_(()=>`status ${Q(l,e(u),e(r))}`)),()=>(e(r),e(u),vt(h),_(()=>Le(e(r).getWenbunCustomState(l,e(u))??h.New))),()=>(e(u),e(r),_(()=>`due ${Q(l,e(u),e(r))}`)),()=>(e(r),e(u),_(()=>e(r).getCardDueFormatted(l,e(u))))],ut),C(N,S)}),v(ke),C(w,A)};H(Ye,w=>{e(x),e(a),_(()=>e(x).get(e(a).label))&&w(Je)})}v(y),ie(()=>$(Ke,(e(a),_(()=>e(a).label=="__ungrouped__"?"Ungrouped":e(a).label)))),C(s,y)}),v(me),v(fe),_t(pe,()=>e(q),s=>d(q,s)),C(n,ue),dt()}nt(["click","keydown"]);export{da as component,ca as universal};
