var Bt=Object.defineProperty;var Zt=(n,t,l)=>t in n?Bt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[t]=l;var nt=(n,t,l)=>Zt(n,typeof t!="symbol"?t+"":t,l);import"../chunks/CWj6FrbW.js";import"../chunks/BR-jNC44.js";import{l as Dt,n as W,a5 as Xt,aU as jt,ai as Kt,aV as Jt,aW as Qt,aX as Vt,aY as $t,aZ as ea,a_ as Et,a$ as ta,q as aa,w as Ge,ak as bt,p as ct,g as xe,at as ia,al as Ut,j as f,f as A,d as r,r as i,s as c,i as e,t as re,e as q,aT as Wt,b as w,c as ut,a as pe,aJ as Je,ao as qt,X as J,M as ra,b0 as na,v as sa,b1 as la,a9 as X,am as gt,an as oa,aM as da,P as xt,aq as va,b2 as ca}from"../chunks/BNrJ_7a3.js";import{i as N}from"../chunks/Dag-yXur.js";import{k as pt}from"../chunks/B185AYG7.js";import{e as ft,i as _t}from"../chunks/bkIv8HrQ.js";import{s as ye}from"../chunks/DoH2Tnow.js";import{b as zt}from"../chunks/D-XOtfl0.js";import{i as ua}from"../chunks/1lHFToNQ.js";import{p as Ct}from"../chunks/BTdz68iL.js";import{b as fa}from"../chunks/Xv_LnwQ6.js";import{l as L,A as _a,W as Ee}from"../chunks/CSGCvJxP.js";import{s as H,T as ma}from"../chunks/BCvXdneq.js";import{s as st}from"../chunks/IyXAK3m2.js";import{c as ha}from"../chunks/Co-1QMVx.js";import{H as ga}from"../chunks/DcL13wi7.js";import{m as kt,b as pa,n as ya,T as dt,p as Gt,e as Ca,o as wa,c as yt,C as ba}from"../chunks/CMR42ROY.js";import{n as xa}from"../chunks/QbTV1fVF.js";function ka(n,t,l){Dt(()=>{var s=W(()=>t(n,l==null?void 0:l())||{});if(s!=null&&s.destroy)return()=>s.destroy()})}const Sa=()=>performance.now(),He={tick:n=>requestAnimationFrame(n),now:()=>Sa(),tasks:new Set};function Ft(){const n=He.now();He.tasks.forEach(t=>{t.c(n)||(He.tasks.delete(t),t.f())}),He.tasks.size!==0&&He.tick(Ft)}function Ta(n){let t;return He.tasks.size===0&&He.tick(Ft),{promise:new Promise(l=>{He.tasks.add(t={c:n,f:l})}),abort(){He.tasks.delete(t)}}}function ot(n,t){Et(()=>{n.dispatchEvent(new CustomEvent(t))})}function Ra(n){if(n==="float")return"cssFloat";if(n==="offset")return"cssOffset";if(n.startsWith("--"))return n;const t=n.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(l=>l[0].toUpperCase()+l.slice(1)).join("")}function St(n){const t={},l=n.split(";");for(const s of l){const[u,h]=s.split(":");if(!u||h===void 0)break;const z=Ra(u.trim());t[z]=h.trim()}return t}const Aa=n=>n;function Tt(n,t,l,s){var u=(n&$t)!==0,h=(n&ea)!==0,z=u&&h,G=(n&Vt)!==0,F=z?"both":u?"in":"out",m,I=t.inert,te=t.style.overflow,E,k;function M(){return Et(()=>m??(m=l()(t,(s==null?void 0:s())??{},{direction:F})))}var a={is_global:G,in(){var v;if(t.inert=I,!u){k==null||k.abort(),(v=k==null?void 0:k.reset)==null||v.call(k);return}h||E==null||E.abort(),ot(t,"introstart"),E=wt(t,M(),k,1,()=>{ot(t,"introend"),E==null||E.abort(),E=m=void 0,t.style.overflow=te})},out(v){if(!h){v==null||v(),m=void 0;return}t.inert=!0,ot(t,"outrostart"),k=wt(t,M(),E,0,()=>{ot(t,"outroend"),v==null||v()})},stop:()=>{E==null||E.abort(),k==null||k.abort()}},d=Xt;if((d.transitions??(d.transitions=[])).push(a),u&&jt){var y=G;if(!y){for(var _=d.parent;_&&(_.f&Kt)!==0;)for(;(_=_.parent)&&(_.f&Jt)===0;);y=!_||(_.f&Qt)!==0}y&&Dt(()=>{W(()=>a.in())})}}function wt(n,t,l,s,u){var h=s===1;if(ta(t)){var z,G=!1;return aa(()=>{if(!G){var d=t({direction:h?"in":"out"});z=wt(n,d,l,s,u)}}),{abort:()=>{G=!0,z==null||z.abort()},deactivate:()=>z.deactivate(),reset:()=>z.reset(),t:()=>z.t()}}if(l==null||l.deactivate(),!(t!=null&&t.duration))return u(),{abort:Ge,deactivate:Ge,reset:Ge,t:()=>s};const{delay:F=0,css:m,tick:I,easing:te=Aa}=t;var E=[];if(h&&l===void 0&&(I&&I(0,1),m)){var k=St(m(0,1));E.push(k,k)}var M=()=>1-s,a=n.animate(E,{duration:F,fill:"forwards"});return a.onfinish=()=>{a.cancel();var d=(l==null?void 0:l.t())??1-s;l==null||l.abort();var y=s-d,_=t.duration*Math.abs(y),v=[];if(_>0){var D=!1;if(m)for(var b=Math.ceil(_/16.666666666666668),g=0;g<=b;g+=1){var Y=d+y*te(g/b),Z=St(m(Y,1-Y));v.push(Z),D||(D=Z.overflow==="hidden")}D&&(n.style.overflow="hidden"),M=()=>{var P=a.currentTime;return d+y*te(P/_)},I&&Ta(()=>{if(a.playState!=="running")return!1;var P=M();return I(P,1-P),!0})}a=n.animate(v,{duration:_,fill:"forwards"}),a.onfinish=()=>{M=()=>s,I==null||I(s,1-s),u()}},{abort:()=>{a&&(a.cancel(),a.effect=null,a.onfinish=Ge)},deactivate:()=>{u=Ge},reset:()=>{s===0&&(I==null||I(1,0))},t:()=>M()}}const Da=({url:n})=>({deckId:n.searchParams.get("id")||"",isExtraStudy:n.searchParams.get("isExtraStudy")==="true",cardIds:n.searchParams.get("cardIds")||encodeURIComponent("[]")}),Yi=Object.freeze(Object.defineProperty({__proto__:null,load:Da},Symbol.toStringTag,{value:"Module"}));class Ea{constructor(t,l=!0){nt(this,"audios");nt(this,"currentIndex",0);nt(this,"isPlaying",!1);nt(this,"onEnded",this.handleEnded.bind(this));this.audios=t.map(s=>{const u=new Audio(s);return u.preload="auto",l&&u.load(),u})}handleEnded(){this.audios[this.currentIndex].removeEventListener("ended",this.onEnded),this.currentIndex++,this.currentIndex<this.audios.length?this.playCurrent():(this.isPlaying=!1,this.currentIndex=0)}playCurrent(){const t=this.audios[this.currentIndex];t.addEventListener("ended",this.onEnded),t.currentTime=0,t.play().catch(l=>{console.warn("Playback failed:",l),this.stop()})}play(){this.audios.length!==0&&(this.isPlaying&&this.stop(),this.isPlaying=!0,this.currentIndex=0,this.playCurrent())}stop(){if(!this.isPlaying)return;this.isPlaying=!1;const t=this.audios[this.currentIndex];t.pause(),t.currentTime=0,t.removeEventListener("ended",this.onEnded),this.currentIndex=0}}const Ua={[L.Again]:"Fail",[L.Hard]:"Hard",[L.Good]:"Good",[L.Easy]:"Easy"},Wa={[L.Again]:"again",[L.Hard]:"hard",[L.Good]:"good",[L.Easy]:"easy"},qa={[L.Again]:"fa fa-solid fa-face-frown",[L.Hard]:"fa fa-solid fa-face-meh",[L.Good]:"fa fa-solid fa-face-smile",[L.Easy]:"fa fa-solid fa-star"};var vt;(n=>{function t(s){if(s.isFailAndReveal)return L.Again;const u=s.correctStrokeCount===0?1/0:s.incorrectStrokeCount/s.correctStrokeCount;return u<.25||s.incorrectStrokeCount<=2?L.Good:u<.75||s.incorrectStrokeCount<=4?L.Hard:L.Again}n.getGrade=t;function l(s){switch(s){case L.Again:return"Again";case L.Hard:return"Hard";case L.Good:return"Good";default:return"Unknown"}}n.gradeToLabel=l})(vt||(vt={}));var za=(n,t)=>t(),Ga=A('<button class="audio-button svelte-xlnlhl" aria-label="Play Audio"><i class="fa-solid fa-volume-low svelte-xlnlhl"></i></button>'),Fa=A('<div class="new-element-indicator svelte-xlnlhl">New Card</div>'),Ia=A("<div>Warm Up</div>"),Na=A('<div class="new-element-indicator is-hidden svelte-xlnlhl"></div>'),Pa=(n,t)=>t.onOpenDict(),La=A('<span class="svelte-xlnlhl"> </span>'),Oa=A('<span class="empty-character-box svelte-xlnlhl">&#x3000;</span>'),Ha=A('<!> <div class="right-side svelte-xlnlhl"><button class="button dict-button svelte-xlnlhl"><i class="fa-solid fa-book svelte-xlnlhl"></i> Dict</button> <div class="character-box-container chinese-font svelte-xlnlhl"></div></div>',1),Ma=(n,t)=>t(),Ya=A('<i class="fa-solid fa-play svelte-xlnlhl"></i>'),Ba=A('<i class="fa-solid fa-forward svelte-xlnlhl"></i>'),Za=A('<button class="stroke-speed-button svelte-xlnlhl"><!> <span class="svelte-xlnlhl"> </span></button>'),Xa=(n,t)=>t(),ja=A('<i style="font-size: 2.4em" class="fa fa-solid fa-seedling svelte-xlnlhl"></i> <span class="svelte-xlnlhl">New</span>',1),Ka=A('<i></i> <span class="svelte-xlnlhl"> </span>',1),Ja=A("<button><!></button>"),Qa=A('<div class="character-writer svelte-xlnlhl"><div class="meaning svelte-xlnlhl"> </div> <div><div class="reading svelte-xlnlhl"> </div> <!></div> <div class="character-container svelte-xlnlhl"><div class="grid-background svelte-xlnlhl"><svg xmlns="http://www.w3.org/2000/svg" id="grid-background-target" class="svelte-xlnlhl"><line class="svelte-xlnlhl"></line><line class="svelte-xlnlhl"></line><line class="svelte-xlnlhl"></line><line class="svelte-xlnlhl"></line></svg></div> <div class="bottom-container svelte-xlnlhl"><!></div> <!> <!></div></div>');function Va(n,t){var Ie;ct(t,!0);let l=xe(500),s=xe(500),u=xe(30),h=Wt(()=>e(u)),z="#DDD";const G=500,F=new Audio(`${fa}/assets/sounds/correct-choice-43861.mp3`);let m=xe(ia([])),I=xe(!1),te=xe(!1),E=xe(!1);function k(){return parseFloat(getComputedStyle(document.body).fontSize)}function M(){return parseFloat(getComputedStyle(document.body).fontSize)/parseFloat(getComputedStyle(document.documentElement).fontSize)}function a(){const p=k()*2*.8;f(l,Math.min(document.documentElement.clientWidth-p,500)*M()),f(s,e(l),!0),f(u,.5*k()*M())}let d=Ct(t,"isRequestManualGrade",15),y=Ct(t,"autoReviewData",15),_=xe(0),v=(Ie=t.characterData)==null?void 0:Ie.meanings.join("; ");function D(p){for(const x of p)if(x.startsWith(dt))return Gt(x.substring(dt.length))}function b(){var p;f(te,!0),!e(E)&&(t.cardConfig.isFirstTime?(f(_,(e(_)+1)%t.characterData.characters.length),window.setTimeout(()=>{Y(e(_))},G)):(F.play(),f(_,e(_)+1),e(_)==((p=t.characterData)==null?void 0:p.characters.length)?(t.onComplete({...y()}),f(I,!0),window.setTimeout(()=>{P()},G)):window.setTimeout(()=>{Y(e(_))},G)))}let g;function Y(p){if(e(E)||!t.characterData)return;g&&(t.cardConfig.isFirstTime||g.cancelQuiz(),g.hideCharacter(),g.hideOutline());const x=D(t.characterData.tags[p]??[]);g=ga.create("grid-background-target",t.characterData.characters[p],{width:e(l),height:e(s),padding:5,showCharacter:!1,showOutline:t.cardConfig.isShowOutline,highlightOnComplete:!1,strokeColor:t.app.getChineseToneColor(x)??"#555",drawingWidth:pa,drawingColor:"#555",strokeAnimationSpeed:e(B),delayBetweenStrokes:kt(e(B),1,se,1e3,10),delayBetweenLoops:kt(e(B),1,se,2e3,10),onComplete:()=>{b()}}),t.cardConfig.isFirstTime?(setTimeout(()=>{e(te)||P()},G),setTimeout(()=>{g.animateCharacter({onComplete:()=>{setTimeout(()=>{g.hideOutline(),g.hideCharacter(),b()},G)}})},G)):(g.quiz({leniency:t.app.getConfig().strokeLeniency,onMistake:()=>{y(y().incorrectStrokeCount++,!0),y(y().totalStrokeCount++,!0)},onCorrectStroke:()=>{y(y().correctStrokeCount++,!0),y(y().totalStrokeCount++,!0)}}),y().isFailAndReveal&&g.showOutline())}function Z(){var x;const p=(x=t.characterData)==null?void 0:x.audioUrl;p&&f(m,p.map(me=>{const Ne=me.map(Pe=>ya(t.cardConfig.lang,Pe));return new Ea(Ne)}),!0)}function P(){if(e(E))return;const p=Math.floor(Math.random()*e(m).length),x=e(m)[p];x.stop(),x.play()}function Q(){if(t.cardConfig.isWarmUp&&(!t.cardConfig.isGradeWarmUpCards||!t.cardConfig.isFinalWarmUp)){window.alert("Can't change grade during warm-up, since grading doesn't affect scheduling in this phase.");return}d(!d())}function ne(p=0){const x=t.cardConfig.warmUpCount??0,me=t.cardConfig.warmUpMaxCount;return`${Math.round((x+p)/me*100)}%`}function U(){g&&(y(y().isFailAndReveal=!0,!0),g.showOutline())}const se=5;let B=xe(1);function Ze(){const p=e(B)%se+1;f(B,p),t.app.setStrokeSpeed(p)}Ut(()=>(y({correctStrokeCount:0,incorrectStrokeCount:0,totalStrokeCount:0,isFailAndReveal:!1}),a(),Z(),window.addEventListener("resize",a),f(B,t.app.getStrokeSpeed(),!0),Y(0),()=>{f(E,!0),window.removeEventListener("resize",a)}));var S=Qa(),_e=r(S),Qe=r(_e,!0);i(_e);var oe=c(_e,2);let Ve;var Xe=r(oe),$e=r(Xe,!0);i(Xe);var de=c(Xe,2);{var Me=p=>{var x=Ga();x.__click=[za,P],w(p,x)};N(de,p=>{e(m).length>0&&p(Me)})}i(oe);var ke=c(oe,2),Se=r(ke),Ye=r(Se),Ce=r(Ye);H(Ce,"stroke",z);var Te=c(Ce);H(Te,"stroke",z);var Ue=c(Te);H(Ue,"stroke",z);var We=c(Ue);H(We,"stroke",z),i(Ye),i(Se);var je=c(Se,2),tt=r(je);{var Ke=p=>{var x=Ha(),me=pe(x);{var Ne=C=>{var j=Fa();w(C,j)},Pe=(C,j)=>{{var ae=ge=>{var T=Ia();let V,$;re((ve,ie)=>{V=ye(T,1,"new-element-indicator svelte-xlnlhl",null,V,ve),$=st(T,"",$,ie)},[()=>({"is-complete":e(I)}),()=>({"--progress":ne(),"--next-progress":ne(1)})]),w(ge,T)},he=ge=>{var T=Na();w(ge,T)};N(C,ge=>{t.cardConfig.isWarmUp?ge(ae):ge(he,!1)},j)}};N(me,C=>{t.cardConfig.isFirstTime?C(Ne):C(Pe,!1)})}var Le=c(me,2),o=r(Le);o.__click=[Pa,t];var R=c(o,2);ft(R,21,()=>t.characterData.characters,_t,(C,j,ae)=>{var he=Je(),ge=pe(he);{var T=$=>{var ve=La(),ie=r(ve,!0);i(ve),re(()=>q(ie,e(j))),w($,ve)},V=$=>{var ve=Oa();w($,ve)};N(ge,$=>{ae<e(_)||t.cardConfig.isFirstTime?$(T):$(V,!1)})}w(C,he)}),i(R),i(Le),w(p,x)};N(tt,p=>{var x;(x=t.characterData)!=null&&x.characters&&p(Ke)})}i(je);var we=c(je,2);{var Re=p=>{var x=Za();x.__click=[Ma,Ze];var me=r(x);{var Ne=R=>{var C=Ya();w(R,C)},Pe=R=>{var C=Ba();w(R,C)};N(me,R=>{e(B)<=1?R(Ne):R(Pe,!1)})}var Le=c(me,2),o=r(Le);i(Le),i(x),re(()=>q(o,`${e(B)??""}x`)),w(p,x)};N(we,p=>{t.cardConfig.isFirstTime&&p(Re)})}var Fe=c(we,2);{var Be=p=>{var x=Ja();let me;x.__click=[Xa,Q];var Ne=r(x);{var Pe=o=>{var R=ja();qt(2),w(o,R)},Le=o=>{var R=Ka(),C=pe(R),j=c(C,2),ae=r(j,!0);i(j),re(()=>{ye(C,1,ha(qa[t.autoGrade]),"svelte-xlnlhl"),q(ae,Ua[t.autoGrade])}),w(o,R)};N(Ne,o=>{t.cardConfig.isWarmUp&&!t.cardConfig.isGradeWarmUpCards?o(Pe):o(Le,!1)})}i(x),re(o=>me=ye(x,1,`auto-review-indicator-container ${Wa[t.autoGrade]}`,"svelte-xlnlhl",me,o),[()=>({blinking:d(),animated:d(),"echo-once":!d()})]),w(p,x)};N(Fe,p=>{t.autoGrade&&p(Be)})}return i(ke),i(S),re(p=>{var x;q(Qe,v),Ve=ye(oe,1,"reading-container svelte-xlnlhl",null,Ve,p),q($e,(x=t.characterData)==null?void 0:x.reading),H(Ye,"width",e(l)),H(Ye,"height",e(s)),H(Ce,"x1",e(h)),H(Ce,"y1",e(h)),H(Ce,"x2",e(l)-e(h)),H(Ce,"y2",e(s)-e(h)),H(Te,"x1",e(l)-e(h)),H(Te,"y1",e(h)),H(Te,"x2",e(h)),H(Te,"y2",e(s)-e(h)),H(Ue,"x1",e(l)/2),H(Ue,"y1",e(h)),H(Ue,"x2",e(l)/2),H(Ue,"y2",e(s)-e(h)),H(We,"x1",e(h)),H(We,"y1",e(s)/2),H(We,"x2",e(l)-e(h)),H(We,"y2",e(s)/2)},[()=>({"is-hidden":!t.app.getConfig().zh.alwaysShowReading&&!e(I)&&!t.cardConfig.isFirstTime})]),w(n,S),ut({failAndReveal:U})}bt(["click"]);const $a=n=>n;function ei(n){const t=n-1;return t*t*t+1}function Rt(n){const t=typeof n=="string"&&n.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[n,"px"]}function ti(n,{delay:t=0,duration:l=400,easing:s=$a}={}){const u=+getComputedStyle(n).opacity;return{delay:t,duration:l,easing:s,css:h=>`opacity: ${h*u}`}}function ai(n,{delay:t=0,duration:l=400,easing:s=ei,x:u=0,y:h=0,opacity:z=0}={}){const G=getComputedStyle(n),F=+G.opacity,m=G.transform==="none"?"":G.transform,I=F*(1-z),[te,E]=Rt(u),[k,M]=Rt(h);return{delay:t,duration:l,easing:s,css:(a,d)=>`
			transform: ${m} translate(${(1-a)*te}${E}, ${(1-a)*k}${M});
			opacity: ${F-I*d}`}}function ii(n){const t=n-1;return t*t*t+1}const At=(n,t=Ge,l=Ge)=>{var s=Je(),u=pe(s);ft(u,17,t,_t,(h,z,G)=>{var F=ni(),m=r(F,!0);i(F),re(()=>{st(F,`color: ${l()[G]??""}`),q(m,e(z))}),w(h,F)}),w(n,s)};var ri=A('<div class="simple-decomp svelte-1yiia6q"><span class="simple-char chinese-font svelte-1yiia6q"> </span> <span class="simple-pinyin svelte-1yiia6q"> </span> <span class="simple-sep svelte-1yiia6q">&mdash;</span> <span class="simple-def"> </span></div>'),ni=A("<span> </span>"),si=A('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Simplified</div> <div class="value chinese-font svelte-1yiia6q"><!></div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Traditional</div> <div class="value chinese-font svelte-1yiia6q"><!></div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Definition</div> <div class="value"> </div></div> <div class="sep svelte-1yiia6q"></div> <div style="margin-bottom: 0.5em"><b>Components</b> :</div>',1),li=A('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Semantic</div> <div class="value"><!></div></div>'),oi=A('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Phonetic</div> <div class="value"><!></div></div>'),di=A('<div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Etymology</div> <div class="value"> </div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Hint</div> <div class="value"> </div></div> <!> <!>',1),vi=A('<div class="char-decomp svelte-1yiia6q"><div class="char-container svelte-1yiia6q"><div class="char chinese-font svelte-1yiia6q"> </div> <div class="char-pinyin"> </div></div> <div class="char-info"><div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Simplified</div> <div class="value chinese-font colored svelte-1yiia6q"> </div></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Traditional</div> <div class="value chinese-font colored svelte-1yiia6q"> </div></div> <div class="sep svelte-1yiia6q"></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Definition</div> <div class="value"> </div></div> <div class="sep svelte-1yiia6q"></div> <div class="row svelte-1yiia6q"><div class="label svelte-1yiia6q">Radical</div> <div class="value"><!></div></div> <div class="sep svelte-1yiia6q"></div> <!></div></div>'),ci=A('<div class="dict-container"><!> <!></div>');function ui(n,t){var k,M;ct(t,!0);const l=(a,d=Ge)=>{var y=Je(),_=pe(y);{var v=D=>{var b=ri(),g=r(b),Y=r(g,!0);i(g);var Z=c(g,2),P=r(Z,!0);i(Z);var Q=c(Z,4),ne=r(Q,!0);i(Q),i(b),re((U,se)=>{st(b,`--tone-color: ${U??""}`),q(Y,d().character),q(P,se),q(ne,d().definition??"")},[()=>{var U;return t.toneColors[t.wordlist.toneFromPinyin(((U=d().pinyin)==null?void 0:U[0])??"")-1]},()=>{var U;return G(((U=d().pinyin)==null?void 0:U[0])??"",t.zhReading)}]),w(D,b)};N(_,D=>{d()&&D(v)})}w(a,y)};let s=((k=t.characterData)==null?void 0:k.characters)??"",u=((M=t.characterData)==null?void 0:M.tags.map(a=>F(a)??5).map(a=>t.toneColors[a-1]))??[],h=Wt(()=>t.wordlist.getWordDecompData(s)),z=s.length>1;function G(a,d){return d===Ca.Zhuyin?wa.pinyinToZhuyin(a):a}function F(a){for(const d of a)if(d.startsWith(dt))return Gt(d.substring(dt.length))}var m=ci(),I=r(m);{var te=a=>{var d=si(),y=pe(d),_=c(r(y),2),v=r(_),D=J(()=>t.wordlist.toSimplified(s));At(v,()=>e(D),()=>u),i(_),i(y);var b=c(y,2),g=c(r(b),2),Y=r(g),Z=J(()=>t.wordlist.toTraditional(s));At(Y,()=>e(Z),()=>u),i(g),i(b);var P=c(b,2),Q=c(r(P),2),ne=r(Q,!0);i(Q),i(P),qt(4),re(()=>{var U;return q(ne,((U=t.characterData)==null?void 0:U.meanings[0])??"")}),w(a,d)};N(I,a=>{z&&a(te)})}var E=c(I,2);ft(E,17,()=>e(h),_t,(a,d)=>{var y=vi(),_=r(y),v=r(_),D=r(v,!0);i(v);var b=c(v,2),g=r(b,!0);i(b),i(_);var Y=c(_,2),Z=r(Y),P=c(r(Z),2),Q=r(P,!0);i(P),i(Z);var ne=c(Z,2),U=c(r(ne),2),se=r(U,!0);i(U),i(ne);var B=c(ne,4),Ze=c(r(B),2),S=r(Ze,!0);i(Ze),i(B);var _e=c(B,4),Qe=c(r(_e),2),oe=r(Qe),Ve=J(()=>t.wordlist.getCharDecompData(e(d).radical));l(oe,()=>e(Ve)),i(Qe),i(_e);var Xe=c(_e,4);{var $e=de=>{var Me=di(),ke=pe(Me),Se=c(r(ke),2),Ye=r(Se,!0);i(Se),i(ke);var Ce=c(ke,2),Te=c(r(Ce),2),Ue=r(Te,!0);i(Te),i(Ce);var We=c(Ce,2);{var je=we=>{var Re=li(),Fe=c(r(Re),2),Be=r(Fe),Ie=J(()=>t.wordlist.getCharDecompData(e(d).etymology.semantic));l(Be,()=>e(Ie)),i(Fe),i(Re),w(we,Re)};N(We,we=>{e(d).etymology.semantic&&we(je)})}var tt=c(We,2);{var Ke=we=>{var Re=oi(),Fe=c(r(Re),2),Be=r(Fe),Ie=J(()=>t.wordlist.getCharDecompData(e(d).etymology.phonetic));l(Be,()=>e(Ie)),i(Fe),i(Re),w(we,Re)};N(tt,we=>{e(d).etymology.phonetic&&we(Ke)})}re(()=>{q(Ye,e(d).etymology.type),q(Ue,e(d).etymology.hint)}),w(de,Me)};N(Xe,de=>{e(d).etymology&&de($e)})}i(Y),i(y),re((de,Me,ke,Se)=>{st(y,`--tone-color: ${de??""}`),q(D,e(d).character),q(g,Me),q(Q,ke),q(se,Se),q(S,e(d).definition??"")},[()=>{var de;return t.toneColors[t.wordlist.toneFromPinyin(((de=e(d).pinyin)==null?void 0:de[0])??"")-1]},()=>{var de;return G(((de=e(d).pinyin)==null?void 0:de[0])??"",t.zhReading)},()=>t.wordlist.toSimplified(e(d).character),()=>t.wordlist.toTraditional(e(d).character)]),w(a,y)}),i(m),w(n,m),ut()}var fi=(n,t)=>t.onClose(),_i=A('<div class="modal-backdrop svelte-7blv8t"><div><button class="modal-close svelte-7blv8t" aria-label="Close"><i class="fa-solid fa-xmark"></i></button> <div class="modal-panel svelte-7blv8t"><div class="modal-drag-handle svelte-7blv8t"></div> <div class="modal-container svelte-7blv8t"><!></div></div></div></div>');function mi(n,t){ct(t,!0);let l=0,s=xe(0),u=xe(!1),h=xe(null);const z=100;let G=!1;function F(v){var D;f(u,!1),l=v.touches[0].clientY,G=(((D=e(h))==null?void 0:D.scrollTop)??0)===0}function m(v){const b=v.touches[0].clientY-l;!e(u)&&G&&b>0&&f(u,!0),e(u)&&(v.cancelable&&v.preventDefault(),f(s,Math.max(0,b),!0))}function I(){e(u)&&e(s)>z&&t.onClose(),f(u,!1),f(s,0)}let te=0;function E(v){const D=document.documentElement,b=document.body;v?(D.classList.add("no-ptr"),b.classList.add("no-ptr")):(D.classList.remove("no-ptr"),b.classList.remove("no-ptr"))}function k(){te=window.scrollY;const v=document.body;v.style.position="fixed",v.style.top=`-${te}px`,v.style.left="0",v.style.right="0",v.style.width="100%",E(!0)}function M(){const v=document.body;v.style.position="",v.style.top="",v.style.left="",v.style.right="",v.style.width="",E(!1),window.scrollTo(0,te)}ra(()=>{typeof window>"u"||(t.isOpen?k():M())}),na(()=>{M()});function a(v){const D=b=>m(b);return v.addEventListener("touchmove",D,{passive:!1}),{destroy(){v.removeEventListener("touchmove",D)}}}var d=Je(),y=pe(d);{var _=v=>{var D=_i(),b=r(D);let g;b.__touchstart=F,b.__touchend=I;let Y;var Z=r(b);Z.__click=[fi,t];var P=c(Z,2),Q=c(r(P),2),ne=r(Q);sa(ne,()=>t.children??Ge),i(Q),zt(Q,U=>f(h,U),()=>e(h)),i(P),i(b),ka(b,U=>a==null?void 0:a(U)),i(D),re((U,se)=>{g=ye(b,1,"modal-wrapper svelte-7blv8t",null,g,U),Y=st(b,"",Y,se)},[()=>({"is-dragging":e(u)}),()=>({transform:`translateY(${e(s)??""}px)`})]),la("touchcancel",b,I),w(v,D)};N(y,v=>{t.isOpen&&v(_)})}w(n,d),ut()}bt(["touchstart","touchend","click"]);var hi=A('<button><div class="review-button-inner svelte-2pz8ii"><div class="review-time svelte-2pz8ii"> </div> <div class="review-label svelte-2pz8ii"> </div></div></button>'),gi=A('<button><div class="review-button-inner svelte-2pz8ii"><div class="review-time svelte-2pz8ii"> </div> <div class="review-label svelte-2pz8ii"> </div></div></button>'),pi=A('<div class="bottom-container svelte-2pz8ii"><div></div></div>'),yi=()=>xa.goHomeAndClearHistory(),Ci=A(`<div style="margin-top: 2em" class="svelte-2pz8ii">You have done today's review.</div> <div class="bottom-container svelte-2pz8ii"><div class="review-button-container svelte-2pz8ii"><button class="button big-button svelte-2pz8ii">Go Back</button></div></div>`,1),wi=A('<div class="counter svelte-2pz8ii"><span class="underlined svelte-2pz8ii"><!></span></div>'),bi=A('<div class="counter svelte-2pz8ii"><span> </span> <span> </span> <span> </span> <span> </span> <span> </span></div>'),xi=A('<!> <div class="character-writer-container svelte-2pz8ii"><!></div> <!>',1),ki=A('<!> <div class="container svelte-2pz8ii"><!> <!></div> <!>',1);function Bi(n,t){ct(t,!1);const l=X(),s=X(),u=X(),h=(o,R=Ge,C)=>{let j=J(()=>ca(C==null?void 0:C(),""));var ae=pi(),he=r(ae);ft(he,5,R,_t,(ge,T)=>{var V=Je(),$=pe(V);{var ve=ce=>{var O=hi();let ee;O.__click=function(...le){var be;(be=e(T).alternate.onclick)==null||be.apply(this,le)};var ue=r(O),K=r(ue),Ae=r(K,!0);i(K);var fe=c(K,2),qe=r(fe,!0);i(fe),i(ue),i(O),re(le=>{ee=ye(O,1,(e(T),W(()=>`review-button ${e(T).alternate.className||e(T).className||""}`)),"svelte-2pz8ii",ee,le),q(Ae,(e(T),W(()=>e(T).alternate.sublabel||e(T).sublabel||" "))),q(qe,(e(T),W(()=>e(T).alternate.label||e(T).label||" ")))},[()=>({"is-complete":!e(T).isComplete})],J),w(ce,O)},ie=ce=>{var O=gi();let ee;O.__click=function(...le){var be;(be=e(T).onclick)==null||be.apply(this,le)};var ue=r(O),K=r(ue),Ae=r(K,!0);i(K);var fe=c(K,2),qe=r(fe,!0);i(fe),i(ue),i(O),re(le=>{ee=ye(O,1,(e(T),W(()=>`review-button ${e(T).className||""}`)),"svelte-2pz8ii",ee,le),q(Ae,(e(T),W(()=>e(T).sublabel||" "))),q(qe,(e(T),W(()=>e(T).label||" ")))},[()=>({"is-complete":e(T).isComplete})],J),w(ce,O)};N($,ce=>{e(T),W(()=>e(T).alternate&&!e(T).isComplete&&e(T).alternate.isComplete)?ce(ve):ce(ie,!1)})}w(ge,V)}),i(he),i(ae),re(()=>ye(he,1,`review-button-container ${e(j)}`,"svelte-2pz8ii")),Tt(1,ae,()=>ai,()=>z),Tt(2,ae,()=>ti,()=>G),w(o,ae)},z={delay:100,y:-100,duration:300,easing:ii},G={duration:200};let F=Ct(t,"data",8),m=F().deckId||"",I=F().cardIds||encodeURIComponent("[]"),te=JSON.parse(decodeURIComponent(I)),E=F().isExtraStudy?"Extra Study":"Review",k=X(),M=X(!1),a=X(new _a),d=X(),y=X(!1);Ut(async()=>{var C;await e(a).init();const o=(C=e(a).deckData[m])==null?void 0:C.tags;P=o==null?void 0:o.includes(yt.ZH_YUE);const R=o==null?void 0:o.includes(yt.ZH_EXTRA_DICT);await b.init(P?"yue":"zh",R),f(a,e(a)),Z=o==null?void 0:o.includes(yt.ZH_TRAD),f(Q,e(a).isAutoGrading()),f(ne,e(a).getConfig().gradeWarmUpCards),f(M,!0),F().isExtraStudy&&e(a).extraStudyHandler.registerReviewCardIdsOverride(te),oe()});let _=X(!1),v=X(!1),D=X(!1),b=new ba,g=X(void 0),Y=X(!1),Z=!1,P=!1,Q=X(!1),ne=X(!1),U=X(void 0),se=X(!1),B=X(0);const Ze=["Fail","Hard","Good","Easy"];let S=X(void 0),_e=X({1:"",2:"",3:"",4:""});function Qe(){f(_,!1),f(Y,!1),f(U,void 0),f(se,!1)}function oe(){Qe(),f(D,!0);const o=e(a).getNextCard(m);if(o===void 0){f(v,!0);return}e(a).getCard(m,o,!0)&&(f(D,!1),f(S,o),f(_e,e(a).getRatingScheduledTimeStr(m,o)),f(g,e(a).getWenbunCustomState(m,o)),da(B))}async function Ve(){e(a).startWarmUp(m,e(S)),await e(a).save(),f(Y,!0),f(S,e(S)),f(_e,e(a).getRatingScheduledTimeStr(m,e(S))),f(g,e(a).getWenbunCustomState(m,e(S)))}async function Xe(){e(a).skipWarmUp(m,e(S)),f(Y,!0),await e(a).save(),oe()}function $e(o){const R=e(a).getCardWord(m,o),C=e(a).getConfig();return b.getCharacterWriterData(R,{convertToTraditional:Z,mandarinReading:C.zh.mandarinReading,isCantonese:P,isPlayAudio:C.zh.playAudio})}function de(o){const R=e(a).getWarmUpCount(m,o),C=e(s)&&R===0;return{isFirstTime:e(l),isWarmUp:e(s),isFinalWarmUp:Ke(o),warmUpCount:R,warmUpMaxCount:e(a).getMaxWarmUpCount(),isGradeWarmUpCards:e(a).getConfig().gradeWarmUpCards,isShowOutline:e(l)||C,lang:P?"yue":"zh"}}function Me(o){f(_,!0),e(Q)&&f(U,vt.getGrade(o))}async function ke(o){e(a).rateCard(m,e(S),o),await e(a).save(),oe()}function Se(o){switch(o){case L.Easy:return"review-button-easy";case L.Good:return"review-button-good";case L.Hard:return"review-button-hard";case L.Again:return"review-button-fail"}}async function Ye(){e(a).addIgnoredMark(m,e(S)),await e(a).save(),oe()}function Ce(){e(a).extraStudyHandler.rateAgain(e(S)),oe()}function Te(){e(a).extraStudyHandler.rateGood(e(S)),oe()}async function Ue(){e(a).storeAutoGradeLog(e(k).correctStrokeCount,e(k).incorrectStrokeCount,e(U)),e(a).rateCard(m,e(S),e(U)),await e(a).save(),oe()}function We(o){f(U,o),f(se,!1)}async function je(){e(a).warmUpNext(m,e(S)),await e(a).save(),oe()}async function tt(){await ke(L.Again)}function Ke(o,R){const C=e(a).getWarmUpCount(m,o);return C===void 0?!0:C>=e(a).getMaxWarmUpCount()}function we(o,R){return e(a).getWarmUpCount(m,o)===0}function Re(){e(d)&&(e(d).failAndReveal(),f(U,vt.getGrade(e(k))))}function Fe(){f(y,!0)}gt(()=>(e(g),Ee),()=>{f(l,e(g)===Ee.New)}),gt(()=>(e(g),Ee),()=>{f(s,e(g)===Ee.WarmUp)}),gt(()=>e(k),()=>{var o;f(u,{label:"Reveal",sublabel:"(Fail)",className:"review-button-fail",onclick:()=>Re(),isComplete:!((o=e(k))!=null&&o.isFailAndReveal)})}),oa(),ua();var Be=ki(),Ie=pe(Be);ma(Ie,{get title(){return E}});var p=c(Ie,2),x=r(p);{var me=o=>{var R=Ci(),C=c(pe(R),2),j=r(C),ae=r(j);ae.__click=[yi],i(j),i(C),w(o,R)};N(x,o=>{e(v)&&o(me)})}var Ne=c(x,2);{var Pe=o=>{var R=xi(),C=pe(R);pt(C,()=>e(B),V=>{var $=Je(),ve=pe($);{var ie=O=>{var ee=wi(),ue=r(ee),K=r(ue);pt(K,()=>e(S),Ae=>{var fe=va();re(qe=>q(fe,qe),[()=>(e(a),W(()=>e(a).extraStudyHandler.getCardsCount()||""))],J),w(Ae,fe)}),i(ue),i(ee),w(O,ee)},ce=O=>{var ee=bi(),ue=r(ee);let K;var Ae=r(ue,!0);i(ue);var fe=c(ue,2);let qe;var le=r(fe,!0);i(fe);var be=c(fe,2);let lt;var mt=r(be,!0);i(be);var De=c(be,2);let et;var ht=r(De,!0);i(De);var at=c(De,2);let Oe;var it=r(at,!0);i(at),i(ee),re((rt,ze,It,Nt,Pt,Lt,Ot,Ht,Mt,Yt)=>{K=ye(ue,1,"deck-count-learn-relearn svelte-2pz8ii",null,K,rt),q(Ae,ze),qe=ye(fe,1,"deck-count-review svelte-2pz8ii",null,qe,It),q(le,Nt),lt=ye(be,1,"deck-count-new svelte-2pz8ii",null,lt,Pt),q(mt,Lt),et=ye(De,1,"deck-count-new svelte-2pz8ii",null,et,Ot),q(ht,Ht),Oe=ye(at,1,"deck-count-previously-studied svelte-2pz8ii",null,Oe,Mt),q(it,Yt)},[()=>({underlined:e(g)===Ee.Learning||e(g)===Ee.Relearning}),()=>(e(a),W(()=>e(a).getLearningRelearningCardsCount(m)||"")),()=>({underlined:e(g)===Ee.ReviewYoung||e(g)===Ee.ReviewMature}),()=>(e(a),W(()=>e(a).getScheduledReviewCardsCount(m)||"")),()=>({underlined:e(g)===Ee.New}),()=>(e(a),W(()=>e(a).getScheduledNewCardsCount(m)||"")),()=>({underlined:e(g)===Ee.WarmUp}),()=>(e(a),W(()=>e(a).getWarmUpCardsCount(m)?`(${e(a).getWarmUpCardsCount(m)})`:"")),()=>({underlined:e(g)===Ee.PreviouslyStudied}),()=>(e(a),W(()=>e(a).getScheduledPreviouslyStudiedCardsCount(m)||""))],J),w(O,ee)};N(ve,O=>{xt(F()),W(()=>F().isExtraStudy)?O(ie):O(ce,!1)})}w(V,$)});var j=c(C,2),ae=r(j);pt(ae,()=>[e(S),e(Y),e(D)],V=>{const $=J(()=>(e(S),W(()=>$e(e(S))))),ve=J(()=>(e(S),W(()=>de(e(S)))));zt(Va(V,{get app(){return e(a)},get characterData(){return e($)},onComplete:ie=>Me(ie),onOpenDict:()=>Fe(),get cardConfig(){return e(ve)},get autoGrade(){return e(U)},get isRequestManualGrade(){return e(se)},set isRequestManualGrade(ie){f(se,ie)},get autoReviewData(){return e(k)},set autoReviewData(ie){f(k,ie)},$$legacy:!0}),ie=>f(d,ie),()=>e(d))}),i(j);var he=c(j,2);{var ge=V=>{h(V,()=>[{label:"Ignore",sublabel:"(Don't Learn)",className:"review-button-fail",isComplete:!0,onclick:()=>Ye()},{label:"Learn*",sublabel:"(Skip Warm-Up)",className:"review-button-hard",isComplete:!0,onclick:()=>Xe()},{label:""},{label:"Learn",className:"review-button-easy main-button",isComplete:!0,onclick:()=>Ve()}])},T=(V,$)=>{{var ve=ce=>{var O=J(()=>(e(u),e(k),e(S),e(B),e(_),W(()=>{var ee;return[{label:"",alternate:{...e(u),isComplete:!((ee=e(k))!=null&&ee.isFailAndReveal)&&!we(e(S),e(B))}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(_),onclick:()=>je()}]})));h(ce,()=>e(O))},ie=(ce,O)=>{{var ee=K=>{var Ae=J(()=>(e(u),e(_),W(()=>[{label:"",alternate:{...e(u),isComplete:!e(_)}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(_),onclick:()=>tt()}])));h(K,()=>e(Ae))},ue=(K,Ae)=>{{var fe=le=>{h(le,()=>[{label:"Again",sublabel:"(Put Back)",className:"review-button-fail",isComplete:e(_),onclick:()=>Ce(),alternate:e(u)},{label:""},{label:""},{label:"Good",className:"review-button-easy",isComplete:e(_),onclick:()=>Te()}])},qe=(le,be)=>{{var lt=De=>{var et=J(()=>(e(u),e(_),W(()=>[{label:"",alternate:{...e(u),isComplete:!e(_)}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(_),onclick:()=>Ue()}])));h(De,()=>e(et))},mt=(De,et)=>{{var ht=Oe=>{var it=J(()=>(e(_e),e(_),W(()=>Ze.map((rt,ze)=>({label:rt,sublabel:e(_e)[ze+1],className:Se(ze+1)+" time",isComplete:e(_),onclick:()=>We(ze+1)})))));h(Oe,()=>e(it),()=>"pulsing")},at=Oe=>{var it=J(()=>(e(_e),e(_),e(u),W(()=>Ze.map((rt,ze)=>({label:rt,sublabel:e(_e)[ze+1],className:Se(ze+1)+" time",isComplete:e(_),alternate:ze==0?e(u):void 0,onclick:()=>ke(ze+1)})))));h(Oe,()=>e(it))};N(De,Oe=>{e(Q)&&e(se)?Oe(ht):Oe(at,!1)},et)}};N(le,De=>{e(Q)&&!e(se)?De(lt):De(mt,!1)},be)}};N(K,le=>{xt(F()),W(()=>F().isExtraStudy)?le(fe):le(qe,!1)},Ae)}};N(ce,K=>{e(s),e(S),e(B),e(ne),W(()=>e(s)&&Ke(e(S),e(B))&&!e(ne))?K(ee):K(ue,!1)},O)}};N(V,ce=>{e(s),e(S),e(B),W(()=>e(s)&&!Ke(e(S),e(B)))?ce(ve):ce(ie,!1)},$)}};N(he,V=>{e(l)?V(ge):V(T,!1)})}w(o,R)};N(Ne,o=>{e(M)&&e(S)!==void 0&&!e(v)&&o(Pe)})}i(p);var Le=c(p,2);mi(Le,{onClose:()=>f(y,!1),get isOpen(){return e(y)},set isOpen(o){f(y,o)},children:(o,R)=>{var C=Je(),j=pe(C);{var ae=he=>{const ge=J(()=>(e(S),W(()=>$e(e(S))))),T=J(()=>(e(a),W(()=>e(a).getChineseToneColorArray())));ui(he,{get characterData(){return e(ge)},get wordlist(){return b},get toneColors(){return e(T)},get zhReading(){return e(a),W(()=>e(a).getConfig().zh.mandarinReading)}})};N(j,he=>{e(S)!==void 0&&he(ae)})}w(o,C)},$$slots:{default:!0},$$legacy:!0}),w(n,Be),ut()}bt(["click"]);export{Bi as component,Yi as universal};
