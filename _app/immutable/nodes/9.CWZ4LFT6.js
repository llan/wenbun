var Na=Object.defineProperty;var Da=(r,a,i)=>a in r?Na(r,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[a]=i;var Xe=(r,a,i)=>Da(r,typeof a!="symbol"?a+"":a,i);import"../chunks/CWj6FrbW.js";import"../chunks/e1-x02pv.js";import{T as Pa,aU as Ma,X as Oa,aV as La,aW as Ha,l as za,n as S,aX as qa,aY as Ba,aZ as ja,a_ as Xa,q as Za,w as Ie,a3 as pa,p as wa,g as be,ae as Ya,a5 as ya,j as o,f as G,d as _,r as g,s as E,i as e,t as fe,e as $,aT as Ka,b as w,c as ba,a as We,aF as da,ab as Ja,a4 as H,a6 as oa,a7 as Qa,aM as Va,O as fa,aa as $a,a8 as ie,a$ as et}from"../chunks/B3vXJgDE.js";import{i as z}from"../chunks/BMd2rG11.js";import{k as la}from"../chunks/u-7-ff8R.js";import{e as ka,i as Sa,c as at}from"../chunks/Cf-085yO.js";import{s as se}from"../chunks/BgSIpHGp.js";import{w as xa}from"../chunks/Yc3UY6S9.js";import{b as tt}from"../chunks/DIAS94Ab.js";import{i as rt}from"../chunks/DRVz_ard.js";import{p as ua}from"../chunks/DfwZoAIM.js";import{b as nt}from"../chunks/D9EQzb-w.js";import{l as A,A as it,W as ve}from"../chunks/DgyyUUPH.js";import{s as W,T as st}from"../chunks/-bR0FToJ.js";import{s as ot}from"../chunks/BW2CcSmq.js";import{H as lt}from"../chunks/DcL13wi7.js";import{i as ma,b as ct,j as dt,T as ga,p as ut,c as ca,C as vt}from"../chunks/NeAu8v0G.js";const ft=()=>performance.now(),ke={tick:r=>requestAnimationFrame(r),now:()=>ft(),tasks:new Set};function Aa(){const r=ke.now();ke.tasks.forEach(a=>{a.c(r)||(ke.tasks.delete(a),a.f())}),ke.tasks.size!==0&&ke.tick(Aa)}function mt(r){let a;return ke.tasks.size===0&&ke.tick(Aa),{promise:new Promise(i=>{ke.tasks.add(a={c:r,f:i})}),abort(){ke.tasks.delete(a)}}}function ea(r,a){xa(()=>{r.dispatchEvent(new CustomEvent(a))})}function gt(r){if(r==="float")return"cssFloat";if(r==="offset")return"cssOffset";if(r.startsWith("--"))return r;const a=r.split("-");return a.length===1?a[0]:a[0]+a.slice(1).map(i=>i[0].toUpperCase()+i.slice(1)).join("")}function _a(r){const a={},i=r.split(";");for(const s of i){const[u,m]=s.split(":");if(!u||m===void 0)break;const D=gt(u.trim());a[D]=m.trim()}return a}const _t=r=>r;function ha(r,a,i,s){var u=(r&Ba)!==0,m=(r&ja)!==0,D=u&&m,q=(r&qa)!==0,X=D?"both":u?"in":"out",l,P=a.inert,oe=a.style.overflow,R,h;function J(){return xa(()=>l??(l=i()(a,(s==null?void 0:s())??{},{direction:X})))}var t={is_global:q,in(){var B;if(a.inert=P,!u){h==null||h.abort(),(B=h==null?void 0:h.reset)==null||B.call(h);return}m||R==null||R.abort(),ea(a,"introstart"),R=va(a,J(),h,1,()=>{ea(a,"introend"),R==null||R.abort(),R=l=void 0,a.style.overflow=oe})},out(B){if(!m){B==null||B(),l=void 0;return}a.inert=!0,ea(a,"outrostart"),h=va(a,J(),R,0,()=>{ea(a,"outroend"),B==null||B()})},stop:()=>{R==null||R.abort(),h==null||h.abort()}},T=Pa;if((T.transitions??(T.transitions=[])).push(t),u&&Ma){var d=q;if(!d){for(var y=T.parent;y&&(y.f&Oa)!==0;)for(;(y=y.parent)&&(y.f&La)===0;);d=!y||(y.f&Ha)!==0}d&&za(()=>{S(()=>t.in())})}}function va(r,a,i,s,u){var m=s===1;if(Xa(a)){var D,q=!1;return Za(()=>{if(!q){var T=a({direction:m?"in":"out"});D=va(r,T,i,s,u)}}),{abort:()=>{q=!0,D==null||D.abort()},deactivate:()=>D.deactivate(),reset:()=>D.reset(),t:()=>D.t()}}if(i==null||i.deactivate(),!(a!=null&&a.duration))return u(),{abort:Ie,deactivate:Ie,reset:Ie,t:()=>s};const{delay:X=0,css:l,tick:P,easing:oe=_t}=a;var R=[];if(m&&i===void 0&&(P&&P(0,1),l)){var h=_a(l(0,1));R.push(h,h)}var J=()=>1-s,t=r.animate(R,{duration:X,fill:"forwards"});return t.onfinish=()=>{t.cancel();var T=(i==null?void 0:i.t())??1-s;i==null||i.abort();var d=s-T,y=a.duration*Math.abs(d),B=[];if(y>0){var Te=!1;if(l)for(var M=Math.ceil(y/16.666666666666668),F=0;F<=M;F+=1){var pe=T+d*oe(F/M),we=_a(l(pe,1-pe));B.push(we),Te||(Te=we.overflow==="hidden")}Te&&(r.style.overflow="hidden"),J=()=>{var ae=t.currentTime;return T+d*oe(ae/y)},P&&mt(()=>{if(t.playState!=="running")return!1;var ae=J();return P(ae,1-ae),!0})}t=r.animate(B,{duration:y,fill:"forwards"}),t.onfinish=()=>{J=()=>s,P==null||P(s,1-s),u()}},{abort:()=>{t&&(t.cancel(),t.effect=null,t.onfinish=Ie)},deactivate:()=>{u=Ie},reset:()=>{s===0&&(P==null||P(1,0))},t:()=>J()}}const ht=({url:r})=>({deckId:r.searchParams.get("id")||"",isExtraStudy:r.searchParams.get("isExtraStudy")==="true",cardIds:r.searchParams.get("cardIds")||encodeURIComponent("[]")}),hr=Object.freeze(Object.defineProperty({__proto__:null,load:ht},Symbol.toStringTag,{value:"Module"}));class Ct{constructor(a,i=!0){Xe(this,"audios");Xe(this,"currentIndex",0);Xe(this,"isPlaying",!1);Xe(this,"onEnded",this.handleEnded.bind(this));this.audios=a.map(s=>{const u=new Audio(s);return u.preload="auto",i&&u.load(),u})}handleEnded(){this.audios[this.currentIndex].removeEventListener("ended",this.onEnded),this.currentIndex++,this.currentIndex<this.audios.length?this.playCurrent():(this.isPlaying=!1,this.currentIndex=0)}playCurrent(){const a=this.audios[this.currentIndex];a.addEventListener("ended",this.onEnded),a.currentTime=0,a.play().catch(i=>{console.warn("Playback failed:",i),this.stop()})}play(){this.audios.length!==0&&(this.isPlaying&&this.stop(),this.isPlaying=!0,this.currentIndex=0,this.playCurrent())}stop(){if(!this.isPlaying)return;this.isPlaying=!1;const a=this.audios[this.currentIndex];a.pause(),a.currentTime=0,a.removeEventListener("ended",this.onEnded),this.currentIndex=0}}const pt={[A.Again]:"Fail",[A.Hard]:"Hard",[A.Good]:"Good",[A.Easy]:"Easy"},wt={[A.Again]:"again",[A.Hard]:"hard",[A.Good]:"good",[A.Easy]:"easy"},yt={[A.Again]:"fa fa-solid fa-face-frown",[A.Hard]:"fa fa-solid fa-face-meh",[A.Good]:"fa fa-solid fa-face-smile",[A.Easy]:"fa fa-solid fa-star"};var aa;(r=>{function a(s){if(s.isFailAndReveal)return A.Again;const u=s.correctStrokeCount===0?1/0:s.incorrectStrokeCount/s.correctStrokeCount;return u<.25||s.incorrectStrokeCount<=2?A.Good:u<.75||s.incorrectStrokeCount<=4?A.Hard:A.Again}r.getGrade=a;function i(s){switch(s){case A.Again:return"Again";case A.Hard:return"Hard";case A.Good:return"Good";default:return"Unknown"}}r.gradeToLabel=i})(aa||(aa={}));var bt=(r,a)=>a(),kt=G('<button class="audio-button svelte-rncg3f" aria-label="Play Audio"><i class="fa-solid fa-volume-low svelte-rncg3f"></i></button>'),St=G('<div class="new-element-indicator svelte-rncg3f">New Card</div>'),xt=G("<div>Warm Up</div>"),At=G('<div class="new-element-indicator is-hidden svelte-rncg3f"></div>'),Rt=G('<span class="svelte-rncg3f"> </span>'),Tt=G('<span class="empty-character-box svelte-rncg3f">&#x3000;</span>'),Ut=G('<!> <div class="character-box-container chinese-font svelte-rncg3f"></div>',1),Wt=(r,a)=>a(),Et=G('<i class="fa-solid fa-play svelte-rncg3f"></i>'),Gt=G('<i class="fa-solid fa-forward svelte-rncg3f"></i>'),Ft=G('<button class="stroke-speed-button svelte-rncg3f"><!> <span class="svelte-rncg3f"> </span></button>'),It=(r,a)=>a(),Nt=G('<i style="font-size: 2.4em" class="fa fa-solid fa-seedling svelte-rncg3f"></i> <span class="svelte-rncg3f">New</span>',1),Dt=G('<i></i> <span class="svelte-rncg3f"> </span>',1),Pt=G("<button><!></button>"),Mt=G('<div class="character-writer svelte-rncg3f"><div class="meaning svelte-rncg3f"> </div> <div><div class="reading svelte-rncg3f"> </div> <!></div> <div class="character-container svelte-rncg3f"><div class="grid-background svelte-rncg3f"><svg xmlns="http://www.w3.org/2000/svg" id="grid-background-target" class="svelte-rncg3f"><line class="svelte-rncg3f"></line><line class="svelte-rncg3f"></line><line class="svelte-rncg3f"></line><line class="svelte-rncg3f"></line></svg></div> <div class="bottom-container svelte-rncg3f"><!></div> <!> <!></div></div>');function Ot(r,a){var ze;wa(a,!0);let i=be(500),s=be(500),u=be(30),m=Ka(()=>e(u)),D="#DDD";const q=500,X=new Audio(`${nt}/assets/sounds/correct-choice-43861.mp3`);let l=be(Ya([])),P=be(!1),oe=be(!1),R=be(!1);function h(){return parseFloat(getComputedStyle(document.body).fontSize)}function J(){return parseFloat(getComputedStyle(document.body).fontSize)/parseFloat(getComputedStyle(document.documentElement).fontSize)}function t(){const c=h()*2*.8;o(i,Math.min(document.documentElement.clientWidth-c,500)*J()),o(s,e(i),!0),o(u,.5*h()*J())}let T=ua(a,"isRequestManualGrade",15),d=ua(a,"autoReviewData",15),y=be(0),B=(ze=a.characterData)==null?void 0:ze.meanings.join("; ");function Te(c){for(const v of c)if(v.startsWith(ga))return ut(v.substring(ga.length))}function M(){var c;o(oe,!0),!e(R)&&(a.cardConfig.isFirstTime?(o(y,(e(y)+1)%a.characterData.characters.length),window.setTimeout(()=>{pe(e(y))},q)):(X.play(),o(y,e(y)+1),e(y)==((c=a.characterData)==null?void 0:c.characters.length)?(a.onComplete({...d()}),o(P,!0),window.setTimeout(()=>{ae()},q)):window.setTimeout(()=>{pe(e(y))},q)))}let F;function pe(c){if(e(R)||!a.characterData)return;F&&(a.cardConfig.isFirstTime||F.cancelQuiz(),F.hideCharacter(),F.hideOutline());const v=Te(a.characterData.tags[c]??[]);F=lt.create("grid-background-target",a.characterData.characters[c],{width:e(i),height:e(s),padding:5,showCharacter:!1,showOutline:a.cardConfig.isShowOutline,highlightOnComplete:!1,strokeColor:a.app.getChineseToneColor(v)??"#555",drawingWidth:ct,drawingColor:"#555",strokeAnimationSpeed:e(le),delayBetweenStrokes:ma(e(le),1,re,1e3,10),delayBetweenLoops:ma(e(le),1,re,2e3,10),onComplete:()=>{M()}}),a.cardConfig.isFirstTime?(setTimeout(()=>{e(oe)||ae()},q),setTimeout(()=>{F.animateCharacter({onComplete:()=>{setTimeout(()=>{F.hideOutline(),F.hideCharacter(),M()},q)}})},q)):(F.quiz({leniency:a.app.getConfig().strokeLeniency,onMistake:()=>{d(d().incorrectStrokeCount++,!0),d(d().totalStrokeCount++,!0)},onCorrectStroke:()=>{d(d().correctStrokeCount++,!0),d(d().totalStrokeCount++,!0)}}),d().isFailAndReveal&&F.showOutline())}function we(){var v;const c=(v=a.characterData)==null?void 0:v.audioUrl;c&&o(l,c.map(ee=>{const n=ee.map(x=>dt(a.cardConfig.lang,x));return new Ct(n)}),!0)}function ae(){const c=Math.floor(Math.random()*e(l).length),v=e(l)[c];v.stop(),v.play()}function Ne(){if(a.cardConfig.isWarmUp&&(!a.cardConfig.isGradeWarmUpCards||!a.cardConfig.isFinalWarmUp)){window.alert("Can't change grade during warm-up, since grading doesn't affect scheduling in this phase.");return}T(!T())}function me(c=0){const v=a.cardConfig.warmUpCount??0,ee=a.cardConfig.warmUpMaxCount;return`${Math.round((v+c)/ee*100)}%`}function Se(){F&&(d(d().isFailAndReveal=!0,!0),F.showOutline())}const re=5;let le=be(1);function C(){const c=e(le)%re+1;o(le,c),a.app.setStrokeSpeed(c)}ya(()=>(d({correctStrokeCount:0,incorrectStrokeCount:0,totalStrokeCount:0,isFailAndReveal:!1}),t(),we(),window.addEventListener("resize",t),o(le,a.app.getStrokeSpeed(),!0),pe(0),()=>{o(R,!0),window.removeEventListener("resize",t)}));var ge=Mt(),De=_(ge),_e=_(De,!0);g(De);var Ee=E(De,2);let Ze;var Pe=_(Ee),ta=_(Pe,!0);g(Pe);var ra=E(Pe,2);{var Ye=c=>{var v=kt();v.__click=[bt,ae],w(c,v)};z(ra,c=>{e(l).length>0&&c(Ye)})}g(Ee);var Me=E(Ee,2),Oe=_(Me),Ge=_(Oe),xe=_(Ge);W(xe,"stroke",D);var Ae=E(xe);W(Ae,"stroke",D);var Re=E(Ae);W(Re,"stroke",D);var Ue=E(Re);W(Ue,"stroke",D),g(Ge),g(Oe);var Le=E(Oe,2),He=_(Le);{var na=c=>{var v=Ut(),ee=We(v);{var n=b=>{var k=St();w(b,k)},x=(b,k)=>{{var Y=f=>{var I=xt();let te,Z;fe((N,O)=>{te=se(I,1,"new-element-indicator svelte-rncg3f",null,te,N),Z=ot(I,"",Z,O)},[()=>({"is-complete":e(P)}),()=>({"--progress":me(),"--next-progress":me(1)})]),w(f,I)},ce=f=>{var I=At();w(f,I)};z(b,f=>{a.cardConfig.isWarmUp?f(Y):f(ce,!1)},k)}};z(ee,b=>{a.cardConfig.isFirstTime?b(n):b(x,!1)})}var p=E(ee,2);ka(p,21,()=>a.characterData.characters,Sa,(b,k,Y)=>{var ce=da(),f=We(ce);{var I=Z=>{var N=Rt(),O=_(N,!0);g(N),fe(()=>$(O,e(k))),w(Z,N)},te=Z=>{var N=Tt();w(Z,N)};z(f,Z=>{Y<e(y)||a.cardConfig.isFirstTime?Z(I):Z(te,!1)})}w(b,ce)}),g(p),w(c,v)};z(He,c=>{var v;(v=a.characterData)!=null&&v.characters&&c(na)})}g(Le);var Ke=E(Le,2);{var Je=c=>{var v=Ft();v.__click=[Wt,C];var ee=_(v);{var n=k=>{var Y=Et();w(k,Y)},x=k=>{var Y=Gt();w(k,Y)};z(ee,k=>{e(le)<=1?k(n):k(x,!1)})}var p=E(ee,2),b=_(p);g(p),g(v),fe(()=>$(b,`${e(le)??""}x`)),w(c,v)};z(Ke,c=>{a.cardConfig.isFirstTime&&c(Je)})}var Qe=E(Ke,2);{var Ve=c=>{var v=Pt();let ee;v.__click=[It,Ne];var n=_(v);{var x=b=>{var k=Nt();Ja(2),w(b,k)},p=b=>{var k=Dt(),Y=We(k),ce=E(Y,2),f=_(ce,!0);g(ce),fe(()=>{se(Y,1,at(yt[a.autoGrade]),"svelte-rncg3f"),$(f,pt[a.autoGrade])}),w(b,k)};z(n,b=>{a.cardConfig.isWarmUp&&!a.cardConfig.isGradeWarmUpCards?b(x):b(p,!1)})}g(v),fe(b=>ee=se(v,1,`auto-review-indicator-container ${wt[a.autoGrade]}`,"svelte-rncg3f",ee,b),[()=>({blinking:T(),animated:T(),"echo-once":!T()})]),w(c,v)};z(Qe,c=>{a.autoGrade&&c(Ve)})}return g(Me),g(ge),fe(c=>{var v;$(_e,B),Ze=se(Ee,1,"reading-container svelte-rncg3f",null,Ze,c),$(ta,(v=a.characterData)==null?void 0:v.reading),W(Ge,"width",e(i)),W(Ge,"height",e(s)),W(xe,"x1",e(m)),W(xe,"y1",e(m)),W(xe,"x2",e(i)-e(m)),W(xe,"y2",e(s)-e(m)),W(Ae,"x1",e(i)-e(m)),W(Ae,"y1",e(m)),W(Ae,"x2",e(m)),W(Ae,"y2",e(s)-e(m)),W(Re,"x1",e(i)/2),W(Re,"y1",e(m)),W(Re,"x2",e(i)/2),W(Re,"y2",e(s)-e(m)),W(Ue,"x1",e(m)),W(Ue,"y1",e(s)/2),W(Ue,"x2",e(i)-e(m)),W(Ue,"y2",e(s)/2)},[()=>({"is-hidden":!a.app.getConfig().zh.alwaysShowReading&&!e(P)&&!a.cardConfig.isFirstTime})]),w(r,ge),ba({failAndReveal:Se})}pa(["click"]);const Lt=r=>r;function Ht(r){const a=r-1;return a*a*a+1}function Ca(r){const a=typeof r=="string"&&r.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return a?[parseFloat(a[1]),a[2]||"px"]:[r,"px"]}function zt(r,{delay:a=0,duration:i=400,easing:s=Lt}={}){const u=+getComputedStyle(r).opacity;return{delay:a,duration:i,easing:s,css:m=>`opacity: ${m*u}`}}function qt(r,{delay:a=0,duration:i=400,easing:s=Ht,x:u=0,y:m=0,opacity:D=0}={}){const q=getComputedStyle(r),X=+q.opacity,l=q.transform==="none"?"":q.transform,P=X*(1-D),[oe,R]=Ca(u),[h,J]=Ca(m);return{delay:a,duration:i,easing:s,css:(t,T)=>`
			transform: ${l} translate(${(1-t)*oe}${R}, ${(1-t)*h}${J});
			opacity: ${X-P*T}`}}function Bt(r){const a=r-1;return a*a*a+1}var jt=G('<button><div class="review-button-inner svelte-9hsnmw"><div class="review-time svelte-9hsnmw"> </div> <div class="review-label svelte-9hsnmw"> </div></div></button>'),Xt=G('<button><div class="review-button-inner svelte-9hsnmw"><div class="review-time svelte-9hsnmw"> </div> <div class="review-label svelte-9hsnmw"> </div></div></button>'),Zt=G('<div class="bottom-container svelte-9hsnmw"><div></div></div>'),Yt=G(`<div class="svelte-9hsnmw">You have done today's review.</div>`),Kt=G('<div class="counter svelte-9hsnmw"><span class="underlined svelte-9hsnmw"><!></span></div>'),Jt=G('<div class="counter svelte-9hsnmw"><span> </span> <span> </span> <span> </span> <span> </span> <span> </span></div>'),Qt=G('<!> <div class="character-writer-container svelte-9hsnmw"><!></div> <!>',1),Vt=G('<!> <div class="container svelte-9hsnmw"><!> <!></div>',1);function Cr(r,a){wa(a,!1);const i=H(),s=H(),u=H(),m=(n,x=Ie,p)=>{let b=ie(()=>et(p==null?void 0:p(),""));var k=Zt(),Y=_(k);ka(Y,5,x,Sa,(ce,f)=>{var I=da(),te=We(I);{var Z=O=>{var U=jt();let j;U.__click=function(...K){var ne;(ne=e(f).alternate.onclick)==null||ne.apply(this,K)};var Q=_(U),L=_(Q),de=_(L,!0);g(L);var V=E(L,2),he=_(V,!0);g(V),g(Q),g(U),fe(K=>{j=se(U,1,(e(f),S(()=>`review-button ${e(f).alternate.className||e(f).className||""}`)),"svelte-9hsnmw",j,K),$(de,(e(f),S(()=>e(f).alternate.sublabel||e(f).sublabel||" "))),$(he,(e(f),S(()=>e(f).alternate.label||e(f).label||" ")))},[()=>({"is-complete":!e(f).isComplete})],ie),w(O,U)},N=O=>{var U=Xt();let j;U.__click=function(...K){var ne;(ne=e(f).onclick)==null||ne.apply(this,K)};var Q=_(U),L=_(Q),de=_(L,!0);g(L);var V=E(L,2),he=_(V,!0);g(V),g(Q),g(U),fe(K=>{j=se(U,1,(e(f),S(()=>`review-button ${e(f).className||""}`)),"svelte-9hsnmw",j,K),$(de,(e(f),S(()=>e(f).sublabel||" "))),$(he,(e(f),S(()=>e(f).label||" ")))},[()=>({"is-complete":e(f).isComplete})],ie),w(O,U)};z(te,O=>{e(f),S(()=>e(f).alternate&&!e(f).isComplete&&e(f).alternate.isComplete)?O(Z):O(N,!1)})}w(ce,I)}),g(Y),g(k),fe(()=>se(Y,1,`review-button-container ${e(b)}`,"svelte-9hsnmw")),ha(1,k,()=>qt,()=>D),ha(2,k,()=>zt,()=>q),w(n,k)},D={delay:100,y:-100,duration:300,easing:Bt},q={duration:200};let X=ua(a,"data",8),l=X().deckId||"",P=X().cardIds||encodeURIComponent("[]"),oe=JSON.parse(decodeURIComponent(P)),R=X().isExtraStudy?"Extra Study":"Review",h=H(),J=H(!1),t=H(new it),T=H();ya(async()=>{var p;await e(t).init();const n=(p=e(t).deckData[l])==null?void 0:p.tags;we=n==null?void 0:n.includes(ca.ZH_YUE);const x=n==null?void 0:n.includes(ca.ZH_EXTRA_DICT);await Te.init(we?"yue":"zh",x),o(t,e(t)),pe=n==null?void 0:n.includes(ca.ZH_TRAD),o(ae,e(t).isAutoGrading()),o(Ne,e(t).getConfig().gradeWarmUpCards),o(J,!0),X().isExtraStudy&&e(t).extraStudyHandler.registerReviewCardIdsOverride(oe),_e()});let d=H(!1),y=H(!1),B=H(!1),Te=new vt,M=H(void 0),F=H(!1),pe=!1,we=!1,ae=H(!1),Ne=H(!1),me=H(void 0),Se=H(!1),re=H(0);const le=["Fail","Hard","Good","Easy"];let C=H(void 0),ge=H({1:"",2:"",3:"",4:""});function De(){o(d,!1),o(F,!1),o(me,void 0),o(Se,!1)}function _e(){De(),o(B,!0);const n=e(t).getNextCard(l);if(n===void 0){o(y,!0);return}e(t).getCard(l,n,!0)&&(o(B,!1),o(C,n),o(ge,e(t).getRatingScheduledTimeStr(l,n)),o(M,e(t).getWenbunCustomState(l,n)),Va(re))}async function Ee(){e(t).startWarmUp(l,e(C)),await e(t).save(),o(F,!0),o(C,e(C)),o(ge,e(t).getRatingScheduledTimeStr(l,e(C))),o(M,e(t).getWenbunCustomState(l,e(C)))}async function Ze(){e(t).skipWarmUp(l,e(C)),o(F,!0),await e(t).save(),_e()}function Pe(n){const x=e(t).getCardWord(l,n),p=e(t).getConfig();return Te.getCharacterWriterData(x,{convertToTraditional:pe,mandarinReading:p.zh.mandarinReading,isCantonese:we,isPlayAudio:p.zh.playAudio})}function ta(n){const x=e(t).getWarmUpCount(l,n),p=e(s)&&x===0;return{isFirstTime:e(i),isWarmUp:e(s),isFinalWarmUp:He(n),warmUpCount:x,warmUpMaxCount:e(t).getMaxWarmUpCount(),isGradeWarmUpCards:e(t).getConfig().gradeWarmUpCards,isShowOutline:e(i)||p,lang:we?"yue":"zh"}}function ra(n){o(d,!0),e(ae)&&o(me,aa.getGrade(n))}async function Ye(n){e(t).rateCard(l,e(C),n),await e(t).save(),_e()}function Me(n){switch(n){case A.Easy:return"review-button-easy";case A.Good:return"review-button-good";case A.Hard:return"review-button-hard";case A.Again:return"review-button-fail"}}async function Oe(){e(t).addIgnoredMark(l,e(C)),await e(t).save(),_e()}function Ge(){e(t).extraStudyHandler.rateAgain(e(C)),_e()}function xe(){e(t).extraStudyHandler.rateGood(e(C)),_e()}async function Ae(){e(t).storeAutoGradeLog(e(h).correctStrokeCount,e(h).incorrectStrokeCount,e(me)),e(t).rateCard(l,e(C),e(me)),await e(t).save(),_e()}function Re(n){o(me,n),o(Se,!1)}async function Ue(){e(t).warmUpNext(l,e(C)),await e(t).save(),_e()}async function Le(){await Ye(A.Again)}function He(n,x){const p=e(t).getWarmUpCount(l,n);return p===void 0?!0:p>=e(t).getMaxWarmUpCount()}function na(n,x){return e(t).getWarmUpCount(l,n)===0}function Ke(){e(T)&&(e(T).failAndReveal(),o(me,aa.getGrade(e(h))))}oa(()=>(e(M),ve),()=>{o(i,e(M)===ve.New)}),oa(()=>(e(M),ve),()=>{o(s,e(M)===ve.WarmUp)}),oa(()=>e(h),()=>{var n;o(u,{label:"Reveal",sublabel:"(Fail)",className:"review-button-fail",onclick:()=>Ke(),isComplete:!((n=e(h))!=null&&n.isFailAndReveal)})}),Qa(),rt();var Je=Vt(),Qe=We(Je);st(Qe,{get title(){return R}});var Ve=E(Qe,2),ze=_(Ve);{var c=n=>{var x=Yt();w(n,x)};z(ze,n=>{e(y)&&n(c)})}var v=E(ze,2);{var ee=n=>{var x=Qt(),p=We(x);la(p,()=>e(re),I=>{var te=da(),Z=We(te);{var N=U=>{var j=Kt(),Q=_(j),L=_(Q);la(L,()=>e(C),de=>{var V=$a();fe(he=>$(V,he),[()=>(e(t),S(()=>e(t).extraStudyHandler.getCardsCount()||""))],ie),w(de,V)}),g(Q),g(j),w(U,j)},O=U=>{var j=Jt(),Q=_(j);let L;var de=_(Q,!0);g(Q);var V=E(Q,2);let he;var K=_(V,!0);g(V);var ne=E(V,2);let $e;var ia=_(ne,!0);g(ne);var ue=E(ne,2);let Fe;var sa=_(ue,!0);g(ue);var qe=E(ue,2);let ye;var Be=_(qe,!0);g(qe),g(j),fe((je,Ce,Ra,Ta,Ua,Wa,Ea,Ga,Fa,Ia)=>{L=se(Q,1,"deck-count-learn-relearn svelte-9hsnmw",null,L,je),$(de,Ce),he=se(V,1,"deck-count-review svelte-9hsnmw",null,he,Ra),$(K,Ta),$e=se(ne,1,"deck-count-new svelte-9hsnmw",null,$e,Ua),$(ia,Wa),Fe=se(ue,1,"deck-count-new svelte-9hsnmw",null,Fe,Ea),$(sa,Ga),ye=se(qe,1,"deck-count-previously-studied svelte-9hsnmw",null,ye,Fa),$(Be,Ia)},[()=>({underlined:e(M)===ve.Learning||e(M)===ve.Relearning}),()=>(e(t),S(()=>e(t).getLearningRelearningCardsCount(l)||"")),()=>({underlined:e(M)===ve.ReviewYoung||e(M)===ve.ReviewMature}),()=>(e(t),S(()=>e(t).getScheduledReviewCardsCount(l)||"")),()=>({underlined:e(M)===ve.New}),()=>(e(t),S(()=>e(t).getScheduledNewCardsCount(l)||"")),()=>({underlined:e(M)===ve.WarmUp}),()=>(e(t),S(()=>e(t).getWarmUpCardsCount(l)?`(${e(t).getWarmUpCardsCount(l)})`:"")),()=>({underlined:e(M)===ve.PreviouslyStudied}),()=>(e(t),S(()=>e(t).getScheduledPreviouslyStudiedCardsCount(l)||""))],ie),w(U,j)};z(Z,U=>{fa(X()),S(()=>X().isExtraStudy)?U(N):U(O,!1)})}w(I,te)});var b=E(p,2),k=_(b);la(k,()=>[e(C),e(F),e(B)],I=>{const te=ie(()=>(e(C),S(()=>Pe(e(C))))),Z=ie(()=>(e(C),S(()=>ta(e(C)))));tt(Ot(I,{get app(){return e(t)},get characterData(){return e(te)},onComplete:N=>ra(N),get cardConfig(){return e(Z)},get autoGrade(){return e(me)},get isRequestManualGrade(){return e(Se)},set isRequestManualGrade(N){o(Se,N)},get autoReviewData(){return e(h)},set autoReviewData(N){o(h,N)},$$legacy:!0}),N=>o(T,N),()=>e(T))}),g(b);var Y=E(b,2);{var ce=I=>{m(I,()=>[{label:"Ignore",sublabel:"(Don't Learn)",className:"review-button-fail",isComplete:!0,onclick:()=>Oe()},{label:"Learn*",sublabel:"(Skip Warm-Up)",className:"review-button-hard",isComplete:!0,onclick:()=>Ze()},{label:""},{label:"Learn",className:"review-button-easy main-button",isComplete:!0,onclick:()=>Ee()}])},f=(I,te)=>{{var Z=O=>{var U=ie(()=>(e(u),e(h),e(C),e(re),e(d),S(()=>{var j;return[{label:"",alternate:{...e(u),isComplete:!((j=e(h))!=null&&j.isFailAndReveal)&&!na(e(C),e(re))}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(d),onclick:()=>Ue()}]})));m(O,()=>e(U))},N=(O,U)=>{{var j=L=>{var de=ie(()=>(e(u),e(d),S(()=>[{label:"",alternate:{...e(u),isComplete:!e(d)}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(d),onclick:()=>Le()}])));m(L,()=>e(de))},Q=(L,de)=>{{var V=K=>{m(K,()=>[{label:"Again",sublabel:"(Put Back)",className:"review-button-fail",isComplete:e(d),onclick:()=>Ge(),alternate:e(u)},{label:""},{label:""},{label:"Good",className:"review-button-easy",isComplete:e(d),onclick:()=>xe()}])},he=(K,ne)=>{{var $e=ue=>{var Fe=ie(()=>(e(u),e(d),S(()=>[{label:"",alternate:{...e(u),isComplete:!e(d)}},{label:""},{label:""},{label:"Next",className:"review-button-easy",isComplete:e(d),onclick:()=>Ae()}])));m(ue,()=>e(Fe))},ia=(ue,Fe)=>{{var sa=ye=>{var Be=ie(()=>(e(ge),e(d),S(()=>le.map((je,Ce)=>({label:je,sublabel:e(ge)[Ce+1],className:Me(Ce+1)+" time",isComplete:e(d),onclick:()=>Re(Ce+1)})))));m(ye,()=>e(Be),()=>"pulsing")},qe=ye=>{var Be=ie(()=>(e(ge),e(d),e(u),S(()=>le.map((je,Ce)=>({label:je,sublabel:e(ge)[Ce+1],className:Me(Ce+1)+" time",isComplete:e(d),alternate:Ce==0?e(u):void 0,onclick:()=>Ye(Ce+1)})))));m(ye,()=>e(Be))};z(ue,ye=>{e(ae)&&e(Se)?ye(sa):ye(qe,!1)},Fe)}};z(K,ue=>{e(ae)&&!e(Se)?ue($e):ue(ia,!1)},ne)}};z(L,K=>{fa(X()),S(()=>X().isExtraStudy)?K(V):K(he,!1)},de)}};z(O,L=>{e(s),e(C),e(re),e(Ne),S(()=>e(s)&&He(e(C),e(re))&&!e(Ne))?L(j):L(Q,!1)},U)}};z(I,O=>{e(s),e(C),e(re),S(()=>e(s)&&!He(e(C),e(re)))?O(Z):O(N,!1)},te)}};z(Y,I=>{e(i)?I(ce):I(f,!1)})}w(n,x)};z(v,n=>{e(J)&&e(C)!==void 0&&!e(y)&&n(ee)})}g(Ve),w(r,Je),ba()}pa(["click"]);export{Cr as component,hr as universal};
