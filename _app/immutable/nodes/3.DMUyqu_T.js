var fe=i=>{throw TypeError(i)};var pe=(i,a,t)=>a.has(i)||fe("Cannot "+t);var v=(i,a,t)=>(pe(i,a,"read from private field"),t?t.call(i):a.get(i)),N=(i,a,t)=>a.has(i)?fe("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(i):a.set(i,t);var V=(i,a,t)=>(pe(i,a,"access private method"),t);import"../chunks/CWj6FrbW.js";import{i as Je}from"../chunks/DwQ4UNdG.js";import{d as Ke,o as Qe,s as L}from"../chunks/rJ17riUA.js";import{s as X,u as be,a as Ve,g as e,b as d,i as Z,o as Xe,q as P,t as me,v as Ze,w as z,x as he,B as f,y as C,z as $e,A as h,C as _,I as b,F as $,G as et,a7 as tt}from"../chunks/BUJD4ESD.js";import{i as Y}from"../chunks/CtJDf-hQ.js";import{A as st,T as at,e as we,b as rt,r as it,i as ke,W as S}from"../chunks/DiU84KLm.js";import{s as ge}from"../chunks/BsQgQLpl.js";import{b as ot}from"../chunks/P0TW0nVR.js";import{p as nt}from"../chunks/DZVCTK4g.js";import{S as lt}from"../chunks/B7PKavCk.js";const ct=({url:i})=>({deckId:i.searchParams.get("id")||""}),Ft=Object.freeze(Object.defineProperty({__proto__:null,load:ct},Symbol.toStringTag,{value:"Module"}));var dt=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],ut=["difference","intersection","symmetricDifference","union"],ye=!1,T,k,M,H,A,Se,xe;const J=class J extends Set{constructor(t){super();N(this,A);N(this,T,new Map);N(this,k,X(0));N(this,M,X(0));N(this,H,be||-1);if(t){for(var l of t)super.add(l);v(this,M).v=super.size}ye||V(this,A,xe).call(this)}has(t){var l=super.has(t),m=v(this,T),c=m.get(t);if(c===void 0){if(!l)return e(v(this,k)),!1;c=V(this,A,Se).call(this,!0),m.set(t,c)}return e(c),l}add(t){return super.has(t)||(super.add(t),d(v(this,M),super.size),Z(v(this,k))),this}delete(t){var l=super.delete(t),m=v(this,T),c=m.get(t);return c!==void 0&&(m.delete(t),d(c,!1)),l&&(d(v(this,M),super.size),Z(v(this,k))),l}clear(){if(super.size!==0){super.clear();var t=v(this,T);for(var l of t.values())d(l,!1);t.clear(),d(v(this,M),0),Z(v(this,k))}}keys(){return this.values()}values(){return e(v(this,k)),super.values()}entries(){return e(v(this,k)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return e(v(this,M))}};T=new WeakMap,k=new WeakMap,M=new WeakMap,H=new WeakMap,A=new WeakSet,Se=function(t){return be===v(this,H)?X(t):Ve(t)},xe=function(){ye=!0;var t=J.prototype,l=Set.prototype;for(const m of dt)t[m]=function(...c){return e(v(this,k)),l[m].apply(this,c)};for(const m of ut)t[m]=function(...c){e(v(this,k));var r=l[m].apply(this,c);return new J(r)}};let ee=J;var vt=(i,a)=>a(),_t=(i,a,t)=>a(e(t).label),ft=z('<i class="fa-solid fa-chevron-down"></i>'),pt=z('<i class="fa-solid fa-chevron-right"></i>'),bt=(i,a)=>a(),mt=(i,a)=>a(),ht=(i,a)=>a(),wt=(i,a)=>a(),kt=z('<div style="display: flex; flex-direction: row; justify-content: space-between; width: 100%"><div class="group-buttons-container svelte-5wd7so"><button class="button svelte-5wd7so"><i class="fa-solid fa-xmark"></i>cancel selection</button> <button class="button svelte-5wd7so"><i class="fa-solid fa-check-double"></i>select all</button></div> <div class="group-buttons-container svelte-5wd7so" style="flex-direction: row-reverse;"><button class="button svelte-5wd7so"><i class="fa-solid fa-book-open"></i>mark as previously studied</button> <button class="button svelte-5wd7so">remove previously studied mark</button></div></div>'),gt=(i,a,t,l)=>a(e(t).label,e(l)),yt=(i,a,t,l)=>{i.key=="Enter"&&a(e(t).label,e(l))},St=(i,a,t,l)=>a(e(t).label,e(l),i),xt=z('<button class="button select-button svelte-5wd7so">select</button>'),Ct=z('<div role="button" tabindex="0"><!> <div class="card-word svelte-5wd7so"><span class="word"> </span></div> <div class="card-details svelte-5wd7so"><div> </div> <div class="due svelte-5wd7so"> </div></div></div>'),Mt=z('<!> <div class="group-content svelte-5wd7so"></div>',1),zt=z('<div class="group svelte-5wd7so"><button class="group-header svelte-5wd7so"><div> </div> <div><!></div></button> <!></div>'),Ot=z('<!> <div class="container svelte-5wd7so"><div class="top-container" style="display: flex; gap: 0.5em; margin-bottom: 2em"><button class="button svelte-5wd7so">Split into groups of</button> <input class="input" type="number" min="1" max="100"/></div> <div class="group-container svelte-5wd7so"></div></div>',1);function Rt(i,a){Xe(a,!1);const t=P(),l=P();let c=nt(a,"data",8)().deckId||"",r=P(new st);Qe(async()=>{await e(r).init(),d(r,e(r))});let x=P(new lt);function Ce(o){e(x).set(o,!e(x).get(o)),d(x,e(x))}function te(o,s,w){switch(w.getWenbunCustomState(o,s)??S.New){case S.New:return"card-status-new";case S.Learning:return"card-status-learning";case S.ReviewYoung:return"card-status-review-young";case S.ReviewMature:return"card-status-review-mature";case S.Relearning:return"card-status-relearning";case S.PreviouslyStudied:return"card-status-previously-studied"}}let W=P(rt);async function Me(){const o=Math.ceil(e(t).deck.length/e(W));window.confirm(`Split the deck into ${o} groups?`)&&(e(r).splitDeckIntoGroupOfN(c,e(W)),await e(r).save(),d(r,e(r)))}let p=P(null),n=P(new ee);function ze(o,s,w){w==null||w.stopPropagation(),d(p,o),e(n).clear(),s!=null&&e(n).add(s),d(n,e(n))}function Oe(){d(p,null),e(n).clear(),d(n,e(n))}function Pe(o,s,w){return e(p)==o&&w.has(s)}function se(o,s){e(p)==o&&(e(n).has(s)?e(n).delete(s):e(n).add(s),d(n,e(n)))}function De(){if(e(p)==null)return;const o=e(t).groups.find(s=>s.label==e(p));if(o!=null){e(n).clear();for(const s of o.cardIds)e(n).add(s);d(n,e(n))}}async function Ne(){e(p)!=null&&(e(n).forEach(o=>{e(r).addPreviouslyStudiedMark(c,o)}),await e(r).save(),d(r,e(r)))}async function Te(){e(p)!=null&&(e(n).forEach(o=>{e(r).removePreviouslyStudiedMark(c,o)}),await e(r).save(),d(r,e(r)))}me(()=>e(r),()=>{d(t,e(r).deckData[c])}),me(()=>e(t),()=>{var o;d(l,((o=e(t))==null?void 0:o.groups)??[])}),Ze(),Je();var ae=Ot(),re=he(ae);at(re,{title:"Deck",backUrl:"/"});var ie=h(re,2),K=f(ie),oe=f(K);oe.__click=[vt,Me];var ne=h(oe,2);it(ne),_(K);var le=h(K,2);we(le,5,()=>e(l),ke,(o,s)=>{var w=zt(),j=f(w);j.__click=[_t,Ce,s];var Q=f(j),Ae=f(Q,!0);_(Q);var ce=h(Q,2),Ee=f(ce);{var Ge=g=>{var D=ft();C(g,D)},Ie=g=>{var D=pt();C(g,D)};Y(Ee,g=>{e(x),e(s),b(()=>e(x).get(e(s).label))?g(Ge):g(Ie,!1)})}_(ce),_(j);var Ue=h(j,2);{var We=g=>{var D=Mt(),de=he(D);{var je=E=>{var u=kt(),y=f(u),G=f(y);G.__click=[bt,Oe];var F=h(G,2);F.__click=[mt,De],_(y);var R=h(y,2),O=f(R);O.__click=[ht,Ne];var I=h(O,2);I.__click=[wt,Te],_(R),_(u),$(()=>{O.disabled=(e(n),b(()=>e(n).size==0)),I.disabled=(e(n),b(()=>e(n).size==0))}),C(E,u)};Y(de,E=>{e(p),e(s),b(()=>e(p)==e(s).label)&&E(je)})}var ue=h(de,2);we(ue,5,()=>(e(s),b(()=>e(s).cardIds)),ke,(E,u)=>{var y=Ct();let G;y.__click=[gt,se,s,u],y.__keydown=[yt,se,s,u];var F=f(y);{var R=U=>{var q=xt();q.__click=[St,ze,s,u],C(U,q)};Y(F,U=>{e(p),e(s),b(()=>e(p)!=e(s).label)&&U(R)})}var O=h(F,2),I=f(O),Fe=f(I,!0);_(I),_(O);var ve=h(O,2),B=f(ve),Re=f(B,!0);_(B);var _e=h(B,2),Be=f(_e,!0);_(_e),_(ve),_(y),$((U,q,qe,Le,Ye,He)=>{G=ge(y,1,U,"svelte-5wd7so",G,q),L(Fe,qe),ge(B,1,Le,"svelte-5wd7so"),L(Re,Ye),L(Be,He)},[()=>(e(u),e(r),b(()=>`card ${te(c,e(u),e(r))}`)),()=>({selectable:e(p)==e(s).label,selected:Pe(e(s).label,e(u),e(n))}),()=>(e(r),e(u),b(()=>e(r).getCardWord(c,e(u)))),()=>(e(u),e(r),b(()=>`status ${te(c,e(u),e(r))}`)),()=>(e(r),e(u),tt(S),b(()=>e(r).getWenbunCustomState(c,e(u))??S.New)),()=>(e(r),e(u),b(()=>e(r).getCardDueFormatted(c,e(u))))],et),C(E,y)}),_(ue),C(g,D)};Y(Ue,g=>{e(x),e(s),b(()=>e(x).get(e(s).label))&&g(We)})}_(w),$(()=>L(Ae,(e(s),b(()=>e(s).label=="__ungrouped__"?"Ungrouped":e(s).label)))),C(o,w)}),_(le),_(ie),ot(ne,()=>e(W),o=>d(W,o)),C(i,ae),$e()}Ke(["click","keydown"]);export{Rt as component,Ft as universal};
