import"../chunks/CWj6FrbW.js";import{i as Ke}from"../chunks/CdGgX4fi.js";import{s as se,d as Qe,o as We}from"../chunks/B4tcad5q.js";import{aA as Xe,ac as Ye,aB as Ze,aC as et,aD as tt,o as Oe,w as u,C as p,D as c,B as i,aa as rt,F as at,y as A,z as d,A as Me,q as R,t as ee,v as ot,x as te,g as e,b as m,aE as h,aF as re,I as P,a7 as w}from"../chunks/DCeKAzBs.js";import{i as Le}from"../chunks/B_3B16l0.js";import{S as it,A as st,T as lt,_ as J,r as $,N as v,c as Be,e as nt,i as vt,C as ae}from"../chunks/DKj2zUv3.js";import{s as oe}from"../chunks/Be9VuDtp.js";import{l as dt,b as k,a as K}from"../chunks/8vzHIg2V.js";import{b as ut}from"../chunks/DsK34pxb.js";function qe(s,l,C=!1){if(s.multiple){if(l==null)return;if(!Ye(l))return Ze();for(var b of s.options)b.selected=l.includes(U(b));return}for(b of s.options){var n=U(b);if(et(n,l)){b.selected=!0;return}}(!C||l!==void 0)&&(s.selectedIndex=-1)}function ct(s){var l=new MutationObserver(()=>{qe(s,s.__value)});l.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),tt(()=>{l.disconnect()})}function ie(s,l,C=l){var b=!0;dt(s,"change",n=>{var r=n?"[selected]":":checked",x;if(s.multiple)x=[].map.call(s.querySelectorAll(r),U);else{var I=s.querySelector(r)??s.querySelector("option:not([disabled])");x=I&&U(I)}C(x)}),Xe(()=>{var n=l();if(qe(s,n,b),b&&n===void 0){var r=s.querySelector(":checked");r!==null&&(n=U(r),C(n))}s.__value=n,b=!1}),ct(s)}function U(s){return"__value"in s?s.__value:s.value}var _t=u('<div class="settings-item"><label class="settings-label svelte-k8ruu5"><div><div class="settings-label-title"> </div> <div class="settings-label-help svelte-k8ruu5"> </div></div> <div class="settings-children"><!></div></label></div>');function y(s,l){Oe(l,!0);const C=it[l.key]??{label:"",help:""};var b=_t(),n=p(b),r=p(n),x=p(r),I=p(x,!0);c(x);var G=i(x,2),F=p(G,!0);c(G),c(r);var H=i(r,2),L=p(H);rt(L,()=>l.children??at),c(H),c(n),c(b),A(()=>{se(I,C.label),se(F,C.help)}),d(s,b),Me()}var pt=(s,l)=>l(),ft=(s,l)=>l(),ht=(s,l)=>l(),yt=u('<textarea class="profile-textarea svelte-9vzc0u"></textarea> <button class="button svelte-9vzc0u">import</button> <div class="settings-label-help svelte-9vzc0u" style="margin: 1em 0">To manually export the profile data, copy the text above and store it somewhere safe.<br/> To manually import the profile data, paste the text into the textbox and click the import button.</div> <button class="button svelte-9vzc0u">Reset Debug Profile</button>',1),mt=(s,l)=>m(l,!e(l)),bt=(s,l)=>e(l).downloadProfile(),gt=(s,l)=>l(),$t=u('<input type="number" class="svelte-9vzc0u"/>'),St=u('<input type="number" class="svelte-9vzc0u"/>'),zt=u("<select><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),Pt=u('<input type="number" class="svelte-9vzc0u"/>'),wt=u("<select><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),kt=u('<input type="text"/>'),Ct=u('<input type="text"/>'),xt=u('<div style="display: flex; flex-direction: row; align-items: center; gap: 0.5em;"><input type="number" step="0.01" class="svelte-9vzc0u"/></div>'),Rt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Tt=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Dt=u("<textarea></textarea>"),At=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Ft=u('<input type="checkbox" class="svelte-9vzc0u"/>'),Lt=(s,l,C)=>l(e(C)),Bt=u("<option> </option>"),Ot=u("<div><div>Load Preset</div> <div><select></select></div></div>"),Mt=u('<input type="color" class="svelte-9vzc0u"/>'),qt=u('<input type="color" class="svelte-9vzc0u"/>'),It=u('<input type="color" class="svelte-9vzc0u"/>'),Nt=u('<input type="color" class="svelte-9vzc0u"/>'),Vt=u('<input type="color" class="svelte-9vzc0u"/>'),jt=u(`<div class="settings-section svelte-9vzc0u"><button class="button svelte-9vzc0u">Save</button></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Profile</div> <div class="section-container svelte-9vzc0u"><!> <button class="button svelte-9vzc0u">manual import/export</button> <button class="button svelte-9vzc0u"><i class="fa-solid fa-download"></i>&nbsp;
                    export profile data (download)</button> <button class="button svelte-9vzc0u"><i class="fa-solid fa-upload"></i>&nbsp;
                    import profile data (upload)</button></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Learning</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">FSRS</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-9vzc0u"><div class="section-title svelte-9vzc0u">Chinese</div> <div class="section-container svelte-9vzc0u"><!> <!> <!> <!> <!> <!> <!> <!></div></div>`,1),Et=u('<!> <div class="main-container svelte-9vzc0u"><!></div>',1);function Zt(s,l){Oe(l,!1);const C=R(),b=R();let n=R(new st),r=R(),x=R();We(async()=>{await e(n).init(),m(r,J.cloneDeep(e(n).getConfig())),m(x,J.cloneDeep(e(r))),m(L,e(r).learningSteps.join(" ")),m(j,e(r).previouslyStudiedLearningSteps.join(" ")),m(E,e(r).FSRSParams.join(",")),m(B,e(n).exportProfile()),m(Q,e(B)),m(n,e(n))});async function I(){await e(n).saveConfig(e(r)),m(x,J.cloneDeep(e(r)))}async function G(){window.confirm("Are you sure you want to reset to the debug profile?")&&(await e(n).debug(),m(n,e(n)))}let F=R("");function H(g){const N=ae[g];N&&h(r,e(r).zh.toneColors=N),m(F,"")}let L=R(""),j=R(""),E=R(""),le=R(!1),B=R(""),Q=R("");function Ie(){e(n).tryImportProfile(e(B)).then(g=>{ne(g)})}function Ne(){e(n).tryUploadProfile().then(g=>{ne(g)})}function ne(g){g?window.alert("Successfully imported profile data"):window.alert("Failed to import profile data")}ee(()=>(e(r),e(x)),()=>{m(C,!J.isEqual(e(r),e(x)))}),ee(()=>(e(r),e(L),e(j),e(E)),()=>{if(e(r)){const g=e(L).split(" ").map(_=>_.trim()).filter(_=>_);g.length<4&&g.every(_=>_.match(/^\d+[m|d]$/))&&h(r,e(r).learningSteps=g);const O=e(j).split(" ").map(_=>_.trim()).filter(_=>_);O.length<4&&O.every(_=>_.match(/^\d+[m|d]$/))&&h(r,e(r).previouslyStudiedLearningSteps=O);const M=e(E).split(",").map(_=>_.trim()).filter(_=>_);M.length===21&&M.every(_=>!isNaN(parseFloat(_)))&&h(r,e(r).FSRSParams=M.map(_=>parseFloat(_)))}}),ee(()=>(e(B),e(Q)),()=>{m(b,e(B)!==e(Q))}),ot(),Ke();var ve=Et(),de=te(ve);lt(de,{title:"Settings",get backUrl(){return`${ut??""}/`},isSettings:!0});var ue=i(de,2),Ve=p(ue);{var je=g=>{var N=jt(),O=te(N),W=p(O);W.__click=[pt,I],c(O);var M=i(O,2),X=i(p(M),2),_=p(X);{var Ee=o=>{var f=yt(),t=te(f);Be(t);var a=i(t,2);a.__click=[ft,Ie];var S=i(a,4);S.__click=[ht,G],A(()=>a.disabled=!e(b)),k(t,()=>e(B),z=>m(B,z)),d(o,f)};Le(_,o=>{e(le)&&o(Ee)})}var ce=i(_,2);ce.__click=[mt,le];var _e=i(ce,2);_e.__click=[bt,n];var Ue=i(_e,2);Ue.__click=[gt,Ne],c(X),c(M);var Y=i(M,2),pe=i(p(Y),2),fe=p(pe);y(fe,{key:"newCardPerDay",children:(o,f)=>{var t=$t();$(t),k(t,()=>e(r).newCardPerDay,a=>h(r,e(r).newCardPerDay=a)),d(o,t)},$$slots:{default:!0}});var he=i(fe,2);y(he,{key:"maxReviewsPerDay",children:(o,f)=>{var t=St();$(t),k(t,()=>e(r).maxReviewsPerDay,a=>h(r,e(r).maxReviewsPerDay=a)),d(o,t)},$$slots:{default:!0}});var ye=i(he,2);y(ye,{key:"newCardOrder",children:(o,f)=>{var t=zt();A(()=>{e(r),re(()=>{})});var a=p(t),S={},z=i(a),D={},T=i(z),q={};c(t),A(()=>{S!==(S=(w(v),P(()=>v.Mix)))&&(a.value=(a.__value=(w(v),P(()=>v.Mix)))??""),D!==(D=(w(v),P(()=>v.AfterReviews)))&&(z.value=(z.__value=(w(v),P(()=>v.AfterReviews)))??""),q!==(q=(w(v),P(()=>v.BeforeReviews)))&&(T.value=(T.__value=(w(v),P(()=>v.BeforeReviews)))??"")}),ie(t,()=>e(r).newCardOrder,V=>h(r,e(r).newCardOrder=V)),d(o,t)},$$slots:{default:!0}});var me=i(ye,2);y(me,{key:"newPreviouslyStudiedCardPerDay",children:(o,f)=>{var t=Pt();$(t),k(t,()=>e(r).newPreviouslyStudiedCardPerDay,a=>h(r,e(r).newPreviouslyStudiedCardPerDay=a)),d(o,t)},$$slots:{default:!0}});var Ge=i(me,2);y(Ge,{key:"newPreviouslyStudiedCardOrder",children:(o,f)=>{var t=wt();A(()=>{e(r),re(()=>{})});var a=p(t),S={},z=i(a),D={},T=i(z),q={};c(t),A(()=>{S!==(S=(w(v),P(()=>v.Mix)))&&(a.value=(a.__value=(w(v),P(()=>v.Mix)))??""),D!==(D=(w(v),P(()=>v.AfterReviews)))&&(z.value=(z.__value=(w(v),P(()=>v.AfterReviews)))??""),q!==(q=(w(v),P(()=>v.BeforeReviews)))&&(T.value=(T.__value=(w(v),P(()=>v.BeforeReviews)))??"")}),ie(t,()=>e(r).newPreviouslyStudiedCardOrder,V=>h(r,e(r).newPreviouslyStudiedCardOrder=V)),d(o,t)},$$slots:{default:!0}}),c(pe),c(Y);var Z=i(Y,2),be=i(p(Z),2),ge=p(be);y(ge,{key:"learningSteps",children:(o,f)=>{var t=kt();$(t),oe(t,1,"svelte-9vzc0u",null,{},{invalid:!1}),k(t,()=>e(L),a=>m(L,a)),d(o,t)},$$slots:{default:!0}});var $e=i(ge,2);y($e,{key:"previouslyStudiedLearningSteps",children:(o,f)=>{var t=Ct();$(t),oe(t,1,"svelte-9vzc0u",null,{},{invalid:!1}),k(t,()=>e(j),a=>m(j,a)),d(o,t)},$$slots:{default:!0}});var Se=i($e,2);y(Se,{key:"desiredRetention",children:(o,f)=>{var t=xt(),a=p(t);$(a),c(t),k(a,()=>e(r).desiredRetention,S=>h(r,e(r).desiredRetention=S)),d(o,t)},$$slots:{default:!0}});var ze=i(Se,2);y(ze,{key:"enableShortTerm",children:(o,f)=>{var t=Rt();$(t),K(t,()=>e(r).enableShortTerm,a=>h(r,e(r).enableShortTerm=a)),d(o,t)},$$slots:{default:!0}});var Pe=i(ze,2);y(Pe,{key:"enableFuzz",children:(o,f)=>{var t=Tt();$(t),K(t,()=>e(r).enableFuzz,a=>h(r,e(r).enableFuzz=a)),d(o,t)},$$slots:{default:!0}});var He=i(Pe,2);y(He,{key:"FSRSParams",children:(o,f)=>{var t=Dt();Be(t),oe(t,1,"",null,{},{invalid:!1}),k(t,()=>e(E),a=>m(E,a)),d(o,t)},$$slots:{default:!0}}),c(be),c(Z);var we=i(Z,2),ke=i(p(we),2),Ce=p(ke);y(Ce,{key:"zhAlwaysShowReading",children:(o,f)=>{var t=At();$(t),K(t,()=>e(r).zh.alwaysShowReading,a=>h(r,e(r).zh.alwaysShowReading=a)),d(o,t)},$$slots:{default:!0}});var xe=i(Ce,2);y(xe,{key:"zhIsColorBasedOnTone",children:(o,f)=>{var t=Ft();$(t),K(t,()=>e(r).zh.isColorBasedOnTone,a=>h(r,e(r).zh.isColorBasedOnTone=a)),d(o,t)},$$slots:{default:!0}});var Re=i(xe,2);y(Re,{key:"zhToneColors",children:(o,f)=>{var t=Ot(),a=i(p(t),2),S=p(a);A(()=>{e(F),re(()=>{})}),S.__change=[Lt,H,F],nt(S,5,()=>(w(ae),P(()=>Object.keys(ae))),vt,(z,D)=>{var T=Bt(),q=p(T,!0);c(T);var V={};A(()=>{se(q,e(D)),V!==(V=e(D))&&(T.value=(T.__value=e(D))??"")}),d(z,T)}),c(S),c(a),c(t),ie(S,()=>e(F),z=>m(F,z)),d(o,t)},$$slots:{default:!0}});var Te=i(Re,2);y(Te,{key:"zhTone1",children:(o,f)=>{var t=Mt();$(t),k(t,()=>e(r).zh.toneColors[0],a=>h(r,e(r).zh.toneColors[0]=a)),d(o,t)},$$slots:{default:!0}});var De=i(Te,2);y(De,{key:"zhTone2",children:(o,f)=>{var t=qt();$(t),k(t,()=>e(r).zh.toneColors[1],a=>h(r,e(r).zh.toneColors[1]=a)),d(o,t)},$$slots:{default:!0}});var Ae=i(De,2);y(Ae,{key:"zhTone3",children:(o,f)=>{var t=It();$(t),k(t,()=>e(r).zh.toneColors[2],a=>h(r,e(r).zh.toneColors[2]=a)),d(o,t)},$$slots:{default:!0}});var Fe=i(Ae,2);y(Fe,{key:"zhTone4",children:(o,f)=>{var t=Nt();$(t),k(t,()=>e(r).zh.toneColors[3],a=>h(r,e(r).zh.toneColors[3]=a)),d(o,t)},$$slots:{default:!0}});var Je=i(Fe,2);y(Je,{key:"zhToneNeutral",children:(o,f)=>{var t=Vt();$(t),k(t,()=>e(r).zh.toneColors[4],a=>h(r,e(r).zh.toneColors[4]=a)),d(o,t)},$$slots:{default:!0}}),c(ke),c(we),A(()=>W.disabled=!e(C)),d(g,N)};Le(Ve,g=>{e(r)&&g(je)})}c(ue),d(s,ve),Me()}Qe(["click","change"]);export{Zt as component};
