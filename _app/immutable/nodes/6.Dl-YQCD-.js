import"../chunks/CWj6FrbW.js";import{i as Ge}from"../chunks/FKMpitpj.js";import{s as ie,d as Ue,o as He}from"../chunks/Dt-_adpn.js";import{aA as Je,ac as Ke,aB as Qe,aC as We,aD as Xe,o as Fe,w as _,C as p,D as u,B as o,aa as Ye,F as Ze,y as A,z as d,A as Le,t as Z,v as et,x as ee,b as y,q as T,g as r,aE as h,aF as Te,aG as te,I as S,a7 as P}from"../chunks/BcxkuEzu.js";import{i as De}from"../chunks/BjjZRp6G.js";import{S as tt,A as rt,T as st,_ as J,r as $,N as l,c as Ae,e as at,i as ot,C as re}from"../chunks/B1Egpgee.js";import{s as se}from"../chunks/qBx6NAyu.js";import{l as it,b as C,a as ae}from"../chunks/CouR2eEv.js";import{b as nt}from"../chunks/UHUKRWNa.js";function Be(i,n,w=!1){if(i.multiple){if(n==null)return;if(!Ke(n))return Qe();for(var g of i.options)g.selected=n.includes(G(g));return}for(g of i.options){var v=G(g);if(We(v,n)){g.selected=!0;return}}(!w||n!==void 0)&&(i.selectedIndex=-1)}function lt(i){var n=new MutationObserver(()=>{Be(i,i.__value)});n.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Xe(()=>{n.disconnect()})}function oe(i,n,w=n){var g=!0;it(i,"change",v=>{var t=v?"[selected]":":checked",k;if(i.multiple)k=[].map.call(i.querySelectorAll(t),G);else{var I=i.querySelector(t)??i.querySelector("option:not([disabled])");k=I&&G(I)}w(k)}),Je(()=>{var v=n();if(Be(i,v,g),g&&v===void 0){var t=i.querySelector(":checked");t!==null&&(v=G(t),w(v))}i.__value=v,g=!1}),lt(i)}function G(i){return"__value"in i?i.__value:i.value}var vt=_('<div class="settings-item"><label class="settings-label svelte-k8ruu5"><div><div class="settings-label-title"> </div> <div class="settings-label-help svelte-k8ruu5"> </div></div> <div class="settings-children"><!></div></label></div>');function m(i,n){Fe(n,!0);const w=tt[n.key]??{label:"",help:""};var g=vt(),v=p(g),t=p(v),k=p(t),I=p(k,!0);u(k);var U=o(k,2),F=p(U,!0);u(U),u(t);var H=o(t,2),L=p(H);Ye(L,()=>n.children??Ze),u(H),u(v),u(g),A(()=>{ie(I,w.label),ie(F,w.help)}),d(i,g),Le()}var dt=(i,n)=>n(),ut=(i,n)=>n(),_t=(i,n)=>n(),ct=_('<textarea class="profile-textarea svelte-6s7vox"></textarea> <br/> <button class="button svelte-6s7vox">import</button> <div class="settings-label-help svelte-6s7vox" style="margin: 1em 0">To export the profile data, copy the text above and store it somewhere safe.<br/> To import the profile data, paste the text into the textbox and click the import button.</div> <button class="button svelte-6s7vox">Reset Debug Profile</button> <br/>',1),pt=(i,n)=>y(n,!r(n)),ft=_('<input type="number" class="svelte-6s7vox"/>'),ht=_('<input type="number" class="svelte-6s7vox"/>'),mt=_("<select><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),yt=_('<input type="number" class="svelte-6s7vox"/>'),gt=_("<select><option>Mix</option><option>After Reviews</option><option>Before Reviews</option></select>"),xt=_('<input type="text"/>'),$t=_('<input type="text"/>'),bt=_('<div style="display: flex; flex-direction: row; align-items: center; gap: 0.5em;"><input type="number" step="0.01" class="svelte-6s7vox"/></div>'),St=_('<input type="checkbox" class="svelte-6s7vox"/>'),Pt=_('<input type="checkbox" class="svelte-6s7vox"/>'),Ct=_("<textarea></textarea>"),wt=_('<input type="checkbox" class="svelte-6s7vox"/>'),kt=(i,n,w)=>n(r(w)),zt=_("<option> </option>"),Rt=_("<div><div>Load Preset</div> <div><select></select></div></div>"),Tt=_('<input type="color" class="svelte-6s7vox"/>'),Dt=_('<input type="color" class="svelte-6s7vox"/>'),At=_('<input type="color" class="svelte-6s7vox"/>'),Ft=_('<input type="color" class="svelte-6s7vox"/>'),Lt=_('<input type="color" class="svelte-6s7vox"/>'),Bt=_('<div class="settings-section svelte-6s7vox"><button class="button svelte-6s7vox">Save</button></div> <div class="settings-section svelte-6s7vox"><div class="section-title svelte-6s7vox">Profile</div> <div><!> <button class="button svelte-6s7vox">import/export</button></div> <div class="section-container svelte-6s7vox"></div></div> <div class="settings-section svelte-6s7vox"><div class="section-title svelte-6s7vox">Learning</div> <div class="section-container svelte-6s7vox"><!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-6s7vox"><div class="section-title svelte-6s7vox">FSRS</div> <div class="section-container svelte-6s7vox"><!> <!> <!> <!> <!> <!></div></div> <div class="settings-section svelte-6s7vox"><div class="section-title svelte-6s7vox">Chinese</div> <div class="section-container svelte-6s7vox"><!> <!> <!> <!> <!> <!> <!></div></div>',1),Ot=_('<!> <div class="main-container svelte-6s7vox"><!></div>',1);function Ht(i,n){Fe(n,!1);const w=T(),g=T();let v=new rt,t=T(),k=T();He(async()=>{await v.init(),y(t,J.cloneDeep(v.getConfig())),y(k,J.cloneDeep(r(t))),y(L,r(t).learningSteps.join(" ")),y(j,r(t).previouslyStudiedLearningSteps.join(" ")),y(E,r(t).FSRSParams.join(",")),y(B,v.exportProfile()),y(K,r(B)),v=v});async function I(){await v.saveConfig(r(t)),y(k,J.cloneDeep(r(t)))}async function U(){window.confirm("Are you sure you want to reset to the debug profile?")&&(await v.debug(),v=v)}let F=T("");function H(z){const N=re[z];N&&h(t,r(t).zh.toneColors=N),y(F,"")}let L=T(""),j=T(""),E=T(""),ne=T(!1),B=T(""),K=T("");function Oe(){v.tryImportProfile(r(B)).then(z=>{z||window.alert("Failed to import profile data")})}Z(()=>(r(t),r(k)),()=>{y(w,!J.isEqual(r(t),r(k)))}),Z(()=>(r(t),r(L),r(j),r(E)),()=>{if(r(t)){const z=r(L).split(" ").map(c=>c.trim()).filter(c=>c);z.length<4&&z.every(c=>c.match(/^\d+[m|d]$/))&&h(t,r(t).learningSteps=z);const O=r(j).split(" ").map(c=>c.trim()).filter(c=>c);O.length<4&&O.every(c=>c.match(/^\d+[m|d]$/))&&h(t,r(t).previouslyStudiedLearningSteps=O);const M=r(E).split(",").map(c=>c.trim()).filter(c=>c);M.length===21&&M.every(c=>!isNaN(parseFloat(c)))&&h(t,r(t).FSRSParams=M.map(c=>parseFloat(c)))}}),Z(()=>(r(B),r(K)),()=>{y(g,r(B)!==r(K))}),et(),Ge();var le=Ot(),ve=ee(le);st(ve,{title:"Settings",get backUrl(){return`${nt??""}/`},isSettings:!0});var de=o(ve,2),Me=p(de);{var qe=z=>{var N=Bt(),O=ee(N),Q=p(O);Q.__click=[dt,I],u(O);var M=o(O,2),W=o(p(M),2),c=p(W);{var Ie=a=>{var f=ct(),e=ee(f);Ae(e);var s=o(e,4);s.__click=[ut,Oe];var x=o(s,4);x.__click=[_t,U],Te(2),A(()=>s.disabled=!r(g)),C(e,()=>r(B),b=>y(B,b)),d(a,f)};De(c,a=>{r(ne)&&a(Ie)})}var Ne=o(c,2);Ne.__click=[pt,ne],u(W),Te(2),u(M);var X=o(M,2),ue=o(p(X),2),_e=p(ue);m(_e,{key:"newCardPerDay",children:(a,f)=>{var e=ft();$(e),C(e,()=>r(t).newCardPerDay,s=>h(t,r(t).newCardPerDay=s)),d(a,e)},$$slots:{default:!0}});var ce=o(_e,2);m(ce,{key:"maxReviewsPerDay",children:(a,f)=>{var e=ht();$(e),C(e,()=>r(t).maxReviewsPerDay,s=>h(t,r(t).maxReviewsPerDay=s)),d(a,e)},$$slots:{default:!0}});var pe=o(ce,2);m(pe,{key:"newCardOrder",children:(a,f)=>{var e=mt();A(()=>{r(t),te(()=>{})});var s=p(e),x={},b=o(s),D={},R=o(b),q={};u(e),A(()=>{x!==(x=(P(l),S(()=>l.Mix)))&&(s.value=(s.__value=(P(l),S(()=>l.Mix)))??""),D!==(D=(P(l),S(()=>l.AfterReviews)))&&(b.value=(b.__value=(P(l),S(()=>l.AfterReviews)))??""),q!==(q=(P(l),S(()=>l.BeforeReviews)))&&(R.value=(R.__value=(P(l),S(()=>l.BeforeReviews)))??"")}),oe(e,()=>r(t).newCardOrder,V=>h(t,r(t).newCardOrder=V)),d(a,e)},$$slots:{default:!0}});var fe=o(pe,2);m(fe,{key:"newPreviouslyStudiedCardPerDay",children:(a,f)=>{var e=yt();$(e),C(e,()=>r(t).newPreviouslyStudiedCardPerDay,s=>h(t,r(t).newPreviouslyStudiedCardPerDay=s)),d(a,e)},$$slots:{default:!0}});var Ve=o(fe,2);m(Ve,{key:"newPreviouslyStudiedCardOrder",children:(a,f)=>{var e=gt();A(()=>{r(t),te(()=>{})});var s=p(e),x={},b=o(s),D={},R=o(b),q={};u(e),A(()=>{x!==(x=(P(l),S(()=>l.Mix)))&&(s.value=(s.__value=(P(l),S(()=>l.Mix)))??""),D!==(D=(P(l),S(()=>l.AfterReviews)))&&(b.value=(b.__value=(P(l),S(()=>l.AfterReviews)))??""),q!==(q=(P(l),S(()=>l.BeforeReviews)))&&(R.value=(R.__value=(P(l),S(()=>l.BeforeReviews)))??"")}),oe(e,()=>r(t).newPreviouslyStudiedCardOrder,V=>h(t,r(t).newPreviouslyStudiedCardOrder=V)),d(a,e)},$$slots:{default:!0}}),u(ue),u(X);var Y=o(X,2),he=o(p(Y),2),me=p(he);m(me,{key:"learningSteps",children:(a,f)=>{var e=xt();$(e),se(e,1,"svelte-6s7vox",null,{},{invalid:!1}),C(e,()=>r(L),s=>y(L,s)),d(a,e)},$$slots:{default:!0}});var ye=o(me,2);m(ye,{key:"previouslyStudiedLearningSteps",children:(a,f)=>{var e=$t();$(e),se(e,1,"svelte-6s7vox",null,{},{invalid:!1}),C(e,()=>r(j),s=>y(j,s)),d(a,e)},$$slots:{default:!0}});var ge=o(ye,2);m(ge,{key:"desiredRetention",children:(a,f)=>{var e=bt(),s=p(e);$(s),u(e),C(s,()=>r(t).desiredRetention,x=>h(t,r(t).desiredRetention=x)),d(a,e)},$$slots:{default:!0}});var xe=o(ge,2);m(xe,{key:"enableShortTerm",children:(a,f)=>{var e=St();$(e),ae(e,()=>r(t).enableShortTerm,s=>h(t,r(t).enableShortTerm=s)),d(a,e)},$$slots:{default:!0}});var $e=o(xe,2);m($e,{key:"enableFuzz",children:(a,f)=>{var e=Pt();$(e),ae(e,()=>r(t).enableFuzz,s=>h(t,r(t).enableFuzz=s)),d(a,e)},$$slots:{default:!0}});var je=o($e,2);m(je,{key:"FSRSParams",children:(a,f)=>{var e=Ct();Ae(e),se(e,1,"",null,{},{invalid:!1}),C(e,()=>r(E),s=>y(E,s)),d(a,e)},$$slots:{default:!0}}),u(he),u(Y);var be=o(Y,2),Se=o(p(be),2),Pe=p(Se);m(Pe,{key:"zhIsColorBasedOnTone",children:(a,f)=>{var e=wt();$(e),ae(e,()=>r(t).zh.isColorBasedOnTone,s=>h(t,r(t).zh.isColorBasedOnTone=s)),d(a,e)},$$slots:{default:!0}});var Ce=o(Pe,2);m(Ce,{key:"zhToneColors",children:(a,f)=>{var e=Rt(),s=o(p(e),2),x=p(s);A(()=>{r(F),te(()=>{})}),x.__change=[kt,H,F],at(x,5,()=>(P(re),S(()=>Object.keys(re))),ot,(b,D)=>{var R=zt(),q=p(R,!0);u(R);var V={};A(()=>{ie(q,r(D)),V!==(V=r(D))&&(R.value=(R.__value=r(D))??"")}),d(b,R)}),u(x),u(s),u(e),oe(x,()=>r(F),b=>y(F,b)),d(a,e)},$$slots:{default:!0}});var we=o(Ce,2);m(we,{key:"zhTone1",children:(a,f)=>{var e=Tt();$(e),C(e,()=>r(t).zh.toneColors[0],s=>h(t,r(t).zh.toneColors[0]=s)),d(a,e)},$$slots:{default:!0}});var ke=o(we,2);m(ke,{key:"zhTone2",children:(a,f)=>{var e=Dt();$(e),C(e,()=>r(t).zh.toneColors[1],s=>h(t,r(t).zh.toneColors[1]=s)),d(a,e)},$$slots:{default:!0}});var ze=o(ke,2);m(ze,{key:"zhTone3",children:(a,f)=>{var e=At();$(e),C(e,()=>r(t).zh.toneColors[2],s=>h(t,r(t).zh.toneColors[2]=s)),d(a,e)},$$slots:{default:!0}});var Re=o(ze,2);m(Re,{key:"zhTone4",children:(a,f)=>{var e=Ft();$(e),C(e,()=>r(t).zh.toneColors[3],s=>h(t,r(t).zh.toneColors[3]=s)),d(a,e)},$$slots:{default:!0}});var Ee=o(Re,2);m(Ee,{key:"zhToneNeutral",children:(a,f)=>{var e=Lt();$(e),C(e,()=>r(t).zh.toneColors[4],s=>h(t,r(t).zh.toneColors[4]=s)),d(a,e)},$$slots:{default:!0}}),u(Se),u(be),A(()=>Q.disabled=!r(w)),d(z,N)};De(Me,z=>{r(t)&&z(qe)})}u(de),d(i,le),Le()}Ue(["click","change"]);export{Ht as component};
