var fe=i=>{throw TypeError(i)};var be=(i,a,t)=>a.has(i)||fe("Cannot "+t);var v=(i,a,t)=>(be(i,a,"read from private field"),t?t.call(i):a.get(i)),N=(i,a,t)=>a.has(i)?fe("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(i):a.set(i,t);var Q=(i,a,t)=>(be(i,a,"access private method"),t);import"../chunks/CWj6FrbW.js";import{i as He}from"../chunks/CdGgX4fi.js";import{d as Je,o as Ke,s as L}from"../chunks/B4tcad5q.js";import{s as V,u as pe,a as Qe,g as e,b as d,i as X,o as Ve,q as O,t as he,v as Xe,w as z,x as me,C as f,z as C,A as Ze,B as m,D as _,I as p,y as Z,G as et,a7 as tt}from"../chunks/DCeKAzBs.js";import{i as Y}from"../chunks/B_3B16l0.js";import{A as st,T as at,e as ye,b as rt,r as it,i as ke,W as S}from"../chunks/Bn7_4Cl5.js";import{s as ge}from"../chunks/Be9VuDtp.js";import{b as ot}from"../chunks/BlAXekg0.js";import{p as nt}from"../chunks/DFIMFCGJ.js";import{b as lt}from"../chunks/x9WDRUdC.js";import{S as ct}from"../chunks/BZY7xF5_.js";const dt=({url:i})=>({deckId:i.searchParams.get("id")||""}),Ft=Object.freeze(Object.defineProperty({__proto__:null,load:dt},Symbol.toStringTag,{value:"Module"}));var ut=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],vt=["difference","intersection","symmetricDifference","union"],we=!1,T,k,M,$,A,Se,xe;const H=class H extends Set{constructor(t){super();N(this,A);N(this,T,new Map);N(this,k,V(0));N(this,M,V(0));N(this,$,pe||-1);if(t){for(var l of t)super.add(l);v(this,M).v=super.size}we||Q(this,A,xe).call(this)}has(t){var l=super.has(t),h=v(this,T),c=h.get(t);if(c===void 0){if(!l)return e(v(this,k)),!1;c=Q(this,A,Se).call(this,!0),h.set(t,c)}return e(c),l}add(t){return super.has(t)||(super.add(t),d(v(this,M),super.size),X(v(this,k))),this}delete(t){var l=super.delete(t),h=v(this,T),c=h.get(t);return c!==void 0&&(h.delete(t),d(c,!1)),l&&(d(v(this,M),super.size),X(v(this,k))),l}clear(){if(super.size!==0){super.clear();var t=v(this,T);for(var l of t.values())d(l,!1);t.clear(),d(v(this,M),0),X(v(this,k))}}keys(){return this.values()}values(){return e(v(this,k)),super.values()}entries(){return e(v(this,k)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return e(v(this,M))}};T=new WeakMap,k=new WeakMap,M=new WeakMap,$=new WeakMap,A=new WeakSet,Se=function(t){return pe===v(this,$)?V(t):Qe(t)},xe=function(){we=!0;var t=H.prototype,l=Set.prototype;for(const h of ut)t[h]=function(...c){return e(v(this,k)),l[h].apply(this,c)};for(const h of vt)t[h]=function(...c){e(v(this,k));var r=l[h].apply(this,c);return new H(r)}};let ee=H;var _t=(i,a)=>a(),ft=(i,a,t)=>a(e(t).label),bt=z('<i class="fa-solid fa-chevron-down"></i>'),pt=z('<i class="fa-solid fa-chevron-right"></i>'),ht=(i,a)=>a(),mt=(i,a)=>a(),yt=(i,a)=>a(),kt=(i,a)=>a(),gt=z('<div style="display: flex; flex-direction: row; justify-content: space-between; width: 100%"><div class="group-buttons-container svelte-1c0hby7"><button class="button svelte-1c0hby7"><i class="fa-solid fa-xmark"></i>cancel selection</button> <button class="button svelte-1c0hby7"><i class="fa-solid fa-check-double"></i>select all</button></div> <div class="group-buttons-container svelte-1c0hby7" style="flex-direction: row-reverse;"><button class="button svelte-1c0hby7"><i class="fa-solid fa-book-open"></i>mark as previously studied</button> <button class="button svelte-1c0hby7">remove previously studied mark</button></div></div>'),wt=(i,a,t,l)=>a(e(t).label,e(l)),St=(i,a,t,l)=>{i.key=="Enter"&&a(e(t).label,e(l))},xt=(i,a,t,l)=>a(e(t).label,e(l),i),Ct=z('<button class="button select-button svelte-1c0hby7">select</button>'),Mt=z('<div role="button" tabindex="0"><!> <div class="card-word svelte-1c0hby7"><span class="word"> </span></div> <div class="card-details svelte-1c0hby7"><div> </div> <div class="due svelte-1c0hby7"> </div></div></div>'),zt=z('<!> <div class="group-content svelte-1c0hby7"></div>',1),Dt=z('<div class="group svelte-1c0hby7"><button class="group-header svelte-1c0hby7"><div> </div> <div><!></div></button> <!></div>'),Ot=z('<!> <div class="container svelte-1c0hby7"><div class="top-container" style="display: flex; gap: 0.5em; margin-bottom: 2em"><button class="button svelte-1c0hby7">Split into groups of</button> <input class="input" type="number" min="1" max="100"/></div> <div class="group-container svelte-1c0hby7"></div></div>',1);function qt(i,a){Ve(a,!1);const t=O(),l=O();let c=nt(a,"data",8)().deckId||"",r=O(new st);Ke(async()=>{await e(r).init(),d(r,e(r))});let x=O(new ct);function Ce(o){e(x).set(o,!e(x).get(o)),d(x,e(x))}function te(o,s,y){switch(y.getWenbunCustomState(o,s)??S.New){case S.New:return"card-status-new";case S.Learning:return"card-status-learning";case S.ReviewYoung:return"card-status-review-young";case S.ReviewMature:return"card-status-review-mature";case S.Relearning:return"card-status-relearning";case S.PreviouslyStudied:return"card-status-previously-studied"}}let W=O(rt);async function Me(){const o=Math.ceil(e(t).deck.length/e(W));window.confirm(`Split the deck into ${o} groups?`)&&(e(r).splitDeckIntoGroupOfN(c,e(W)),await e(r).save(),d(r,e(r)))}let b=O(null),n=O(new ee);function ze(o,s,y){y==null||y.stopPropagation(),d(b,o),e(n).clear(),s!=null&&e(n).add(s),d(n,e(n))}function De(){d(b,null),e(n).clear(),d(n,e(n))}function Oe(o,s,y){return e(b)==o&&y.has(s)}function se(o,s){e(b)==o&&(e(n).has(s)?e(n).delete(s):e(n).add(s),d(n,e(n)))}function Pe(){if(e(b)==null)return;const o=e(t).groups.find(s=>s.label==e(b));if(o!=null){e(n).clear();for(const s of o.cardIds)e(n).add(s);d(n,e(n))}}async function Ne(){e(b)!=null&&(e(n).forEach(o=>{e(r).addPreviouslyStudiedMark(c,o)}),await e(r).save(),d(r,e(r)))}async function Te(){e(b)!=null&&(e(n).forEach(o=>{e(r).removePreviouslyStudiedMark(c,o)}),await e(r).save(),d(r,e(r)))}he(()=>e(r),()=>{d(t,e(r).deckData[c])}),he(()=>e(t),()=>{var o;d(l,((o=e(t))==null?void 0:o.groups)??[])}),Xe(),He();var ae=Ot(),re=me(ae);at(re,{title:"Deck",get backUrl(){return`${lt??""}/`}});var ie=m(re,2),J=f(ie),oe=f(J);oe.__click=[_t,Me];var ne=m(oe,2);it(ne),_(J);var le=m(J,2);ye(le,5,()=>e(l),ke,(o,s)=>{var y=Dt(),j=f(y);j.__click=[ft,Ce,s];var K=f(j),Ae=f(K,!0);_(K);var ce=m(K,2),Ee=f(ce);{var Ge=g=>{var P=bt();C(g,P)},Ie=g=>{var P=pt();C(g,P)};Y(Ee,g=>{e(x),e(s),p(()=>e(x).get(e(s).label))?g(Ge):g(Ie,!1)})}_(ce),_(j);var Ue=m(j,2);{var We=g=>{var P=zt(),de=me(P);{var je=E=>{var u=gt(),w=f(u),G=f(w);G.__click=[ht,De];var R=m(G,2);R.__click=[mt,Pe],_(w);var B=m(w,2),D=f(B);D.__click=[yt,Ne];var I=m(D,2);I.__click=[kt,Te],_(B),_(u),Z(()=>{D.disabled=(e(n),p(()=>e(n).size==0)),I.disabled=(e(n),p(()=>e(n).size==0))}),C(E,u)};Y(de,E=>{e(b),e(s),p(()=>e(b)==e(s).label)&&E(je)})}var ue=m(de,2);ye(ue,5,()=>(e(s),p(()=>e(s).cardIds)),ke,(E,u)=>{var w=Mt();let G;w.__click=[wt,se,s,u],w.__keydown=[St,se,s,u];var R=f(w);{var B=U=>{var q=Ct();q.__click=[xt,ze,s,u],C(U,q)};Y(R,U=>{e(b),e(s),p(()=>e(b)!=e(s).label)&&U(B)})}var D=m(R,2),I=f(D),Re=f(I,!0);_(I),_(D);var ve=m(D,2),F=f(ve),Be=f(F,!0);_(F);var _e=m(F,2),Fe=f(_e,!0);_(_e),_(ve),_(w),Z((U,q,qe,Le,Ye,$e)=>{G=ge(w,1,U,"svelte-1c0hby7",G,q),L(Re,qe),ge(F,1,Le,"svelte-1c0hby7"),L(Be,Ye),L(Fe,$e)},[()=>(e(u),e(r),p(()=>`card ${te(c,e(u),e(r))}`)),()=>({selectable:e(b)==e(s).label,selected:Oe(e(s).label,e(u),e(n))}),()=>(e(r),e(u),p(()=>e(r).getCardWord(c,e(u)))),()=>(e(u),e(r),p(()=>`status ${te(c,e(u),e(r))}`)),()=>(e(r),e(u),tt(S),p(()=>e(r).getWenbunCustomState(c,e(u))??S.New)),()=>(e(r),e(u),p(()=>e(r).getCardDueFormatted(c,e(u))))],et),C(E,w)}),_(ue),C(g,P)};Y(Ue,g=>{e(x),e(s),p(()=>e(x).get(e(s).label))&&g(We)})}_(y),Z(()=>L(Ae,(e(s),p(()=>e(s).label=="__ungrouped__"?"Ungrouped":e(s).label)))),C(o,y)}),_(le),_(ie),ot(ne,()=>e(W),o=>d(W,o)),C(i,ae),Ze()}Je(["click","keydown"]);export{qt as component,Ft as universal};
